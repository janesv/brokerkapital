!function(e){e.module("KaskoApp",["ui.router","ui.mask","ngSanitize","ngDialog","angularFileUpload","kaskoTemplates","calculatorC","formationPolicyC","brandingC","AddingDocumentsC","calculatorStepsC","application","brandingConfigs","utils","dictionary","policyOrdering","priceFormatter","inputOnly","ngThumb","jDatePicker","calculator","person","dropdown","UIElements","appMessage","priceSlider","dadata","mainContent","baseModule","carFilter","preCalculator","postCalculator","calculatorSteps","yaMetrika","heapAnalytics"]),e.module("KaskoApp").value("moduleType","kasko"),e.module("baseModule",[]),e.module("calculator",[])}(angular),function(e){e.module("OsagoApp",["ui.router","ui.mask","ngSanitize","ngDialog","angularFileUpload","kaskoTemplates","calculatorO","formationPolicy","AddingDocuments","branding","personalData","calculatorStepsO","application","brandingConfigs","utils","dictionary","policyOrdering","priceFormatter","inputOnly","ngThumb","jDatePicker","calculator","person","dropdown","UIElements","appMessage","priceSlider","dadata","mainContent","baseModule","carFilter","preCalculator","postCalculator","calculatorSteps","yaMetrika","heapAnalytics"]),e.module("OsagoApp").value("moduleType","osago"),e.module("baseModule",[]),e.module("calculator",[])}(angular),function(e){e.module("CascoApp",["ui.router","ui.mask","ngSanitize","ngDialog","angularFileUpload","kaskoTemplates","AddingDocumentsS","calculatorS","brandingS","formationPolicyS","personalDataS","calculatorStepsS","carFilterS","application","brandingConfigs","utils","dictionary","policyOrdering","priceFormatter","inputOnly","ngThumb","jDatePicker","calculator","person","dropdown","UIElements","appMessage","priceSlider","dadata","mainContent","baseModule","carFilter","preCalculator","postCalculator","calculatorSteps","yaMetrika","heapAnalytics"]),e.module("CascoApp").value("moduleType","casco"),e.module("baseModule",[]),e.module("calculator",[])}(angular),function(e){e.module("UsagoApp",["ui.router","ui.mask","ngSanitize","ngDialog","angularFileUpload","kaskoTemplates","AddingDocumentsU","calculatorU","brandingU","formationPolicyU","personalDataU","calculatorStepsU","carFilterU","application","brandingConfigs","utils","dictionary","policyOrdering","priceFormatter","inputOnly","ngThumb","jDatePicker","calculator","person","dropdown","UIElements","appMessage","priceSlider","dadata","mainContent","baseModule","carFilter","preCalculator","postCalculator","calculatorSteps","yaMetrika","heapAnalytics"]),e.module("UsagoApp").value("moduleType","usago"),e.module("baseModule",[]),e.module("calculator",[])}(angular),function(e){"use strict";function t(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=a.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}window.getParameterByName=t,e.module("baseModule").controller("baseController",["CONSTS","$rootScope","brandingService","moduleType","$injector","yaMetrikaService","heapService",function(e,t,a,i,n,r,s){t.currentBrandName=window.b2bpolis_related_brand?window.b2bpolis_related_brand:e.currentBrand,t.currentBrand=a[e.currentBrand],t.currentBrand.owner_registrations=window.b2bpolis_owner_registrations||t.currentBrand.owner_registrations||[],t.currentBrand.exploitation_areas=window.b2bpolis_exploitation_areas||t.currentBrand.exploitation_areas||[],t.currentBrand.with_sms=void 0!==window.b2bpolis_with_sms?window.b2bpolis_with_sms:t.currentBrand.with_sms,r.initYaMetrika(),s.initHeapAnalytics(),t.currentModuleType=i,t.browser={isIE:e.isIE},window.showUser=function(){try{n.invoke(["applicationService",function(e){e.getCurrentBrandsUser().then(function(e){console.log("%c Компания: "+e.company.title+"("+e.company.id+")","color: green"),console.log("%c Пользователь: "+(e.first_name||"")+" "+(e.last_name||""),"color: green")})}])}catch(e){console.log(e)}}}])}(angular),function(e){"use strict";e.module("baseModule").config(["DictionaryProvider","CONSTS","jdatepickerProvider","calculatorProvider","$compileProvider","$locationProvider",function(e,t,a,i,n,r){e.setConstants(t),-1!==window.location.hash.indexOf("dev=1")||window.location.port&&80!=window.location.port||n.debugInfoEnabled(!1),r.hashPrefix("!"),a.setDefaults({dateFormat:"dd.mm.yy",pDateFormat:"yy-mm-dd",mDateFormat:"yy-mm-dd",replacedSymbols:{"/":".",",":"."},inputRule:function(e){var t,a,i=/([\d]{0,2})(\.?)([\d]{0,2})(\.?)([\d]{0,4})/;return a=i.exec(e),t=e,a&&(t="",a[1]&&(t=a[1],(2==a[1].length||a[3])&&(t+=".")),a[3]&&(t+=a[3],(2==a[3].length||a[5])&&(t+=".")),t+=a[5]),t}})}])}(angular),function(e){"use strict";e.module("baseModule").constant("CONSTS",function(){var t={host:"",hostApi:"",prefixPath:"",proxyPath:"",proxyPathC:"",currentBrand:"",proxyUrl:"https://modules.dev.b2bpolis.ru",DADATA_TOKEN:"840fc8bdabac6c26db9271f4a37906560d23e690",testCode:"7777",testPhone:"+7 (000) 000-0077",explotationAreaPriority:10};return AngularAppConfig&&(AngularAppConfig.host&&(t.host=AngularAppConfig.host),AngularAppConfig.hostApi&&(t.hostApi=AngularAppConfig.hostApi),AngularAppConfig.prefixPath&&(t.prefixPath=AngularAppConfig.prefixPath),AngularAppConfig.proxyPath&&(t.proxyPath=AngularAppConfig.proxyPath),t.proxyPathC=AngularAppConfig.proxyPathC||t.proxyPath,AngularAppConfig.currentBrand?t.currentBrand=AngularAppConfig.currentBrand:t.currentBrand="other"),e.extend(t,{isIE:!!document.documentMode,pathToSource:t.prefixPath+"js/",pathToModules:t.prefixPath+"js/modules.",urlPrefix:t.host+"/rest/v1/",urlPrefixDefault:t.host+"/rest/default/",urlPrefixV3:t.host+"/rest/v3/default/",urlPrefixV4:t.host+"/rest/v4/",urlPrefixV3Client:t.host+"/rest/v1/client/",urlPrefixCalc:t.host+"/rest/full/",urlPrefixPolicy:t.host+"/policy/rest/",urlPrefixApi:t.hostApi+"/api/",vzrAggregatorUrl:"https://modules.dev.b2bpolis.ru/vzr-aggregator"}),function(e){return new RegExp(e.join("|")).test(window.location.host)}(["b2bpolis.ru","modules.testing.cmios.ru","localhost"])&&(t.ENV_TYPE="test"),t}())}(angular);var jQueryApp=jQuery.noConflict();!function(e){"use strict";e.module("baseModule").service("resources",["CONSTS",function(e){this.deal=e.urlPrefix+"deal/deal",this.person=e.urlPrefix+"client/person",this.customer=e.urlPrefix+"client/customer",this.obtainToken=e.urlPrefix+"accounts/obtain-token",this.legalPerson=e.urlPrefix+"client/legal-person",this.customerCar=e.urlPrefix+"client/car",this.currentUser=e.urlPrefix+"accounts/user/current",this.calculation=e.urlPrefixCalc+"calculation/",this.resultPolicy=e.urlPrefixPolicy+"result_policy/",this.naturalPerson=e.urlPrefix+"client/natural-person",this.insuredObject=e.urlPrefixDefault+"client/insured-object-create",this.insuredObjectOsago=e.urlPrefixDefault+"client/insured-object-osago-create",this.calculationV3=e.urlPrefixV3+"calculation/",this.userActivation=e.urlPrefix+"registration/activation",this.calculationList=e.urlPrefixV3+"calculation/list/",this.insuredObectList=e.urlPrefix+"client/insured-object",this.insuredObjectCRM=e.urlPrefix+"client/insured-object",this.notificationSend=e.urlPrefix+"notification/send",this.userRegistration=e.urlPrefix+"registration/registration",this.insuranceProduct=e.urlPrefix+"deal/insurance-product",this.savedCars=e.urlPrefix+"client/car",this.savedNaturalPersons=e.urlPrefix+"client/natural-person",this.savedLegalPersons=e.urlPrefix+"client/legal-person"}])}(angular),function(e){"use strict";e.module("baseModule").config(["$stateProvider","$parseProvider","$urlRouterProvider","CONSTS","calculatorProvider",function(e,t,a,i,n){var r=i.pathToModules,s="/kasko/",l="";n.getModuleType&&(s="/"+n.getModuleType()+"/",l=""),778==window.location.port&&(l="",s+="{calculationId:[0-9]*}"),a.otherwise(function(){return s?l+s:"/"}),e.state("index",{url:"?dev&interface&sms&cbs",abstract:!0,views:{"":{controller:"baseController",templateUrl:r+"shared/mainContent/views/main_content.html"}},resolve:{calcType:["$rootScope","moduleType",function(e,t){e.calcType=t}]}}).state("index.calculator",{url:l,abstract:!0,reloadOnSearch:!0,controller:"calculatorCtrl",templateUrl:r+"shared/calculator/views/calculator.html"}).state("index.preCalculator",{url:"/pre",controller:"preCalculatorCtrl",templateUrl:r+"shared/preCalculator/views/pre_calculator.rolf.html"}).state("index.postCalculator",{url:"/get-best-offer",controller:"postCalculatorCtrl",templateUrl:r+"shared/postCalculator/views/post_calculator.rolf.html"}).state("index.calculator.kasko",{url:"/kasko/",views:{"":{controller:"calculatorCascoCtrl",templateUrl:r+"kasko/calculatorC/views/calculation.form.html"},"step_3@index.calculator.kasko":{templateUrl:r+"kasko/calculatorC/views/kasko/calculation.step_3.html"},"step_6@index.calculator.kasko":{templateUrl:r+"kasko/calculatorC/views/kasko/calculation.step_6.html"}}}).state("index.calculator.health",{url:"/health/",views:{"":{controller:"calculatorVzrCtrl",templateUrl:r+"health/calculatorH/views/calculation.form.html"},"step_2@index.calculator.health":{templateUrl:r+"health/calculatorH/views/calculation.step_2.html"},"step_3@index.calculator.health":{templateUrl:r+"health/calculatorH/views/calculation.step_3.html"},"step_6@index.calculator.health":{templateUrl:r+"health/calculatorH/views/calculation.step_6.html"}}}).state("index.calculator.oms",{url:"/oms/",views:{"":{controller:"calculatorVzrCtrl",templateUrl:r+"oms/calculatorM/views/calculation.form.html"},"step_2@index.calculator.oms":{templateUrl:r+"oms/calculatorM/views/calculation.step_2.html"},"step_3@index.calculator.oms":{templateUrl:r+"oms/calculatorM/views/calculation.step_3.html"},"step_6@index.calculator.oms":{templateUrl:r+"oms/calculatorM/views/calculation.step_6.html"}}}).state("index.calculator.vzr",{url:"/vzr/",views:{"":{controller:"calculatorVzrCtrl",templateUrl:r+"vzr/calculatorV/views/calculation.form.html"},"step_3@index.calculator.vzr":{templateUrl:r+"vzr/calculatorV/views/calculation.step_3.html"}}}).state("index.calculator.casco",{url:"/casco/",views:{"":{controller:"calculatorCascoCtrl",templateUrl:r+"casco/calculatorS/views/calculation.form.html"}}}).state("index.calculator.usago",{url:"/usago/",views:{"":{controller:"calculatorUsagoCtrl",templateUrl:r+"usago/calculatorU/views/calculation.form.html"}}}).state("index.calculator.osago",{url:"/osago/",views:{"":{controller:"calculatorOsagoCtrl",templateUrl:r+"osago/calculatorO/views/calculation.form.html"},"step_2@index.calculator.osago":{templateUrl:r+"osago/calculatorO/views/osago/calculation.step_2.html"},"step_3@index.calculator.osago":{templateUrl:r+"osago/calculatorO/views/osago/calculation.step_3.html"},"step_4@index.calculator.osago":{templateUrl:r+"osago/calculatorO/views/osago/calculation.step_4.html"},"step_6@index.calculator.osago":{templateUrl:r+"osago/calculatorO/views/osago/calculation.step_6.html"}}})}])}(angular),function(e,t){"use strict";e.module("baseModule").run(["$rootScope","$state","$injector","$http","CONSTS","$location","brandingConfigs","ngDialog","$filter","Dictionary",function(t,a,i,n,r,s,l,c,o,d){function u(){}var p,m=s.path;r.currentProxyPath="kasko"===t.currentModuleType?r.proxyPathC:r.proxyPath,u.prototype.append=function(e,t){return this[e]=t,this},u.prototype.remove=function(e){return this.hasOwnProperty(e)&&delete this[e],this},u.prototype.isFake=!0,l.parseCarInfo&&(t.brandExternalInfo=l.parseCarInfo()),console.log(t.brandExternalInfo),_.mixin({isPromise:function(e){return e&&_.isFunction(e.then)},transformRequest:function(e){var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")},getYearByDate:function(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970},compatibleFormData:function(){return t.browser.isIE?new u:new FormData},formatDate:function(){var e=o("date");return function(t){return e(t?new Date(t):new Date,"yyyy-MM-dd")}}()}),t.$on("$stateChangeStart",function(e,a,i,n,r){t.lastState=a,t.lastState.toParams=i}),t.$on("$stateChangeSuccess",function(e,a,i,n){t.$previousState=n,t.$activeState=a,p&&(c.close(p),p=null)}),t.$on("ngDialog.opened",function(e,t){p=t.attr("id")}),t.cancellerRequests=[],t.cancelAllRequests=function(){e.forEach(t.cancellerRequests,function(e){e.resolve()}),t.cancellerRequests.length=0},s.path=function(e,i){if(!1===i)var n=a.current,r=t.$on("$stateChangeSuccess",function(){a.current=n,r()});return m.apply(s,[e])},t.prefixPath=r.prefixPath}])}(angular),function(e){e.module("kaskoTemplates",[])}(angular),function(e){e.module("calculatorC",[])}(angular),function(e,t){"use strict";e.module("calculatorC").controller("calculatorCascoCtrl",["$scope","$q","calculatorService","CONSTS","$stateParams","Dictionary","$filter","formationPolicyService","formationPolicyStep1Service","$rootScope","ngDialog","Person","calculatorStepsService","brandingConfigs",function(t,a,i,n,r,s,l,c,o,d,u,p,m,g){function v(a){S=a.insurance_type,T=e.copy(a),t.params.drivers_count=a.driver_set.length,t.params.drivers_count_full=a.driver_set.length,a.insured_object?k(a.insured_object):f()}function f(){h()}function h(a){var i=e.copy(D);i.driver_license=o.getDefaultObject("defaultDriverLicenseObject");var n=new p(e.extend({},i,a));t.drivers.push(n)}function b(a){var i=new p(e.extend({},F,a));t.persons.push(i)}function y(){return(t.calculation.engine_power>9&&t.calculation.engine_power<=999||!t.calculation.engine_power)&&t.calculation.car_mark&&t.calculation.car_model&&t.calculation.car_manufacturing_year}function w(t,a){return e.isObject(t)?e.equals(t,a):null===t||null===a?Boolean(t)==Boolean(a):t==a}function k(t){return c.getInsuredObject(t).then(function(t){return C=e.copy(t),x(t)})}function x(a){var i=e.copy(a.person);return t.persons.length=0,t.drivers.length=0,a.object.vin_number?(t.osagoParams.vin_number=a.object.vin_number,t.osagoParams.vin_is_visible=!0):t.osagoParams.vin_is_visible=!1,e.forEach(i,function(a){var i=a.natural_person?"natural_person":"legal_person";a[i].selectedPerson=a[i].external_id,"natural_person"===i?(a[i].age=l("calcAge")(a[i].birth_date),a[i].expirience=l("calcAge")(a[i].driving_experience_started)):(t.osagoParams.legal_person.inn=a[i].inn,t.osagoParams.legal_person.title=a[i].title,t.osagoParams.legal_person.insurant_is_legal_person=!0),a[i].personType=i,o.setPersonCredential(a[i]),o.setPersonAddress(a[i]),a.role.length&&_.forEach(a.role,function(e){a[i]["is"+e.slice(0,1).toUpperCase()+e.slice(1,e.length)]=!0}),"natural_person"===i&&b(e.copy(a[i]))}),e.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,o.setPersonCredential(e),h(e)}),t.persons.length||t.drivers.length||b(),t.drivers.length&&(a.person.length&&(t.drivers[0].person=a.person[0].id),t.persons.length=0),t.cachedDrivers=e.copy(t.drivers),P={drivers:e.copy(t.drivers),persons:e.copy(t.persons)},a}var S,P,C,I=i.getPromises(),T={},D={credential:[],address:[],contact:[],first_name:"",last_name:"",patronymic:"",isDriver:!0,personType:"natural_person",birth_date:"",gender:"M",driving_experience_started:"",driver_license:o.getDefaultObject("defaultDriverLicenseObject")},F={is_same_address:!0,credential:[],isOwner:!0,personType:"natural_person",isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:"M",birth_date:"",passport:o.getDefaultObject("defaultPassportObject"),address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""}},$=[],B=["Подробнее","Заказать полис"];t.dicts={},t.dynamicDicts={},t.persons=[],t.drivers=[],t.params.field_was_clicked=!1,t.params.go_to_order_title=B[d.currentBrand.go_to_order_title_index||0],t.osagoParams={vin_number:"",vin_is_visible:!0,legal_person:{isOwner:!0,isInsurant:!1,inn:"",title:"",address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""},is_same_address:!0,personType:"legal_person"}},t.getCurrentCalcType=function(){return m.getCurrentCalcType()},i.calculationFormIsValid=function(){return!0},t.templates.program_list=g.templates.program_list||n.pathToModules+"kasko/calculatorC/views/calculation.program_list.html",t.templates.navigation=g.templates.navigation||n.pathToModules+"shared/calculator/views/navigation.html",t.templates.step_2=g.templates.step_2||n.pathToModules+"kasko/calculatorC/views/calculation.step_2.html",t.validation={},t.isVisible=function(e,a,i){t.calculation.car_type;i=i||t.calculation,i[e]=a||null},t.isDisabled=function(e,a,i){t.calculation.car_type;i=i||t.calculation},_.isPromise(I.getCalculation)?I.getCalculation.then(v,f):t.calculation.id?i.getCalculation(t.calculation.id).then(v,f):f(),t.calculateKasko=function(){if(!t.params.recalculateButtonIsDisabled)return t.params.recalculateButtonIsDisabled=!0,t.params.isCalculationProgress=!0,t.root.messages.length=0,t.calculation.exploitation_area=t.calculation.exploitation_area||m.calculationInterParams.exploitation_area,t.calculation.is_calculate_osago=!1,t.calculation.has_trailer=!!t.calculation.has_trailer,t.calculation.is_credit=!!t.calculation.is_credit,t.calculation.is_new_car=!!t.calculation.is_new_car,delete t.calculation.insurance_type,delete t.calculation.insured_object,"tumen"===d.currentBrandName&&m.parseDriversDates(t.calculation.driver_set),d.currentBrand.preCalculationParse&&d.currentBrand.preCalculationParse(t.calculation),t.postCalculateParams.second&&(t.calculation.contributory_scheme=t.params.contributory_scheme||19,_.isArray(t.calculation.payment_form)||(t.calculation.payment_form=t.params.payment_form?[t.params.payment_form]:null)),t.calculation.deductible_value=t.params.deductible_value,t.calculation.is_deductible=!!parseInt(t.calculation.deductible_value,10),t.calculation.date_of_exploitation_period=t.calculation.car_manufacturing_year?t.calculation.car_manufacturing_year+"-01-01":null,t.calculate(function(a){t.cachedDrivers=e.copy(t.drivers),t.disabledFormationPolicyButtonIsActive=!0,T=e.copy(a)})},t.disabledSubmitButton=function(){return t.root.isSubmitButtonDisabled=!y()||!!t.params.isCalculationProgress,t.root.isSubmitButtonDisabled},t.addressIsValid=function(e){return e.city&&e.house&&e.street},t.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},t.params.brandedDeductibleValues=a.when(_.map(d.currentBrand.deductible_values,function(e){return{id:e,title:e}})),function(){var a=["insuranceDuration","ownerRegistration"];e.forEach(a,function(a){t.dicts[a]=s.getItems(a).then(function(t){return t=t.results?t.results:t,$[a]=e.copy(t),t})}),t.dicts.trueFalse=[{title:"Да",id:!0},{title:"Нет",id:!1}],t.dicts.isLegalEntity=[{title:"Физическое лицо",id:!1},{title:"Юридическое лицо",id:!0}],t.dicts.insuranceDuration=t.dicts.insuranceDuration.then(function(e){return _.filter(e,function(e){return"1 год"===e.title})})}(),t.driversCountChanged=function(){var e=t.drivers.length,a=t.params.drivers_count_full;if(t.calculation.is_multidrive=!a,a&&"0"!==a?(t.persons.length=0,t.osagoParams.vin_is_visible=!1,t.osagoParams.vin_number=""):(t.persons.length=0,b(),t.osagoParams.vin_is_visible=!0),a>e)for(var i=0;a-e>i;i++)h();else t.drivers.length=+a},t.driversCountChangedSimple=function(){var a=t.calculation.driver_set.length,n=t.params.drivers_count;if(t.params.field_was_clicked){if(n>a)for(var r=0;n-a>r;r++)t.calculation.driver_set.push(e.copy(i.defaultCalcDriver));else t.calculation.driver_set.length=+n;t.calculation.is_multidrive=!!n}},t.disabledFormationPolicyButton=function(){var e,a;if(a=["created_at","id","deductible_value","drivers_count","is_new_car"],T){T.car_cost=parseInt(T.car_cost,10)+"",t.calculation.car_cost=parseInt(t.calculation.car_cost,10)+"";for(e in t.calculation)if(t.calculation.hasOwnProperty(e)&&-1===a.indexOf(e)&&!w(t.calculation[e],T[e]))return t.root.isFormationPolicyButtonDisabled=!0,!0}return t.root.isFormationPolicyButtonDisabled=!1,!1},t.resetPerson=function(e){o.resetPerson(e)}}])}(angular),function(e,t){"use strict";e.module("calculatorC").controller("calculatorCtrl",["$scope","$state","$rootScope","$stateParams","Dictionary","calculatorService","policyOrderingService","calculatorStepsService","CONSTS","$q","$location","Messages","formationPolicyStep1Service","brandingConfigs","addingDocumentsService",function(a,i,n,r,s,l,c,o,d,u,p,m,g,v,f){function h(e,t){var i=_.find(a.calculationResult,function(t){return t.id==e})||null;return l.setSelectedResult(i),a.root.selectedResult=l.getSelectedResult(),i&&l.setResultAsSelected(i),"brokers"==n.currentBrandName&&(a.params.orderButton=!1,t&&(i.show_info_on_last_step=!0)),i}function b(){for(var e,t,i=a.calculationResult.length;0!==i;)t=Math.floor(Math.random()*i),i-=1,e=a.calculationResult[i],a.calculationResult[i]=a.calculationResult[t],a.calculationResult[t]=e;return a.calculationResult}var y,w={};a.params=l.calculatorOtherParams,a.enterClientName=function(e){l.calculation.client_name=e},a.enterClientPhone=function(e){l.calculation.client_phone=e},a.sendOrderLetter=c.sendOrderLetter,a.params.disableFields=!1,a.orderPolicy=function(){a.sendOrderLetter(),a.params.disableFields=!0};var k=l.sortResultsByPriority;a.calculationResult=l.calculationResult,a.templates={program_list_manager:v.templates.program_list_manager||d.pathToModules+"shared/carFilter/views/program_list.manager.html",policy_info:v.templates.policy_info||d.pathToModules+"shared/carFilter/views/policy_info.html",program_list_remaining:v.templates.program_list_remaining||d.pathToModules+"kasko/calculatorC/views/calculation.program_list.remaining.html"},a.bigSteps=o.bigSteps,a.postCalculateParams={first:!1,second:!1,third:!1,is_visible:!1,manager__client_phone:"",manager__client_name:"",button_is_disabled:!1},a.toManager=function(){a.calculation.client_phone?a.sendToManager():a.postCalculateParams.third=!0},a.sendToManager=function(){var e=_.compatibleFormData(),t="",i=a.postCalculateParams.manager__client_name||a.calculation.client_name,r=a.postCalculateParams.manager__client_phone||a.calculation.client_phone;a.postCalculateParams.button_is_disabled=!0,t+="Клиент просит ему перезвонить.\n\n",t+="Имя клиента: "+i+"\n",t+="Телефон клиента: "+r+"\n\n",n.currentBrand.link_to_registration_in_email&&(t+="Ссылка на расчет: http://enter.b2bpolis.ru/#/calculator/"+a.calculation.id),e.append("message",t),f.send(e).then(function(){a.postCalculateParams.button_is_disabled=!1,a.postCalculateParams.is_visible=!1,m.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){a.postCalculateParams.button_is_disabled=!1,m.error("Не удалось отправить запрос.",6e3)})},s.getItems("contributoryScheme").then(function(e){e=e.results?e.results:e,a.params.contributoryScheme=e,a.params.contributoryScheme=e,"ural"===n.currentBrandName&&(a.params.contributoryScheme=_.forEach(e,function(e){19!==e.id&&"Единовременно"!==e.title||(e.title="Нет")})),_.head(n.currentBrand.contributory_schemas)&&(a.params.contributoryScheme=_.map(n.currentBrand.contributory_schemas,function(e){return _.find(a.params.contributoryScheme,function(t){return t.id===e})}))}),a.paymentForm=n.currentBrand.payment_forms,a.getResultWithKbm=function(){var e=_.find(a.calculationResult,function(e){return 30829===e.insurance_company.id});return e||(e=_.find(a.calculationResult,function(e){return 30854===e.insurance_company.id})),e},a.setStep=function(e){a.step=e},a.root={messages:[],selectedResult:l.getSelectedResult()},a.calculation=l.calculation;var x=i.params.calculationId||a.calculation&&a.calculation.id;a.disabledSecondStep=!!a.calculation.id,a.calculateType=function(){return n.calcType},a.root.insuranceTypeTitle=function(){return"Калькулятор ОСАГО"},x?(x!=a.calculation.id&&l.resetCalculation(),w.getCalculation=l.getCalculation(x).then(function(){y=e.copy(a.calculation)}),w.getResult=l.getResult(x).then(function(e){if(!e||!e.length||!e)return void a.root.messages.push("Ошибка со стороны страховой компании.");a.calculationResult=_.filter(_.forEach(e,l.parseResult),function(e){return parseInt(e.program.sum)&&_.head(e.program.option_set)}),a.postCalculateParams.is_visible=!0,a.params.resultsAreVisible=!0,"brokers"==n.currentBrandName?b():k(a.calculationResult)})):l.resetCalculation(),a.selectResult=function(e){h(e)&&a.bigSteps.setBigStep("fourth")},a.selectResultWithoutNext=function(e){h(e,!0)},a.getSelectedResult=function(){var e=l.getSelectedResult();return a.root.selectedResult=e,e},a.getYearRange=function(e,t){var a,i,n;return a=new Date,e=e||0,t=void 0===t?90:t,n=a.getFullYear()-t,i=a.getFullYear()-e,n+":"+i},a.resetCalculation=function(){a.calculation.id?m.success('Данные по расчету очищены, ваш расчет сохранен в разделе <a href="#/calculator/archive">Расчеты</a>.',7e3):m.success("Данные по расчету очищены.",4e3),l.resetCalculation(),g.resetAll(),a.calculationResult.length=0,p.search("policy",null),p.path("/calculator/"+n.calcType+"/",!1)},a.calculate=function(r){a.prevCalculationResult=e.copy(a.calculationResult),a.calculationResult.length=0,a.selectResult(null),a.calculation.created_by_user=null,l.createCalculation().then(function(s){var c=[],o=0;a.root.messages.length=0,console.log("%c createCalculationSuccess ","color: green"),y=e.copy(a.calculation),i.go(i.current,{calculationId:a.calculation.id},{notify:!1}),console.log("companies",l.companiesInProgress),l.companiesInProgress.length&&_.forEach(l.companiesInProgress,function(e){c.push(l.createResult(e.id).then(function(e){var t;n.currentBrand.results_with_min_sum_by_company&&(t=_.minBy(e,function(e){return parseInt(e.program.sum)}),e=t?[t]:[]),_.forEach(e,function(e){_.isFunction(n.currentBrand.resultParser)&&n.currentBrand.resultParser(e),(e.is_default||n.currentBrand.results_without_filter_by_default)&&parseInt(e.program.sum)&&(a.calculationResult.push(l.parseResult(e)),"brokers"==n.currentBrandName?b():k(a.calculationResult),++o>=5&&(a.params.recalculateButtonIsDisabled=!1))}),a.postCalculateParams.is_visible=!0}))}),"function"==typeof r&&r(s),u.all(c).then(function(e){var i,n=_.flatten(e);if(console.log("%c createResultSuccess ","color: green"),console.warn(e),a.params.resultsAreCreated=!0,a.params.recalculateButtonIsDisabled=!1,!n||!n.length)return a.root.messages.push("Ошибка на стороне сервера."),void(a.params.isCalculationProgress=!1);(i=t(".js-kasko-result").offset())&&jQueryApp("html,body").animate({scrollTop:i.top},"fast")},function(e){console.log("%c createResultError: ","color: red"),console.warn(e)}).then(function(e){a.params.recalculateButtonIsDisabled=!1,a.params.isCalculationProgress=!1})},function(e){console.log("%c createCalculationError: ","color: red"),console.warn(e),a.root.messages.push("Не удалось создать расчет. Пожалуйста, попробуйте позже."),a.params.isCalculationProgress=!1})}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorC").service("calculatorService",["$http","$q","CONSTS","$rootScope","resources","calculator","$filter","requester",function(a,i,n,r,s,l,c,o){function d(e){var a=t(".ui-datepicker-year").val();return(e=new Date(e))?(e.setFullYear(a),c("date")(e,"yyyy-MM-dd")):""}var u=l.getDefaults(),p=function(e){return e=e||new Date,c("date")(e,"yyyy-MM-dd")},m={full_year:null,field_was_clicked:!1,drivers_count:1,drivers_count_full:1,signalization_type:"",show_empty_fields:!1,resultsAreCreated:!1,deductible_value:0,contributory_scheme:19,payment_form:107,recalculateButtonIsDisabled:!1,isCalculationProgress:!1,resultsAreVisible:!r.currentBrand.with_sms,multidriveForm:{birth_date:null,driving_experience_started:null}};this.sortResultsByPriority=function(e){e.sort(function(e,t){return parseFloat(e.program.sum)>parseFloat(t.program.sum)?1:-1})},this.calculationResult=[],this.parseResult=function(e){return e.company_logo="https://enter.b2bpolis.ru/"+e.insurance_company.logo,e},this.currentResult=null,this.getOtherCompanies=function(){return[{id:41243,title:"Росгосстрах",insurance_company:{logo:"media/logo_main_ins/Logo_24.png"}},{id:41465,title:"Ренессанс",insurance_company:{logo:"media/logo_main_ins/Logo_47.png"}}]},this.calculation=e.copy(u),this.companiesInProgress=[],this.getDefaultCalculation=function(){return u},this.selectedResult=null,this.setSelectedResult=function(e){this.selectedResult=e},this.getSelectedResult=function(){return this.selectedResult},this.calculationFormIsValid=_.noop,this._promises={},this.getPromises=function(){return this._promises},this.calculatorOtherParams=e.copy(m),this.resetCalculation=function(t){var a=e.copy(this.getDefaultCalculation());this.companiesInProgress.length=0,t=t||r.calcType;for(var i in this.calculation)this.calculation.hasOwnProperty(i)&&delete this.calculation[i];for(var n in a)a.hasOwnProperty(n)&&(this.calculation[n]=a[n]);for(var s in this.calculatorOtherParams)this.calculatorOtherParams.hasOwnProperty(s)&&(this.calculatorOtherParams[s]=m[s]);return this["to_defaults_"+t]&&this["to_defaults_"+t](),this},this.to_defaults_osago=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=p(t)},this.to_defaults_kasko=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=p(t),this.calculation.deductible_currency=23},this.defaultCalcDriver={is_married:!1,gender:"M",expirience:null,age:null,has_children:!1},this.createCalculation=function(t){return t=t||this.calculation,this.companiesInProgress.length=0,t=this.correctCalculation(t),delete t.token,o.post(s.calculation+"?token",t).then(function(t){var a,i=t.data,n=["driver_set"];this.calculationToken=i.token,this.companiesInProgress=i.available_insurance_departments,delete i.available_insurance_departments;for(a in i)i.hasOwnProperty(a)&&-1===n.indexOf(a)&&(e.equals(this.calculation[a],i[a])||(this.calculation[a]=i[a]));return t.data}.bind(this))},this.getCalculation=function(e){return(e=e||this.calculation.id)==this.calculation.id?i.when(this.calculation):(this._promises.getCalculation=o.get(s.calculation+e+"/").then(function(e){var t;e=e.data;for(t in e)"user"!==t&&(this.calculation[t]=e[t]);return this.calculation}.bind(this)),this._promises.getCalculation)},this.getResult=function(e){return e=e||this.calculation.id,o.get(s.calculationV3+e+"/result/?insurance_company=1&messages=1&variables=1&options=1").then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.createResult=function(e,t){var i=this.calculationToken;return t=t||this.calculation.id,a({url:"https://enter.b2bpolis.ru"+s.calculationV3+t+"/result/"+e+"/?insurance_company=1&messages=1&variables=1&options=1",method:"POST",headers:{"X-Calculation-Token":i}}).then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.setResultAsSelected=function(t,i){var n=this.calculationToken;return i=i||this.calculation.id,a({url:"https://enter.b2bpolis.ru"+s.calculationV3+i+"/result/"+t.insurance_company.version+"/?insurance_company=1&messages=1&variables=1&options=1",method:"PUT",headers:{"X-Calculation-Token":n},data:e.extend({},t,{is_selected:!0,is_default:!0})}).then(function(e){return e.data})},this.getCredentialList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/credential").then(function(e){return e.data})},this.getAddressList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/address").then(function(e){return e.data})},this.correctCalculation=function(e){return e=e||this.calculation},this.personDateChanged=function(e,t,a){t=t||"birth_date",-1!==t.indexOf(".")?(t=t.split("."),e[t[0]][t[1]]=d(e[t])):e[t]=d(e[t])},this.validateDrivers=function(){var e,t,a=this.calculation.driver_set.length
;if(this.calculation.is_multidrive,0===a)return!0;for(e=0;e<a;e++)if(t=this.calculation.driver_set[e],t.age-t.expirience<17)return!1;return!0}}])}(angular,jQueryApp),function(e){e.module("formationPolicyC",[])}(angular),function(e){"use strict";e.module("formationPolicyC").service("formationPolicyService",["$http","CONSTS","$q","$rootScope","$filter","resources","requester",function(t,a,i,n,r,s,l){function c(e){return e=e||new Date,r("date")(e,"yyyy-MM-dd")}function o(e){var t;return t="legal_person"===e.personType?["title","title_eng","id","inn","ogrn","kpp","representative_first_name","representative_last_name","representative_patronymic","representative_post","representative_credential_type","representative_number","representative_issue_date"]:["id","first_name","last_name","patronymic","first_name_eng","last_name_eng","patronymic_eng","birth_date","gender","driving_experience_started","is_individual_entrepreneur","is_foreigner"],_.pick(e,t)}var d={object:{credential:[{issue_date:"2016-02-04",creator:10585,series:"3456",number:"45",object_id:1751,issue_point:"",credential_type:10,content_type:480,expiration_date:null,external_id:"9374",id:5449}],keys_count:2,manufacturing_date:"2015-01-01",engine_power:"200.00",car_modification:null,creator:10585,car_model:7687,engine_displacement:"2.00",car_body_number:null,mileage:null,number_plate:"",car_mark:303,vin_number:"55TTEEE5E5R5R6TT7",external_id:"7628",id:1751,cost:null},object_type:"car",person:[]},u=null,p=null;return{clear:function(){p=null},resetCurrentPolicy:function(){u=null},updateCustomer:function(e){var a=i.defer();return this.getCustomer(null).then(function(i){i.natural_persons=i.natural_persons.concat(e.natural_persons),i.natural_persons=_.uniq(i.natural_persons),t.put(s.customer+"/null",i).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},getCustomer:function(e){return e=e||null,t.get(s.customer+"/"+e).then(function(e){return e.data})},getCustomerCars:function(e){return e=e||null,t.get(s.customerCar,{params:{owner:e}}).then(function(e){return e.data})},getCarCredential:function(e){return t.get(s.customerCar+"/"+e+"/credential").then(function(e){return e.data})},getCustomerFull:function(e){var a=i.defer();return this.getCustomer(e).then(function(e){t.get(s.person+"/"+e.person).then(function(i){var n=i.data,r="naturalPerson",l=n.natural_person;n.legal_person&&(r="legalPerson",l=n.legal_person),t.get(s[r]+"/"+l).then(function(t){var i=t.data;a.resolve({person:i,drivers:e.natural_persons})},function(e){a.reject(e)})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},saveCar:function(a){var n=i.defer(),r=_.pick(a,["id","mileage","car_mark","car_model","car_modification","owner","manufacturing_date","vin_number","number_plate","engine_displacement","engine_power","cost","keys_count"]),l="post",c=s.customerCar;return r.owner=r.owner||null,r.id&&(l="put",c+="/"+r.id),t[l](c,r).then(function(r){var l=r.data,c=_.map(a.credential,function(e){return _.pick(e,["id","number","series","credential_type","issue_date","issue_point","expiration_date"])}),o=[];e.forEach(c,function(e){var a="post",i=s.customerCar+"/"+l.id+"/credential";e.id&&(a="put",i+="/"+e.id),o.push(t[a](i,e).then(function(e){return e.data}))}),i.all(o).then(function(e){n.resolve({car:l,credential:e})},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},createDeal:function(a){var n=i.defer();return t.post(s.deal,e.extend({deal_status:1,customer:null},a)).then(function(e){var i=e.data;i.car=a.car,t.put(s.deal+"/"+i.id,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},getDeal:function(e){return t.get(s.deal+"/"+e)},createInsuranceProduct:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/from-calculation",a).then(function(e){return e.data})},updateInsuranceProduct:function(e,a,i){return t.put(s.deal+"/"+e+"/insurance-product/"+a,i).then(function(e){return e.data})},createInvoice:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/"+a+"/invoice/generate").then(function(e){return e.data})},createPersonContainer:function(e,a){var i={};return a="legal_person"===a?"legal_person":"natural_person",i[a]=e,t.post(s.person,i).then(function(e){return e.data})},saveBSO:function(e,a){return t.post(s.resultPolicy+"/"+e+"/enter_bso/",a).then(function(e){return e.data})},createInsuredObjectByIds:function(e){return t.post("/rest/default/client/insured-object",e).then(function(e){return e.data})},createInsuredObjectOsago:function(t){var a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:+t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,car_body_number:t.car.car_body_number,engine_power_kilowatt:t.car.engine_power_kilowatt,engine_power_loshad:t.car.engine_power_loshad,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]};return e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this),e.forEach(t.persons,function(t,i){var n,r,s={},l=[],d=t.id||this.generateId(),u=t.address_registration?[t.address_registration]:[],p=o(t),m=t.personType;u&&u.lendth&&(u[0].address_type=1),"natural_person"===m?(r=t.credential,e.forEach(r,function(e){e&&(e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId())},this),!t.is_same_address&&t.address_residential&&(u.push(t.address_residential),u[1].content_type=482,u[1].address_type=2),t.birth_date=c(t.birth_date),t.driving_experience_started=c(t.driving_experience_started)):r=null,e.forEach(["owner","insurant"],function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&l.push(e)}),l.length>0&&(s.role=l,s.external_id=d,s.id=t.person_id,s[m]=p,s[m].external_id=d,s[m].credential=r,s[m].address=u,a.person.push(s)),t.isDriver&&(n=e.copy(p),n.external_id=d,n.credential=[],n.credential.push(_.find(r,function(e){return 3===e.credential_type})),n.credential.push(_.find(r,function(e){return 1===e.credential_type})),n.credential[1]||(n.credential.length=1),a.drivers.push(n))},this),l.post(s.insuredObjectOsago,a).then(function(t){return p=e.copy(t.data),t.data})},sendPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token",_.pick(e,"phone")).then(function(e){return e.data})},confirmPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token-verified",_.pick(e,"token")).then(function(e){return e.data})},toPay:function(e){return t.post("/payment/"+e+"/ ").then(function(e){return e.data})},createInsuredObject:function(t){var a,i;return t.car?(a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,is_new_car:t.car.is_new_car,is_temporary:t.car.is_temporary,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]},i=["owner","insurant","beneficiary"],e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this)):(a=d,i=["owner","insurant"]),e.forEach(t.persons,function(t,n){var r,s,l={},d=[],u=t.id||this.generateId(),p=[t.address_registration],m=_.filter(t.contact,function(e){return e.data}),g=o(t),v=t.personType;"legal_person"===v?s=null:(s=t.credential,e.forEach(s,function(e){e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId()},this),t.is_same_address||p.push(t.address_residential),t.is_temporary_registration&&p.push(t.address_temporary_registration),t.birth_date=c(new Date(t.birth_date)),t.driving_experience_started=t.driving_experience_started?c(new Date(t.driving_experience_started)):null),e.forEach(i,function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&d.push(e)}),e.forEach(p,function(e){e&&!e.country&&(e.country="Россия")}),d.length>0&&(l.role=d,l.external_id=u,l.id=t.person_id,l[v]=g,l[v].external_id=u,l[v].contact=m,l[v].credential=s,l[v].address=p,a.person.push(l)),t.isDriver&&(r=e.copy(g),r.external_id=u,r.address=p,r.credential=_.filter(s,function(e){return 3===e.credential_type}),a.drivers.push(r))},this),l.post(s.insuredObject,a).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObject:function(t){return l.get(s.insuredObject+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObjectOsago:function(t){return l.get(s.insuredObjectOsago+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getPolicyFile:function(e,a){return a=a?"?type="+a:"",t({method:"GET",url:s.resultPolicy+e+"/template/"+a,headers:{}}).then(function(e){return e.data})},createInsuredObjectCRM:function(e){return t.post(s.insuredObjectCRM,e).then(function(e){return e.data})},createPolicy:function(a){return t.post(s.resultPolicy,e.extend({external_id:null},a)).then(function(e){return u=e.data})},savePolicy:function(a){var i="post",n=s.resultPolicy;return a.id&&(i="put",n=s.resultPolicy+a.id+"/"),t[i](n,e.extend({external_id:null},a)).then(function(e){return u=e.data})},getPolicy:function(e){return t.get(s.resultPolicy+e+"/",{params:{external_id:null}}).then(function(e){return u=e.data})},getSavedNaturalPersons:function(e){return t.get(s.savedNaturalPersons,{params:e}).then(function(e){return e.data})},getSavedLegalPersons:function(e){return t.get(s.savedLegalPersons,{params:e}).then(function(e){return e.data})},getSavedCars:function(e){return t.get(s.savedCars,{params:e}).then(function(e){return e.data})},getInsObjList:function(e){return t.get(s.insuredObectList,{params:e}).then(function(e){return console.log(e),e.data})},getCurrentPolicy:function(){return u},getCurrentInsuredObject:function(){return p},sendNotification:function(e){return t.post(s.notificationSend,e).then(function(e){return e.data})},generateId:function(){return~~(9900*Math.random()+100)},getPolicyActionsParameters:function(e){return t.get(s.resultPolicy+e+"/actions_parameters/",{params:{external_id:null}}).then(function(e){return e.data})},executePolicyAction:function(e,i,n){return t.post(a.urlPrefixPolicy+"result_policy/"+e+"/"+i+"/",n).then(function(e){return e.data})},getPolicyDocsArchive:function(e){return t.get(a.urlPrefixPolicy+"result_policy/"+e+"/zip/").then(function(e){return e.data})},getPolicyAttachments:function(e){return t.get(s.resultPolicy+e+"/attachment/").then(function(e){return e.data})},deletePolicyAttachment:function(e,a){return t.delete(s.resultPolicy+e+"/attachment/"+a).then(function(e){return e.data})},issueToSavedPolicy:function(e){return t.post(s.resultPolicy+e+"/issue_to_saved_policy/").then(function(e){return e})},setPersonValidationDates:function(e){e.isDriver?(e.birthDateRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age),c(t)}()},e.expirienceRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience),c(t)}()}):(e.birthDateRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-90),c(e)}(),max:function(){var e=new Date;return e.setFullYear(e.getFullYear()-18),c(e)}()},e.expirienceRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-72),c(e)}(),max:function(){return c(new Date)}()}),e.birthDateRange.yearRange=new Date(e.birthDateRange.min).getFullYear()+":"+new Date(e.birthDateRange.max).getFullYear(),e.expirienceRange.yearRange=new Date(e.expirienceRange.min).getFullYear()+":"+new Date(e.expirienceRange.max).getFullYear(),e.dateChanged=function(t,a){var i=new Date(t).getFullYear(),n=new Date(a).getFullYear();e.invalidDates=i-n>=18}}}}])}(angular),function(e,t){"use strict";e.module("formationPolicyC").service("formationPolicyStep1Service",["$filter","$rootScope","formationPolicyService","Person","calculatorService","$q",function(t,a,i,n,r,s){function l(){return S=e.copy(O)}function c(t,a){a=a||S;var i=_.filter(t,function(e){return e.credential_type===$.credential_type}),n=_.filter(t,function(e){return e.credential_type===B.credential_type});a.vehicle_registration=_.maxBy(i,function(e){return e.id})||e.copy($),a.vehicle_certificate=_.maxBy(n,function(e){return e.id})||e.copy(B)}function o(t){if(_.head(t.credential)&&"natural_person"===t.personType){var a=_.filter(t.credential,function(e){return e.credential_type==F.credential_type}),i=_.filter(t.credential,function(e){return e.credential_type==D.credential_type});t.driver_license=_.maxBy(a,function(e){return e.id}),t.passport=_.maxBy(i,function(e){return e.id})||e.copy(D)}return t}function d(t){return e.isArray(t.contact)&&t.contact.length>0&&(t.contact=_.sortBy(_.uniqBy(t.contact,function(e){return e.contact_type}),function(e){return e.contact_type})),t}function u(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970}function p(e){e.full=e.city+", "+e.street+", д."+e.house}function m(t){if(e.isArray(t.address)&&t.address.length>0){var a=_.filter(t.address,function(e){return 1===e.address_type});a=_.maxBy(a,function(e){return e.id});var i=_.filter(t.address,function(e){return 2===e.address_type});i=_.maxBy(i,function(e){return e.id});var n=_.filter(t.address,function(e){return 3===e.address_type});n=_.maxBy(n,function(e){return e.id}),t.is_same_address=!i,t.is_temporary_registration=Boolean(n),a&&(t.address_registration=a,p(a)),i&&(t.address_residential=i,p(i)),n&&(t.address_temporary_registration=n,p(n))}return t}function g(e,t){return t=t||a.calcType,A[t](e,S)}function v(e){return e=e||a.calcType,j[e]()}function f(e,t,i,n){return n=n||a.calcType,R[n](e,t,i)}function h(e,t){return t=t||a.calcType,N[t](e,t)}function b(e){return q.allTypes(e)}function y(e){return e=e||a.calcType,U[e]()}function w(e){return E.allTypes(e)}function k(){P.length=0,l()}function x(e){return e=e||a.calcType,L[e](e)}var S,P=[],C=r.calculation,I=function(e){return t("date")(e,"yyyy-MM-dd")},T={address_type:1,postal_index:null,content_type:482,country:"Россия",city:"",street:"",house:"",housing:"",flat:"",kladr:""},D={credential_type:1,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},F={credential_type:3,series:"",number:"",issue_date:"",issue_point:"РФ",expiration_date:""},$={credential_type:4,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},B={credential_type:7,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},M={is_same_address:!0,person_type:"natural_person",credential:[],isOwner:!1,isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:null,birth_date:"",passport:e.copy(D),address_registration:e.copy(T),address_residential:e.extend(e.copy(T),{address_type:2})},O={car_mark:null,car_model:null,car_modification:null,cost:0,vin_number:"",chassis_number:"",number_plate:"",engine_displacement:"",engine_power:"",engine_power_kilowatt:"",keys_count:C.driver_set.length||1,mileage:"",manufacturing_date:null,selectedCar:"",vehicle_registration:e.copy($),vehicle_certificate:e.copy(B),document_issue_date:"",mode:"edit"};l();var R={osago:function(t,a,r){var s,l=new Date,c=new n(e.extend(e.copy(M),{personType:a||"natural_person",isOwner:!1,isInsurant:!1,isDriver:!1,selectedPerson:"",mode:"edit"}));return t=t||{},"legal_person"===a?(c.extend({title:"",isDriver:!1,inn:"",ogrn:""}),c.address_registration=c.addAddress(e.copy(T))):(s=t.expirience||0===t.expirience?t.expirience:null,null===s&&(s=u(t.driving_experience_started)),c.extend({age:t.age||18,expirience:s,gender:"M",birth_date:t.birth_date||"",is_same_address:!0,is_temporary_registration:!1,driving_experience_started:t.driving_experience_started||""}),c.passport=c.addCredential(e.copy(D)),c.driver_license=c.addCredential(e.copy(F)),c.address_registration=c.addAddress(e.copy(T)),c.address_residential=c.addAddress(e.copy(T)),c.address_temporary_registration=c.addAddress(e.copy(T)),c.driving_experience_started||(l=new Date,l.setFullYear(l.getFullYear()-c.expirience),c.driver_license.issue_date=I(l),c.driving_experience_started=I(l))),c.extend(t),i.setPersonValidationDates(c),c.hasRole=function(){return c.isInsurant||c.isOwner},r||P.push(c),c}},j={osago:function(){return function(){return C.id||(C.insured_object=11920),C.insured_object?i.getInsuredObject(C.insured_object):s.when({})}().then(function(t){t&&t.id?g(t):_.forEach(C.driver_set,function(t){var a={isDriver:!0,showFioFields:!0};f(e.extend(a,t))}),e.extend(S,{car_mark:C.car_mark,car_model:C.car_model,car_modification:C.car_modification,cost:Math.floor(C.car_cost),car_body_number:"",vin_number:null,number_plate:"",engine_displacement:null,engine_power:C.engine_power,mileage:null,manufacturing_date:C.car_manufacturing_year+"-01-01",vehicle_registration:e.copy($),vehicle_certificate:e.copy(B),credential:[]}),e.extend(S,t.object),S.id=null;var i=_.head(P);if(C.is_legal_entity&&"false"!==C.is_legal_entity&&(i.address_registration=e.copy(T)),C.is_legal_entity&&a.currentUser){i.isInsurant=!1;var n=f({isInsurant:!0,isOwner:!1,isDriver:!1,title:a.currentUser.last_name,inn:a.currentUser.inn,ogrn:a.currentUser.ogrn},"legal_person");a.currentUser.address&&(e.extend(n.address_registration,a.currentUser.address),p(n.address_registration))}else i&&a.currentUser&&a.currentUser.id&&(i.passport&&!i.passport.series&&(i.passport.series=a.currentUser.passport_series,i.passport.number=a.currentUser.passport_number),i.address_registration&&!i.address_registration.city&&a.currentUser.address&&(e.extend(i.address_registration,a.currentUser.address),p(i.address_registration))),i.isInsurant=!0;i.isOwner=!0})}},A={osago:function(a){var i;P.length=0,S=a.object,c(S.credential),S.engine_power_kilowatt=+(.7355*C.engine_power).toFixed(2),S.engine_power=C.engine_power,_.forEach(a.person,function(e){var a=e.natural_person?"natural_person":"legal_person";e[a].personType=a,e[a].person=e.id,o(e[a]),m(e[a]),e[a].selectedPerson=e[a].external_id,"natural_person"===a&&(e[a].age=t("calcAge")(e[a].birth_date)),e.role.length&&_.forEach(e.role,function(t){e[a]["is"+t[0].toUpperCase()+t.substr(1)]=!0}),f(e[a])}),i=_.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,o(e),m(e)}),_.forEach(i,function(t){var a;_.forEach(P,function(i,n){t.external_id===i.external_id&&(a=!0,e.extend(i,t),i.isDriver=!0)}),t.driver_license=_.find(t.credential,function(e){return 3===e.credential_type})||e.copy(F),a||f(t)})}},N={osago:function(e){var t=P.indexOf(e),a=t-1>=0?t-1:t+1;e.isOwner&&(P[a].isOwner=!0),e.isInsurant&&(P[a].isInsurant=!0),-1!==t&&P.splice(t,1)}},U={osago:function(){e.forEach(P,function(e){e.address=[],e.credential=[],e.birth_date=I(e.birth_date),"natural_person"===e.personType&&((e.isInsurant||e.isOwner)&&(e.passport.credential_type=1,e.credential.push(e.passport)),e.isDriver&&(e.driver_license&&e.credential.push(e.driver_license),e.driving_experience_started=I(e.driving_experience_started)))});var t=_.find(P,function(e){return e.isOwner}),a=_.find(P,function(e){return e.isInsurant}),n=_.map(_.filter(P,function(e){return e.isDriver}),"id"),r={owner:t.person,beneficiary:t.person,insurant:a.person,drivers:n,object_type:"car",object_id:S.id};return S.credential=[],S.vehicle_registration&&S.credential.push(S.vehicle_registration),S.vehicle_certificate&&S.credential.push(S.vehicle_certificate),i.createInsuredObjectByIds(r)}},E={allTypes:function(t){return function(a){return e.isObject(a)&&(b(t),t.extend(a),t.getCredentialList().then(function(){o(t)}),t.getAddressList().then(function(){m(t)}),t.getContactList().then(function(){d(t)})),!0}}},q={allTypes:function(t){return e.extend(t,{id:null,age:t.selectedPerson?18:t.age,birth_date:"",last_name:"",first_name:"",patronymic:"",last_name_eng:"",first_name_eng:"",patronymic_eng:"",is_same_address:!0,driving_experience_started:"",selectedPerson:"",document:{credential_type:1,series:"Не указан",number:"",issue_date:""},title:"",title_eng:"",inn:"",ogrn:"",kpp:"",representative_first_name:"",representative_last_name:"",representative_patronymic:"",representative_post:"",representative_credential_type:"",representative_number:"",representative_issue_date:"",rsa_check_id:null,person:null,is_verified:null,is_current_user:!1}),t.pT=t.pT||t.personType,t.passport=t.addCredential(e.copy(D)),t.ogrntip=t.addCredential(e.copy(D)),t.driver_license=t.addCredential(e.copy(F)),t.address_registration=t.addAddress(e.copy(T)),t.address_residential=t.addAddress(e.copy(T)),t.address_temporary_registration=t.addAddress(e.copy(T)),t.contact=[{contact_type:1,data:""},{contact_type:2,data:""}],t.address_registration.country=null,t.address_residential.country=null,t.address_temporary_registration.country=null,t.credential.length=0,t.address.length=0,t.contact.length=0,t}},L={osago:function(){var e={isInsurant:!1,isOwner:!1,all:!1};return _.forEach(P,function(t){t.isInsurant&&(e.isInsurant=!0),t.isOwner&&(e.isOwner=!0)}),e.all=e.isInsurant&&e.isOwner,e}};return{addPerson:f,resetPerson:b,initFromCalculation:v,initFromInsuredObject:g,removePerson:h,persons:P,getPersons:function(){return P},createInsuredObject:y,resetAll:k,showSavedPersonsCallback:w,resetCar:l,getCar:function(){return S},setCarCredentials:c,getDefaultObject:function(t){var a={defaultAddressObject:T,defaultPassportObject:D,defaultDriverLicenseObject:F,defaultVehicleRegistrationObject:$};return e.copy(a[t])},setPersonCredential:o,setPersonAddress:m,setFullAddress:p,personCheckUsed:x}}])}(angular),function(e){e.module("brandingC",[])}(angular),function(e){"use strict";e.module("brandingC").service("brandingService",["CONSTS","$stateParams","brandingConfigs",function(t,a,i){var n={},r={};return n[t.currentBrand]=e.extend(r,i),n}])}(angular),function(e){e.module("AddingDocumentsC",[])}(angular),function(e){"use strict";e.module("AddingDocumentsC").service("addingDocumentsService",["letterService","$q","CONSTS",function(e,t,a){this.send=e.send,this.uploader=null}])}(angular),function(e){e.module("calculatorStepsC",[])}(angular),function(e){e.module("calculatorO",[])}(angular),function(e){"use strict";e.module("calculatorO").controller("calculatorCascoCtrl",["$state",function(e){}])}(angular),function(e,t){"use strict";e.module("calculatorO").controller("calculatorCtrl",["$scope","$state","formationPolicyService","$rootScope","$stateParams","Dictionary","calculatorService","CONSTS","$q","$location","Messages","formationPolicyStep1Service","calculatorStepsService","brandingConfigs","policyOrderingService",function(a,i,n,r,s,l,c,o,d,u,p,m,g,v,f){function h(e,a){var i=t(e).offset();a=void 0===a?"fast":a,i&&jQueryApp("html,body").animate({scrollTop:i.top},a)}function b(e){if(e&&e.length){var t=a.getResultWithKbm();_.forEach(e,function(e){e.sumWithKBM=a.setSumWithOtherKbm(e),t&&(e.currentKbm=parseFloat(t.variables.kbm))})}}var y,w={};console.log(4);var k=[30829,40405,30849,30835];a.calculationResult=[],a.calculationResultWithKbm=[],a.params=c.calculatorOtherParams,a.templates={navigation:v.templates.navigation||o.pathToModules+"shared/calculator/views/navigation.html"},a.getResultWithKbm=function(){var e;return _.find(k,function(t){if(e=_.find(a.calculationResult,function(e){return e.insurance_company.id===t}),a.calculationResultWithKbm.length&&(e=_.find(a.calculationResultWithKbm,function(e){return e.insurance_company.id===t})),e&&e.variables&&(e.variables.KBM&&e.variables.KBM.length||e.variables.kbm))return e}),e},a.scrollToAppElement=h.bind(null,".b-app",0),a.sendOrderLetter=f.sendOrderLetter,a.params.disableFields=!1,a.orderPolicy=function(){a.sendOrderLetter(),a.params.disableFields=!0},a.enterClientName=function(e){c.calculation.client_name=e},a.enterClientPhone=function(e){c.calculation.client_phone=e},a.bigSteps=g.bigSteps,a.setSumWithOtherKbm=function(e){var t,i=a.getResultWithKbm(),n=e.variables.S_orig||e.program.sum,s=0;return i&&i.variables&&(r.currentBrand.with_manual_kbm&&"full"!==g.calculationInterParams.calculation_type||!(e.variables.KBM&&e.variables.KBM.length||i.variables.kbm))?(e.variables.S_orig&&(s=e.program.sum-e.variables.S_orig),i.variables?(t=a.withoutManualKbm()?_.isArray(i.variables.KBM)?_.max(i.variables.KBM):_.isArray(i.variables.KBM_WITH_DOCUMENT)?_.maxBy(i.variables.KBM_WITH_DOCUMENT,function(e){return Number(e.kbm)}):i.variables.kbm?i.variables.kbm:1:+a.params.manualKbm,n*t+s):void 0):n},a.withoutManualKbm=function(){return!r.currentBrand.with_manual_kbm||"full"===g.calculationInterParams.calculation_type},a.setStep=function(e){a.step=e},a.root={messages:[],selectedResult:c.getSelectedResult()},a.calculation=c.calculation;var x=i.params.calculationId||a.calculation&&a.calculation.id;a.disabledSecondStep=!!a.calculation.id,a.calculateType=function(){return r.calcType},a.root.insuranceTypeTitle=function(){return"Калькулятор ОСАГО"},a.getCurrentCalcType=function(){return g.getCurrentCalcType()},x?(x!=a.calculation.id&&c.resetCalculation(),w.getCalculation=c.getCalculation(x).then(function(){y=e.copy(a.calculation)}),w.getResult=c.getResult(x).then(function(e){if(!e||!e.length||!e)return void a.root.messages.push("Ошибка со стороны страховой компании.");a.calculationResult=_.forEach(e,c.parseResult)})):c.resetCalculation(),a.selectResult=function(e){var t=_.find(a.calculationResult,function(t){return t.id===Number(e)});t=t||null;try{var i=a.getResultWithKbm();t.sumWithKBM=a.setSumWithOtherKbm(t),i&&(t.currentKbm=parseFloat(i.variables.kbm))}catch(e){_.noop()}c.setSelectedResult(t),a.root.selectedResult=c.getSelectedResult()},a.getYearRange=function(e,t){var a,i,n;return a=new Date,e=e||0,t=void 0===t?90:t,n=a.getFullYear()-t,i=a.getFullYear()-e,n+":"+i},a.resetCalculation=function(){a.calculation.id?p.success('Данные по расчету очищены, ваш расчет сохранен в разделе <a href="#/calculator/archive">Расчеты</a>.',7e3):p.success("Данные по расчету очищены.",4e3),c.resetCalculation(),m.resetAll(),a.calculationResult.length=0,u.search("policy",null),u.path("/calculator/"+r.calcType+"/",!1)},a.calculate=function(t){a.prevCalculationResult=e.copy(a.calculationResult),a.calculationResult.length=0,a.calculationResultWithKbm.length=0,a.params.resultsAreCreated=!1,a.selectResult(null),a.calculation.created_by_user=null,c.createCalculation().then(function(n){var s=[];a.root.messages.length=0,console.log("%c createCalculationSuccess ","color: green"),y=e.copy(a.calculation),i.go(i.current,{calculationId:a.calculation.id},{notify:!1}),c.companiesInProgress.length&&_.forEach(c.companiesInProgress,function(e){s.push(c.createResult(e.id).then(function(e){if(e=_.head(e),e.variables.KBM&&a.calculationResultWithKbm.push(e),parseInt(e.program.sum))return a.calculationResult.push(c.parseResult(e)),e}))}),"function"==typeof t&&t(n),d.all(s).then(function(e){var t=_.filter(_.flatten(e));if(b(t),console.log("%c createResultSuccess ","color: green"),setTimeout(function(){a.params.resultsAreCreated=!0},2e3),r.currentBrand.createCustomResult&&(a.calculationCustomResult=r.currentBrand.createCustomResult(t)),!t||!t.length)return a.root.messages.push("Ошибка на стороне сервера."),void(a.params.isCalculationProgress=!1);h(".js-kasko-result")},function(e){console.log("%c createResultError: ","color: red"),console.warn(e)}).then(function(e){a.params.isCalculationProgress=!1})},function(e){console.log("%c createCalculationError: ","color: red"),console.warn(e),a.root.messages.push("Не удалось создать расчет. Пожалуйста, попробуйте позже."),a.params.isCalculationProgress=!1})}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorO").controller("calculatorOsagoCtrl",["$scope","$http","calculatorService","CONSTS","$stateParams","Dictionary","$filter","formationPolicyService","formationPolicyStep1Service","$timeout","$rootScope","ngDialog","Person","calculatorStepsService","fakeData","brandingConfigs","smsService","policyOrderingService",function(t,a,i,n,r,s,l,c,o,d,u,p,m,g,v,f,h,b){function y(a){F=a.insurance_type,O=e.copy(a),t.params.drivers_count=a.driver_set.length,t.params.drivers_count_full=a.driver_set.length,a.insured_object?I(a.insured_object):w()}function w(){k()}function k(a){var i=e.copy(j);i.driver_license=o.getDefaultObject("defaultDriverLicenseObject");var n=new m(e.extend({},i,a));t.drivers.push(n)}function x(a){var i=new m(e.extend({},A,a));t.persons.push(i)}function S(){return(t.calculation.engine_power>9&&t.calculation.engine_power<=999||!t.calculation.engine_power)&&t.calculation.car_mark&&t.calculation.car_model&&t.calculation.car_manufacturing_year}function P(e,t){e.length=0;for(var a=0,i=t.length;i>a;a++)e.push(t[a])}function C(t,a){return e.isObject(t)?e.equals(t,a):null===t||null===a?Boolean(t)==Boolean(a):t==a}function I(t){return c.getInsuredObject(t).then(function(t){return B=e.copy(t),T(t)})}function T(a){var i=e.copy(a.person);return t.persons.length=0,t.drivers.length=0,a.object.vin_number?(t.osagoParams.vin_number=a.object.vin_number,t.osagoParams.vin_is_visible=!0):t.osagoParams.vin_is_visible=!1,e.forEach(i,function(a){var i=a.natural_person?"natural_person":"legal_person";a[i].selectedPerson=a[i].external_id,"natural_person"===i?(a[i].age=l("calcAge")(a[i].birth_date),a[i].expirience=l("calcAge")(a[i].driving_experience_started)):(t.osagoParams.legal_person.inn=a[i].inn,t.osagoParams.legal_person.title=a[i].title,t.osagoParams.legal_person.insurant_is_legal_person=!0),a[i].personType=i,o.setPersonCredential(a[i]),o.setPersonAddress(a[i]),a.role.length&&_.forEach(a.role,function(e){a[i]["is"+e.slice(0,1).toUpperCase()+e.slice(1,e.length)]=!0}),"natural_person"===i&&x(e.copy(a[i]))}),e.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,o.setPersonCredential(e),k(e)}),t.persons.length||t.drivers.length||x(),t.drivers.length&&(a.person.length&&(t.drivers[0].person=a.person[0].id),t.persons.length=0),t.cachedDrivers=e.copy(t.drivers),$={drivers:e.copy(t.drivers),persons:e.copy(t.persons)},a}function D(){var e=t.drivers.length?t.drivers:t.persons,a={car:{car_mark:t.calculation.car_mark,car_model:t.calculation.car_model,car_model_group:t.calculation.car_model_group||null,manufacturing_date:t.calculation.car_manufacturing_year+"-01-01",engine_power:t.calculation.engine_power||100,cost:0,vin_number:t.osagoParams.vin_number},persons:e};return c.createInsuredObjectOsago(a)}var F,$,B,M=i.getPromises(),O={},R=_.formatDate,j={credential:[],address:[],contact:[],first_name:"",last_name:"",patronymic:"",isDriver:!0,personType:"natural_person",birth_date:"",gender:"M",driving_experience_started:"",driver_license:o.getDefaultObject("defaultDriverLicenseObject")},A={is_same_address:!0,credential:[],isOwner:!0,personType:"natural_person",isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:"M",birth_date:"",passport:o.getDefaultObject("defaultPassportObject"),address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""}},N=[];t.dicts={},t.dynamicDicts={},t.persons=[],t.drivers=[],t.params.field_was_clicked=!1,t.params.showSMSbeforeCalcForm=!1,t.params.tech_inspection=u.currentBrand.has_checking_tech_inspection&&"has_tech_inspection",t.params.manualKbm=1,t.osagoParams={vin_number:"",vin_is_visible:!0,legal_person:{isOwner:!0,isInsurant:!1,inn:"",title:"",address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""},is_same_address:!0,personType:"legal_person"}},
i.calculationFormIsValid=function(){return!0},t.templates.program_list=f.templates.program_list||n.pathToModules+"osago/calculatorO/views/osago/calculation.program_list.html",t.templates.step_4=f.templates.step_4||n.pathToModules+"osago/calculatorO/views/osago/calculation.step_4.html",t.templates.tech_inspection=f.templates.tech_inspection||n.pathToModules+"osago/calculatorO/views/osago/calculation.tech_inspection.html",t.templates.program_list=f.templates.program_list||n.pathToModules+"osago/calculatorO/views/calculation.program_list.html",t.templates.calculation_step_5=f.templates.calculation_step_5||n.pathToModules+"osago/calculatorO/views/osago/calculation.step_5.html",t.templates.sms_step_osago=f.templates.sms_step_osago||n.pathToModules+"shared/carFilter/views/sms_step_osago.html",t.validation={},t.isVisible=function(e,a,i){var n;t.calculation.car_type;return i=i||t.calculation,"vin_number"===e&&(n=!Number(t.params.drivers_count_full)||t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity,i=t.osagoParams),n||(i[e]=a||null),n},t.isDisabled=function(e,a,i){t.calculation.car_type;i=i||t.calculation},_.isPromise(M.getCalculation)?M.getCalculation.then(y,w):t.calculation.id?i.getCalculation(t.calculation.id).then(y,w):w(),t.fieldChanged=function(e){"is_legal_entity"===e&&t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity&&(t.params.drivers_count=0,t.params.drivers_count_full=0,t.params.field_was_clicked=!1,t.driversCountChanged(),t.calculation.driver_set.length=0,t.calculation.is_multidrive=!0)},t.calculateOsago=function(){function a(){return u.currentBrand.preCalculationParse&&u.currentBrand.preCalculationParse(t.calculation),t.calculate(function(a){t.cachedDrivers=e.copy(t.drivers),c.drivers=_.map(t.drivers,function(e){return _.extend({},e)}),t.disabledFormationPolicyButtonIsActive=!0,O=e.copy(a)})}if(!t.calculationInterParams.sms_verification_passed&&u.currentBrand.with_sms_before_calculate&&"simple"!==t.calculationInterParams.calculation_type)return void(t.params.showSMSbeforeCalcForm=!0);t.params.resultsAreCreated=!1;var n=[],r=[];if(!t.params.isCalculationProgress){if(t.params.isCalculationProgress=!0,t.root.messages.length=0,t.calculation.is_calculate_osago=!0,t.calculation.car_cost="0",t.calculation.drivers_count=t.params.drivers_count,t.calculation.has_trailer=!!t.calculation.has_trailer,t.calculation.is_credit=!!t.calculation.is_credit,t.calculation.is_new_car=!!t.calculation.is_new_car,t.calculation.date_of_exploitation_period=t.calculation.car_manufacturing_year?t.calculation.car_manufacturing_year+"-01-01":null,delete t.calculation.insurance_type,delete t.calculation.insured_object,t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity?t.calculation.calculation_type=45427:t.calculation.calculation_type=45426,d(function(){t.params.resultsAreCreated=!0,t.params.isCalculationProgress=!1},5e3),"full"!==g.getCurrentCalcType())return a();t.calculation.drivers_count=t.params.drivers_count_full,t.calculation.driver_set.length=0,e.forEach(t.drivers,function(a){var i=l("calcAge")(a.birth_date),s=l("calcAge")(a.driving_experience_started);a.isDriver=!0,a.personType="natural_person",t.calculation.driver_set.push({age:i||18,expirience:s,is_married:!1,has_children:!1}),n.push(i),r.push(s),a.driver_license.credential_type=3,a.credential=[e.copy(a.driver_license)]}),i.rsaVerifiedDrivers=e.copy(t.drivers),e.forEach(t.persons,function(e){e.birth_date=R(e.birth_date),e.isDriver=!1,e.credential=[e.passport]}),!t.drivers.length&&t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity&&(t.persons=[t.osagoParams.legal_person]),t.calculation.drivers_minimal_age=Math.min.apply(Math,n),t.calculation.drivers_minimal_experience=Math.min.apply(Math,r),$={drivers:e.copy(t.drivers),persons:e.copy(t.persons)},D().then(function(e){t.calculation.insured_object=e.id||null,a()},function(){t.root.messages.push("Ошибка при сохранении объекта страхования."),t.params.isCalculationProgress=!1})}},t.calculationInterParams=g.calculationInterParams,t.clientParams=h.clientParams,t.showSMSformOsago=function(){return t.calculationInterParams.client_params_are_disabled=!0,t.clientParams.send_sms_text=!0,t.calculation.client_name=t.calculationInterParams.client_name||t.calculation.client_name,t.calculation.client_phone=t.calculationInterParams.client_phone||t.calculation.client_phone,h.sendCode(t.calculation.client_phone).then(function(e){h.codeSent(e.data)&&(t.calculationInterParams.sms_is_visible=!0),t.calculationInterParams.client_params_are_disabled=!1})},t.confirmCodeOsago=function(){return t.calculationInterParams.sms_button_is_disabled=!0,t.calculationInterParams.confirm_code_is_incorrect=!1,h.confirmCode(t.calculationInterParams.sms_code,t.calculationInterParams.client_phone).then(function(e){h.codeCorrect(e.data)?(t.calculationInterParams.sms_verification_passed=!0,t.calculateOsago(),b.sendLetterBeforeOrder()):t.calculationInterParams.confirm_code_is_incorrect=!0,t.calculationInterParams.sms_button_is_disabled=!1})},u.currentBrand.with_calculation_fake_data&&u.currentBrand.fake_calculation_fields&&v.fill(t.calculation,u.currentBrand.fake_calculation_fields),t.disabledSubmitButton=function(){return t.root.isSubmitButtonDisabled=!S()||!!t.params.isCalculationProgress,t.root.isSubmitButtonDisabled},t.addressIsValid=function(e){return e.city&&e.house&&e.street},t.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},function(){var a=["insuranceDuration","driversCountOsagoFull","driversCountOsagoSimple","ownerRegistration","kbm"];e.forEach(a,function(a){t.dicts[a]=s.getItems(a).then(function(t){return t=t.results?t.results:t,N[a]=e.copy(t),t})}),"volkov"===u.currentBrandName&&(t.dicts.driversCountOsagoSimple=t.dicts.driversCountOsagoFull),"petrosyan"===u.currentBrandName&&(t.dicts.driversCountOsagoSimple=t.dicts.driversCountOsagoSimple.then(function(e){return e.sort(function(e,t){var a=+e.id,i=+t.id;return 0===a?1:a>i?1:-1})}),t.dicts.driversCountOsagoFull=t.dicts.driversCountOsagoFull.then(function(e){return e.sort(function(e,t){var a=+e.id,i=+t.id;return 0===a?1:a>i?1:-1})})),t.dicts.trueFalse=[{title:"Да",id:!0},{title:"Нет",id:!1}],t.dicts.isLegalEntity=[{title:"Физическое лицо",id:!1},{title:"Юридическое лицо",id:!0}],t.dicts.insuranceDuration=t.dicts.insuranceDuration.then(function(e){var t=u.currentBrand.insurance_duration_codes;return t&&t.length?_.map(t,function(t){return _.find(e,function(e){return e.code==t})}):_.filter(e,function(e){return"1 год"===e.title})})}(),t.driversCountChanged=function(){var e=t.drivers.length,a=t.params.drivers_count_full;if(t.calculation.is_multidrive=!a,a&&"0"!==a?(t.persons.length=0,t.osagoParams.vin_is_visible=!1,t.osagoParams.vin_number=""):(t.persons.length=0,x(),t.osagoParams.vin_is_visible=!0),a>e)for(var i=0;a-e>i;i++)k();else t.drivers.length=+a},t.driversCountChangedSimple=function(){var a=t.calculation.driver_set.length,n=t.params.drivers_count;if(t.params.field_was_clicked){if(n>a)for(var r=0;n-a>r;r++)t.calculation.driver_set.push(e.copy(i.defaultCalcDriver));else t.calculation.driver_set.length=+n;t.calculation.is_multidrive=!t.calculation.driver_set.length}},t.driversDateChanged=function(e){var t=new Date(e.birth_date),a=new Date(e.driving_experience_started),i=(new Date).setFullYear((new Date).getFullYear()-77),n=a<i;t.setDate(t.getDate()+1),e.dateIsInvalid=a-t<5679936e5||n},t.disabledFormationPolicyButton=function(){var e,a;if(a=["created_at","id","deductible_value","drivers_count","is_new_car"],O){O.car_cost=parseInt(O.car_cost,10)+"",t.calculation.car_cost=parseInt(t.calculation.car_cost,10)+"";for(e in t.calculation)if(t.calculation.hasOwnProperty(e)&&-1===a.indexOf(e)&&!C(t.calculation[e],O[e]))return t.root.isFormationPolicyButtonDisabled=!0,!0}return t.root.isFormationPolicyButtonDisabled=!1,!1},t.resetPerson=function(e){o.resetPerson(e)},function(e,a,i){t.dynamicDicts[e]=function(){return t.dicts[e].then(function(e){return{items:e,changingCondition:function(){return a()},action:i}})}}("insuranceDuration",function(){return{is_legal_entity:t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity}},function(e,t){var a,i=["1year","9month","8month","7month","6month","5month","4month","3month"],n=u.currentBrand.insurance_duration_codes||i;t.is_legal_entity&&(n=["1year"]),a=_.filter(N.insuranceDuration,function(e){return-1!==n.indexOf(e.code)}),P(e.items,a)})}])}(angular),function(e,t){"use strict";e.module("calculatorO").service("calculatorService",["$http","$q","CONSTS","$rootScope","resources","calculator","$filter","requester",function(a,i,n,r,s,l,c,o){function d(e){var a=t(".ui-datepicker-year").val();return(e=new Date(e))?(e.setFullYear(a),c("date")(e,"yyyy-MM-dd")):""}var u=l.getDefaults(),p=function(e){return e=e||new Date,c("date")(e,"yyyy-MM-dd")},m={full_year:null,field_was_clicked:!1,drivers_count:1,drivers_count_full:1,signalization_type:"",show_empty_fields:!1,resultsAreCreated:!1};this.parseResult=function(e){return e.company_logo="https://enter.b2bpolis.ru/"+e.insurance_company.logo,e},this.currentResult=null,this.getOtherCompanies=function(){return[{id:41243,title:"Росгосстрах",insurance_company:{logo:"media/logo_main_ins/Logo_24.png"}},{id:41465,title:"Ренессанс",insurance_company:{logo:"media/logo_main_ins/Logo_47.png"}}]},this.calculation=e.copy(u),this.companiesInProgress=[],this.getDefaultCalculation=function(){return u},this.selectedResult=null,this.setSelectedResult=function(e){this.selectedResult=e},this.getSelectedResult=function(){return this.selectedResult},this.calculationFormIsValid=_.noop,this._promises={},this.getPromises=function(){return this._promises},this.calculatorOtherParams=e.copy(m),this.resetCalculation=function(t){var a=e.copy(this.getDefaultCalculation());this.companiesInProgress.length=0,t=t||r.calcType;for(var i in this.calculation)this.calculation.hasOwnProperty(i)&&delete this.calculation[i];for(var n in a)a.hasOwnProperty(n)&&(this.calculation[n]=a[n]);for(var s in this.calculatorOtherParams)this.calculatorOtherParams.hasOwnProperty(s)&&(this.calculatorOtherParams[s]=m[s]);return this["to_defaults_"+t]&&this["to_defaults_"+t](),this},this.to_defaults_osago=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.drivers_count=1,this.calculation.calculation_at_date=p(t)},this.defaultCalcDriver={is_married:!1,gender:"M",expirience:null,age:null,has_children:!1},this.createCalculation=function(t){return t=t||this.calculation,this.companiesInProgress.length=0,t=this.correctCalculation(t),delete t.token,o.post(s.calculation+"?token",t).then(function(t){var a,i=t.data,n=["optional_equipment"];this.calculationToken=i.token,this.companiesInProgress=i.available_insurance_departments,delete i.available_insurance_departments;for(a in i)i.hasOwnProperty(a)&&-1===n.indexOf(a)&&(e.equals(this.calculation[a],i[a])||(this.calculation[a]=i[a]));return t.data}.bind(this))},this.getCalculation=function(e){return(e=e||this.calculation.id)==this.calculation.id?i.when(this.calculation):(this._promises.getCalculation=o.get(s.calculation+e+"/").then(function(e){var t;e=e.data;for(t in e)"user"!==t&&(this.calculation[t]=e[t]);return this.calculation}.bind(this)),this._promises.getCalculation)},this.getResult=function(e){return e=e||this.calculation.id,o.get(s.calculationV3+e+"/result/?insurance_company=1&messages=1&variables=1").then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.createResult=function(e,t){var i=this.calculationToken;t=t||this.calculation.id;var n="https://enter.b2bpolis.ru"+s.calculationV3+t+"/result/"+e+"/?insurance_company=1&messages=1&variables=1";return a({url:n,method:"POST",headers:{"X-Calculation-Token":i}}).then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.getCredentialList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/credential").then(function(e){return e.data})},this.getAddressList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/address").then(function(e){return e.data})},this.correctCalculation=function(e){return e=e||this.calculation},this.personDateChanged=function(e,t,a){t=t||"birth_date",-1!==t.indexOf(".")?(t=t.split("."),e[t[0]][t[1]]=d(e[t])):e[t]=d(e[t])},this.validateDrivers=function(){var e,t,a=this.calculation.driver_set.length;if(0===a)return!0;for(e=0;e<a;e++)if(t=this.calculation.driver_set[e],t.age-t.expirience<17)return!1;return!0}}])}(angular,jQueryApp),function(e){e.module("formationPolicy",[])}(angular),function(e){"use strict";e.module("formationPolicy").service("formationPolicyService",["$http","CONSTS","$q","$rootScope","$filter","resources","requester",function(t,a,i,n,r,s,l){function c(e){var t;return t="legal_person"===e.personType?["title","title_eng","id","inn","ogrn","kpp","representative_first_name","representative_last_name","representative_patronymic","representative_post","representative_credential_type","representative_number","representative_issue_date"]:["id","first_name","last_name","patronymic","first_name_eng","last_name_eng","patronymic_eng","birth_date","gender","driving_experience_started","is_individual_entrepreneur","is_foreigner"],_.pick(e,t)}var o={object:{credential:[{issue_date:"2016-02-04",creator:10585,series:"3456",number:"45",object_id:1751,issue_point:"",credential_type:10,content_type:480,expiration_date:null,external_id:"9374",id:5449}],keys_count:2,manufacturing_date:"2015-01-01",engine_power:"200.00",car_modification:null,creator:10585,car_model:7687,engine_displacement:"2.00",car_body_number:null,mileage:null,number_plate:"",car_mark:303,vin_number:"55TTEEE5E5R5R6TT7",external_id:"7628",id:1751,cost:null},object_type:"car",person:[]},d=_.formatDate,u=null,p=null;return{clear:function(){p=null},resetCurrentPolicy:function(){u=null},updateCustomer:function(e){var a=i.defer();return this.getCustomer(null).then(function(i){i.natural_persons=i.natural_persons.concat(e.natural_persons),i.natural_persons=_.uniq(i.natural_persons),t.put(s.customer+"/null",i).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},getCustomer:function(e){return e=e||null,t.get(s.customer+"/"+e).then(function(e){return e.data})},getCustomerCars:function(e){return e=e||null,t.get(s.customerCar,{params:{owner:e}}).then(function(e){return e.data})},getCarCredential:function(e){return t.get(s.customerCar+"/"+e+"/credential").then(function(e){return e.data})},getCustomerFull:function(e){var a=i.defer();return this.getCustomer(e).then(function(e){t.get(s.person+"/"+e.person).then(function(i){var n=i.data,r="naturalPerson",l=n.natural_person;n.legal_person&&(r="legalPerson",l=n.legal_person),t.get(s[r]+"/"+l).then(function(t){var i=t.data;a.resolve({person:i,drivers:e.natural_persons})},function(e){a.reject(e)})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},saveCar:function(a){var n=i.defer(),r=_.pick(a,["id","mileage","car_mark","car_model","car_modification","owner","manufacturing_date","vin_number","number_plate","engine_displacement","engine_power","cost","keys_count"]),l="post",c=s.customerCar;return r.owner=r.owner||null,r.id&&(l="put",c+="/"+r.id),t[l](c,r).then(function(r){var l=r.data,c=_.map(a.credential,function(e){return _.pick(e,["id","number","series","credential_type","issue_date","issue_point","expiration_date"])}),o=[];e.forEach(c,function(e){var a="post",i=s.customerCar+"/"+l.id+"/credential";e.id&&(a="put",i+="/"+e.id),o.push(t[a](i,e).then(function(e){return e.data}))}),i.all(o).then(function(e){n.resolve({car:l,credential:e})},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},createDeal:function(a){var n=i.defer();return t.post(s.deal,e.extend({deal_status:1,customer:null},a)).then(function(e){var i=e.data;i.car=a.car,t.put(s.deal+"/"+i.id,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},getDeal:function(e){return t.get(s.deal+"/"+e)},createInsuranceProduct:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/from-calculation",a).then(function(e){return e.data})},updateInsuranceProduct:function(e,a,i){return t.put(s.deal+"/"+e+"/insurance-product/"+a,i).then(function(e){return e.data})},createInvoice:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/"+a+"/invoice/generate").then(function(e){return e.data})},createPersonContainer:function(e,a){var i={};return a="legal_person"===a?"legal_person":"natural_person",i[a]=e,t.post(s.person,i).then(function(e){return e.data})},saveBSO:function(e,a){return t.post(s.resultPolicy+"/"+e+"/enter_bso/",a).then(function(e){return e.data})},createInsuredObjectByIds:function(e){return t.post("/rest/default/client/insured-object",e).then(function(e){return e.data})},createInsuredObjectOsago:function(t){var a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:+t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,car_body_number:t.car.car_body_number,engine_power_kilowatt:t.car.engine_power_kilowatt,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]};return e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this),e.forEach(t.persons,function(t,i){var n,r,s={},l=[],o=t.id||this.generateId(),u=t.address_registration?[t.address_registration]:[],p=c(t),m=t.personType;u&&u.lendth&&(u[0].address_type=1),"natural_person"===m?(r=t.credential,e.forEach(r,function(e){e&&(e.issue_date=d(e.issue_date),e.external_id=e.id||this.generateId())},this),!t.is_same_address&&t.address_residential&&(u.push(t.address_residential),u[1].content_type=482,u[1].address_type=2),t.birth_date=d(t.birth_date),t.driving_experience_started=d(t.driving_experience_started)):r=null,e.forEach(["owner","insurant"],function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&l.push(e)}),l.length>0&&(s.role=l,s.external_id=o,s.id=t.person_id,s[m]=p,s[m].external_id=o,s[m].credential=r,s[m].address=u,a.person.push(s)),t.isDriver&&(n=e.copy(p),n.external_id=o,n.credential=[],n.credential.push(_.find(r,function(e){return 3===e.credential_type})),n.credential.push(_.find(r,function(e){return 1===e.credential_type})),n.credential[1]||(n.credential.length=1),a.drivers.push(n))},this),l.post(s.insuredObjectOsago,a).then(function(t){return p=e.copy(t.data),t.data})},sendPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token",_.pick(e,"phone")).then(function(e){return e.data})},confirmPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token-verified",_.pick(e,"token")).then(function(e){return e.data})},toPay:function(e){return t.post("/payment/"+e+"/ ").then(function(e){return e.data})},createInsuredObject:function(t){var a,i;return t.car?(a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,is_new_car:t.car.is_new_car,is_temporary:t.car.is_temporary,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]},i=["owner","insurant","beneficiary"],e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this)):(a=o,i=["owner","insurant"]),e.forEach(t.persons,function(t,n){var r,s,l={},o=[],u=t.id||this.generateId(),p=[t.address_registration],m=_.filter(t.contact,function(e){return e.data}),g=c(t),v=t.personType;"legal_person"===v?s=null:(s=t.credential,e.forEach(s,function(e){e.issue_date=d(e.issue_date),e.external_id=e.id||this.generateId()},this),t.is_same_address||p.push(t.address_residential),t.is_temporary_registration&&p.push(t.address_temporary_registration),t.birth_date=d(new Date(t.birth_date)),t.driving_experience_started=t.driving_experience_started?d(new Date(t.driving_experience_started)):null),e.forEach(i,function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&o.push(e)}),e.forEach(p,function(e){e&&!e.country&&(e.country="Россия")}),o.length>0&&(l.role=o,l.external_id=u,l.id=t.person_id,l[v]=g,l[v].external_id=u,l[v].contact=m,l[v].credential=s,l[v].address=p,a.person.push(l)),t.isDriver&&(r=e.copy(g),r.external_id=u,r.address=p,r.credential=_.filter(s,function(e){return 3===e.credential_type}),a.drivers.push(r))},this),l.post(s.insuredObject,a).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObject:function(t){return l.get(s.insuredObject+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObjectOsago:function(t){return l.get(s.insuredObjectOsago+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getPolicyFile:function(e,a){return a=a?"?type="+a:"",t({method:"GET",url:s.resultPolicy+e+"/template/"+a,headers:{}}).then(function(e){return e.data})},createInsuredObjectCRM:function(e){return t.post(s.insuredObjectCRM,e).then(function(e){return e.data})},createPolicy:function(a){return t.post(s.resultPolicy,e.extend({external_id:null},a)).then(function(e){return u=e.data})},savePolicy:function(a){var i="post",n=s.resultPolicy;return a.id&&(i="put",n=s.resultPolicy+a.id+"/"),t[i](n,e.extend({external_id:null},a)).then(function(e){return u=e.data})},getPolicy:function(e){return t.get(s.resultPolicy+e+"/",{params:{external_id:null}}).then(function(e){return u=e.data})},getSavedNaturalPersons:function(e){return t.get(s.savedNaturalPersons,{params:e}).then(function(e){return e.data})},getSavedLegalPersons:function(e){return t.get(s.savedLegalPersons,{params:e}).then(function(e){return e.data})},getSavedCars:function(e){return t.get(s.savedCars,{params:e}).then(function(e){return e.data})},getInsObjList:function(e){return t.get(s.insuredObectList,{params:e}).then(function(e){return console.log(e),e.data})},getCurrentPolicy:function(){return u},getCurrentInsuredObject:function(){return p},sendNotification:function(e){return t.post(s.notificationSend,e).then(function(e){return e.data})},generateId:function(){return~~(9900*Math.random()+100)},getPolicyActionsParameters:function(e){return t.get(s.resultPolicy+e+"/actions_parameters/",{params:{external_id:null}}).then(function(e){return e.data})},executePolicyAction:function(e,i,n){return t.post(a.urlPrefixPolicy+"result_policy/"+e+"/"+i+"/",n).then(function(e){return e.data})},getPolicyDocsArchive:function(e){return t.get(a.urlPrefixPolicy+"result_policy/"+e+"/zip/").then(function(e){return e.data})},getPolicyAttachments:function(e){return t.get(s.resultPolicy+e+"/attachment/").then(function(e){return e.data})},deletePolicyAttachment:function(e,a){return t.delete(s.resultPolicy+e+"/attachment/"+a).then(function(e){return e.data})},issueToSavedPolicy:function(e){return t.post(s.resultPolicy+e+"/issue_to_saved_policy/").then(function(e){return e})},setPersonValidationDates:function(e){e.isDriver?(e.birthDateRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age-1),d(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age),d(t)}()},e.expirienceRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience-1),d(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience),d(t)}()}):(e.birthDateRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-90),d(e)}(),max:function(){var e=new Date;return e.setFullYear(e.getFullYear()-18),d(e)}()},e.expirienceRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-72),d(e)}(),max:function(){return d(new Date)}()}),e.birthDateRange.yearRange=new Date(e.birthDateRange.min).getFullYear()+":"+new Date(e.birthDateRange.max).getFullYear(),e.expirienceRange.yearRange=new Date(e.expirienceRange.min).getFullYear()+":"+new Date(e.expirienceRange.max).getFullYear(),e.dateChanged=function(t,a){var i=new Date(t).getFullYear(),n=new Date(a).getFullYear();e.invalidDates=i-n>=18}}}}])}(angular),function(e,t){"use strict";e.module("formationPolicy").service("formationPolicyStep1Service",["$filter","$rootScope","formationPolicyService","Person","calculatorService","$q",function(t,a,i,n,r,s){function l(){return S=e.copy(O)}function c(t,a){a=a||S;var i=_.filter(t,function(e){return e.credential_type===$.credential_type}),n=_.filter(t,function(e){return e.credential_type===B.credential_type});a.vehicle_registration=_.maxBy(i,function(e){return e.id})||e.copy($),a.vehicle_certificate=_.maxBy(n,function(e){return e.id})||e.copy(B)}function o(t){if(_.head(t.credential)&&"natural_person"===t.personType){var a=_.filter(t.credential,function(e){return e.credential_type==F.credential_type}),i=_.filter(t.credential,function(e){return e.credential_type==D.credential_type});t.driver_license=_.maxBy(a,function(e){return e.id}),t.passport=_.maxBy(i,function(e){return e.id})||e.copy(D)}return t}function d(t){return e.isArray(t.contact)&&t.contact.length>0&&(t.contact=_.sortBy(_.uniqBy(t.contact,function(e){return e.contact_type}),function(e){return e.contact_type})),t}function u(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970}function p(e){e.full=e.city+", "+e.street+", д."+e.house}function m(t){if(e.isArray(t.address)&&t.address.length>0){var a=_.filter(t.address,function(e){return 1===e.address_type});a=_.maxBy(a,function(e){return e.id});var i=_.filter(t.address,function(e){return 2===e.address_type});i=_.maxBy(i,function(e){return e.id});var n=_.filter(t.address,function(e){return 3===e.address_type});n=_.maxBy(n,function(e){return e.id}),t.is_same_address=!i,t.is_temporary_registration=Boolean(n),a&&(t.address_registration=a,p(a)),i&&(t.address_residential=i,p(i)),n&&(t.address_temporary_registration=n,p(n))}return t}function g(e,t){return t=t||a.calcType,A[t](e,S)}function v(e){return e=e||a.calcType,j[e]()}function f(e,t,i,n){return n=n||a.calcType,R[n](e,t,i)}function h(e,t){return t=t||a.calcType,N[t](e,t)}function b(e){return q.allTypes(e)}function y(e){return e=e||a.calcType,U[e]()}function w(e){return E.allTypes(e)}function k(){P.length=0,l()}function x(e){return e=e||a.calcType,L[e](e)}var S,P=[],C=r.calculation,I=function(e){return t("date")(e,"yyyy-MM-dd")},T={address_type:1,postal_index:null,content_type:482,country:"Россия",city:"",street:"",house:"",housing:"",flat:"",kladr:""},D={credential_type:1,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},F={credential_type:3,series:"",number:"",issue_date:"",issue_point:"РФ",expiration_date:""},$={credential_type:4,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},B={credential_type:7,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},M={is_same_address:!0,person_type:"natural_person",credential:[],isOwner:!1,isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:null,birth_date:"",passport:e.copy(D),address_registration:e.copy(T),address_residential:e.extend(e.copy(T),{address_type:2})},O={car_mark:null,car_model_group:null,car_model:null,car_manufacturing_year:null,car_modification:null,cost:0,vin_number:"",chassis_number:"",number_plate:"",engine_displacement:"",engine_power:"",engine_power_kilowatt:"",engine_power_loshad:"",keys_count:C.driver_set.length||1,mileage:"",manufacturing_date:null,selectedCar:"",vehicle_registration:e.copy($),vehicle_certificate:e.copy(B),document_issue_date:"",mode:"edit"};l();var R={osago:function(t,a,r){var s,l=new Date,c=new n(e.extend(e.copy(M),{personType:a||"natural_person",isOwner:!1,isInsurant:!1,isDriver:!1,selectedPerson:"",mode:"edit"}));return t=t||{},"legal_person"===a?(c.extend({title:"",isDriver:!1,inn:"",ogrn:""}),c.address_registration=c.addAddress(e.copy(T))):(s=t.expirience||0===t.expirience?t.expirience:null,null===s&&(s=u(t.driving_experience_started)),c.extend({age:t.age||18,expirience:s,gender:"M",birth_date:t.birth_date||"",is_same_address:!0,is_temporary_registration:!1,driving_experience_started:t.driving_experience_started||""}),c.passport=c.addCredential(e.copy(D)),c.driver_license=c.addCredential(e.copy(F)),c.address_registration=c.addAddress(e.copy(T)),c.address_residential=c.addAddress(e.copy(T)),c.address_temporary_registration=c.addAddress(e.copy(T)),c.driving_experience_started||(l=new Date,l.setFullYear(l.getFullYear()-c.expirience),c.driver_license.issue_date=I(l),c.driving_experience_started=I(l))),c.extend(t),i.setPersonValidationDates(c),c.hasRole=function(){return c.isInsurant||c.isOwner},r||P.push(c),c}},j={osago:function(){return function(){return C.id||(C.insured_object=11920),C.insured_object?i.getInsuredObject(C.insured_object):s.when({})}().then(function(t){t&&t.id?g(t):0===P.length&&_.forEach(C.driver_set,function(t){var a={isDriver:!0,showFioFields:!0};f(e.extend(a,t))}),e.extend(S,{car_mark:C.car_mark,car_model:C.car_model,car_modification:C.car_modification,cost:Math.floor(C.car_cost),car_body_number:"",vin_number:null,number_plate:"",engine_displacement:null,engine_power:C.engine_power,mileage:null,manufacturing_date:C.car_manufacturing_year+"-01-01",vehicle_registration:e.copy($),vehicle_certificate:e.copy(B),credential:[]}),e.extend(S,t.object),S.id=null;var i=_.head(P);if(C.is_legal_entity&&"false"!==C.is_legal_entity&&(i.address_registration=e.copy(T)),C.is_legal_entity&&a.currentUser){i.isInsurant=!1;var n=f({isInsurant:!0,isOwner:!1,isDriver:!1,title:a.currentUser.last_name,inn:a.currentUser.inn,ogrn:a.currentUser.ogrn},"legal_person");a.currentUser.address&&(e.extend(n.address_registration,a.currentUser.address),p(n.address_registration))}else i&&a.currentUser&&a.currentUser.id&&(i.passport&&!i.passport.series&&(i.passport.series=a.currentUser.passport_series,i.passport.number=a.currentUser.passport_number),i.address_registration&&!i.address_registration.city&&a.currentUser.address&&(e.extend(i.address_registration,a.currentUser.address),p(i.address_registration))),i.isInsurant=!0;i.isOwner=!0})}},A={osago:function(a){var i;P.length=0,S=a.object,c(S.credential),S.engine_power_kilowatt=+(.7355*C.engine_power).toFixed(2),S.engine_power=C.engine_power,_.forEach(a.person,function(e){var a=e.natural_person?"natural_person":"legal_person";e[a].personType=a,e[a].person=e.id,o(e[a]),m(e[a]),e[a].selectedPerson=e[a].external_id,"natural_person"===a&&(e[a].age=t("calcAge")(e[a].birth_date)),e.role.length&&_.forEach(e.role,function(t){e[a]["is"+t[0].toUpperCase()+t.substr(1)]=!0}),f(e[a])}),i=_.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,o(e),m(e)}),_.forEach(i,function(t){var a;_.forEach(P,function(i,n){t.external_id===i.external_id&&(a=!0,e.extend(i,t),i.isDriver=!0)}),t.driver_license=_.find(t.credential,function(e){return 3===e.credential_type})||e.copy(F),a||f(t)})}},N={osago:function(e){var t=P.indexOf(e),a=t-1>=0?t-1:t+1;e.isOwner&&(P[a].isOwner=!0),e.isInsurant&&(P[a].isInsurant=!0),-1!==t&&P.splice(t,1)}},U={osago:function(){e.forEach(P,function(e){e.address=[],e.credential=[],e.birth_date=I(e.birth_date),"natural_person"===e.personType&&((e.isInsurant||e.isOwner)&&(e.passport.credential_type=1,e.credential.push(e.passport)),e.isDriver&&(e.driver_license&&e.credential.push(e.driver_license),e.driving_experience_started=I(e.driving_experience_started)))});var t=_.find(P,function(e){
return e.isOwner}),a=_.find(P,function(e){return e.isInsurant}),n=_.map(_.filter(P,function(e){return e.isDriver}),"id"),r={owner:t.person,beneficiary:t.person,insurant:a.person,drivers:n,object_type:"car",object_id:S.id};return S.credential=[],S.vehicle_registration&&S.credential.push(S.vehicle_registration),S.vehicle_certificate&&S.credential.push(S.vehicle_certificate),i.createInsuredObjectByIds(r)}},E={allTypes:function(t){return function(a){return e.isObject(a)&&(b(t),t.extend(a),t.getCredentialList().then(function(){o(t)}),t.getAddressList().then(function(){m(t)}),t.getContactList().then(function(){d(t)})),!0}}},q={allTypes:function(t){return e.extend(t,{id:null,age:t.selectedPerson?18:t.age,birth_date:"",last_name:"",first_name:"",patronymic:"",last_name_eng:"",first_name_eng:"",patronymic_eng:"",is_same_address:!0,driving_experience_started:"",selectedPerson:"",document:{credential_type:1,series:"Не указан",number:"",issue_date:""},title:"",title_eng:"",inn:"",ogrn:"",kpp:"",representative_first_name:"",representative_last_name:"",representative_patronymic:"",representative_post:"",representative_credential_type:"",representative_number:"",representative_issue_date:"",rsa_check_id:null,person:null,is_verified:null,is_current_user:!1}),t.pT=t.pT||t.personType,t.passport=t.addCredential(e.copy(D)),t.ogrntip=t.addCredential(e.copy(D)),t.driver_license=t.addCredential(e.copy(F)),t.address_registration=t.addAddress(e.copy(T)),t.address_residential=t.addAddress(e.copy(T)),t.address_temporary_registration=t.addAddress(e.copy(T)),t.contact=[{contact_type:1,data:""},{contact_type:2,data:""}],t.address_registration.country=null,t.address_residential.country=null,t.address_temporary_registration.country=null,t.credential.length=0,t.address.length=0,t.contact.length=0,t}},L={osago:function(){var e={isInsurant:!1,isOwner:!1,all:!1};return _.forEach(P,function(t){t.isInsurant&&(e.isInsurant=!0),t.isOwner&&(e.isOwner=!0)}),e.all=e.isInsurant&&e.isOwner,e}};return{addPerson:f,resetPerson:b,initFromCalculation:v,initFromInsuredObject:g,removePerson:h,persons:P,getPersons:function(){return P},createInsuredObject:y,resetAll:k,showSavedPersonsCallback:w,resetCar:l,getCar:function(){return S},setCarCredentials:c,getDefaultObject:function(t){var a={defaultAddressObject:T,defaultPassportObject:D,defaultDriverLicenseObject:F,defaultVehicleRegistrationObject:$};return e.copy(a[t])},setPersonCredential:o,setPersonAddress:m,setFullAddress:p,personCheckUsed:x}}])}(angular),function(e){e.module("AddingDocuments",[])}(angular),function(e){"use strict";e.module("AddingDocuments").controller("AddingDocumentsCtrl",["$scope","FileUploader","CONSTS","addingDocumentsService","$rootScope","brandingConfigs",function(e,t,a,i,n,r){e.typeInput="personalData",e.labels={},e.labels.save_data="lider"===n.currentBrandName?"Онлайн заявка":"Сохранить данные",e.isSaveDataProgress=!1,e.uploader=i.uploader||new t({url:"/some_url",formData:[{attachment_type:1,description:""}]}),i.uploader=e.uploader,e.checkFiles=function(){console.log(i.uploader)},e.confirmationList={},e.addingDocumentsTemplates={uploader:r.templates.adding_documents||r.templates.uploader||a.pathToModules+"osago/AddingDocuments/views/adding_documents.uploader.html",form:a.pathToModules+"osago/personalData/views/personal_data.html",currentTemplate:n.browser.isIE||n.currentBrand.installation_via_api?"form":"uploader",selectTemplate:function(t){e.addingDocumentsTemplates.currentTemplate=t,n.addingDocumentsTemplates=t}}}])}(angular),function(e){"use strict";e.module("AddingDocuments").service("addingDocumentsService",["letterService","$q","CONSTS",function(e,t,a){this.send=e.send,this.uploader=null}])}(angular),function(e){e.module("branding",[])}(angular),function(e){"use strict";e.module("branding").service("brandingService",["CONSTS","brandingConfigs",function(t,a){var i={},n={};return i[t.currentBrand]=e.extend(n,a),i}])}(angular),function(e){"use strict";e.module("personalData",[])}(angular),function(e){"use strict";e.module("personalData").controller("personalDataCtrl",["$scope","CONSTS","Person","formationPolicyStep1Service","formationPolicyService","$filter","$state","Dictionary","calculatorService","calculatorStepsService","$rootScope","brandingConfigs",function(t,a,i,n,r,s,l,c,o,d,u,p){function m(e){return s("date")(e,"dd.MM.yyyy")}function g(e,t){var a="";return e.city&&(a+=t+": ",a+=e.city+" "+e.street+" д."+e.house+" ",e.housing&&(a+="Корпус "+e.housing+" "),e.flat&&(a+="Кв./офис "+e.flat+" "),a+="\n"),a}t.params={person_type:null,number_type:"vin_number",car_document_type:"vehicle_registration"},t.labels={},t.labels.save_data="lider"===u.currentBrandName?"Онлайн заявка":"Сохранить данные",t.car=n.getCar(),t.calculatorParams=o.calculatorOtherParams,t.numberType=c.getItems("numberType"),t.carMarks=c.getItems("carMarks").then(function(e){return e.results}),t.carModelGroups=[],t.carMarksChanged=function(){t.carModelGroups=[],t.car.car_model_group=null,t.car.car_model=null,o.calculation.car_mark=t.car.car_mark,c.getItems("carModelGroups",{car_mark:t.car.car_mark}).then(function(e){t.carModelGroups=e.results})},t.carModels=[],t.carModelGroupChanged=function(){t.carModels=[],t.car.car_model=null,o.calculation.car_model_group=t.car.car_model_group,c.getItems("carModels",{car_model_group:t.car.car_model_group}).then(function(e){t.carModels=e.results})},t.carModelChanged=function(){o.calculation.car_model=t.car.car_model},t.fuelType=c.getItems("fuelType"),t.persons=n.persons,n.initFromCalculation(),t.addressIsValid=function(e){return e.city&&e.house&&e.street},t.savePersonalData=function(){var e="";switch(_.forEach(t.persons,function(t,a){e+=a+1+"-й участник договора"+(t.isDriver?" (Водитель): ":": ")+"\n",t.isOwner&&(e+="Собственник. "),t.isInsurant&&(e+="Страхователь. "),e+="\n","legal_person"===t.personType?(t.isOwner||t.isInsurant)&&(e+="Название: "+t.title+" ИНН:"+t.inn+" ОГРН:"+t.ogrn+"\n"):(e+="ФИО: "+t.last_name+" "+t.first_name+" "+(t.patronymic||"")+"\n",e+="Дата рождения: "+m(t.birth_date)+"\n",(t.isInsurant||t.isOwner)&&(e+="Серия и номер паспорта: "+t.passport.series+" "+t.passport.number+"\nДата получения: "+m(t.passport.issue_date)+"\nКем выдан: "+t.passport.issue_point+"\n"),console.log("person",t),t.isDriver&&(e+="Дата начала стажа: "+m(t.driving_experience_started)+"г.\n",e+="Водительское удостоверение: "+t.driver_license.series+" "+t.driver_license.number+"\n")),(t.isInsurant||t.isOwner)&&(e+=g(t.address_registration,"Адрес регистрации"),t.is_same_address||(e+=g(t.address_residential,"Адрес проживания"))),e+="\n"}),t.params.number_type){case"vin_number":e+="VIN-номер: "+t.car.vin_number+"\n";break;case"car_body_number":e+="Номер кузова: "+t.car.car_body_number+"\n";break;case"chassis_number":e+="Номер шасси: "+t.car.chassis_number+"\n"}e+="Гос. рег. знак: "+t.car.number_plate+"\n",e+="Пробег: "+t.car.mileage+"\n",t.car.engine_power_kilowatt&&(e+="Мощность в кВт: "+t.car.engine_power_kilowatt+"\n"),t.car.engine_power_loshad&&(e+="Мощность в л.с.: "+t.car.engine_power_loshad+"\n"),"vehicle_registration"==t.params.car_document_type&&(e+="ПТС серия:"+t.car.vehicle_registration.series+"номер: "+t.car.vehicle_registration.number+"\n"),"vehicle_certificate"==t.params.car_document_type&&(e+="СТС серия:"+t.car.vehicle_certificate.series+"номер: "+t.car.vehicle_certificate.number+"\n"),e+="Дата получения: "+m(t.car.document_issue_date)+"г.\n",t.car.engine_displacement&&(e+="Объем двигателя: "+t.car.engine_displacement+"\n"),"need_tech_inspection"===t.calculatorParams.tech_inspection&&(e+="Марка шин: "+t.car.tire_mark+"\n",e+="Тип топлива: "+t.car.fuel_type+"\n"),r.personalData=e,d.bigSteps.setBigStep("fourth")},t.setPersonAs=function(a,i){a[i]=!0,"isOwner"===i&&(a.isBeneficiary=!0),e.forEach(t.persons,function(e){a.$$hashKey!==e.$$hashKey&&(e[i]=!1,a.isBeneficiary=!1)})},t.setPersonType=function(e,a){e[a]?t.setPersonAs(e,a):e[a]=!1},t.addPerson=function(e,a){a=a||"natural_person",t.params.person_type=null,n.addPerson(e,a)},t.removePerson=function(e){n.removePerson(e)},t.insurantTypes=[{id:"natural_person",title:"Физическое лицо"},{id:"legal_person",title:"Юридическое лицо"}],t.allDriversAreChanged=function(){var e=_.filter(t.persons,function(e){return e.isDriver});return e&&e.length===t.calculation.driver_set.length},t.personCheckUsed=n.personCheckUsed,t.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},t.templates={persons:a.pathToModules+"osago/personalData/views/personal_data.form.persons.html",person_block:p.templates.person_block||a.pathToModules+"osago/personalData/views/personal_data.form.person_block.html",person_block_legal:a.pathToModules+"osago/personalData/views/personal_data.form.person_block_legal.html",addresses_block:a.pathToModules+"osago/personalData/views/personal_data.addresses_block.html",address_registration:a.pathToModules+"osago/personalData/views/personal_data.address_registration.html",address_residential:a.pathToModules+"osago/personalData/views/personal_data.address_residential.html",person_roles:a.pathToModules+"osago/personalData/views/personal_data.form.person_roles.html",car:p.templates.personal_data_form_car||a.pathToModules+"osago/personalData/views/personal_data.form.car.html"}}])}(angular),function(e){e.module("calculatorStepsO",[])}(angular),function(e){e.module("AddingDocumentsS",[])}(angular),function(e){"use strict";e.module("AddingDocumentsS").controller("AddingDocumentsCtrl",["$scope","FileUploader","CONSTS","addingDocumentsService","Dictionary","$rootScope",function(e,t,a,i,n,r){e.typeInput="personalData",e.omsParams=i.omsParams,e.isSaveDataProgress=!1,e.uploader=i.uploader||new t({url:"/some_url",formData:[{attachment_type:1,description:""}]}),i.uploader=e.uploader,e.omsCategories=n.getItems("omsCategories"),e.selectCategory=function(t){e.omsCategories.then(function(a){var i=_.find(a,function(e){return e.id==t});e.omsParams.oms_documents=_.map(i&&i.documents,function(e,t){return{title:e,model:null}})})},!e.omsParams.oms_category_id&&r.currentBrand.default_data&&(e.omsParams.oms_category_id=r.currentBrand.default_fields.second_step.oms_category,e.selectCategory(e.omsParams.oms_category_id)),e.confirmationList={},e.isDocument=function(e){return/document/.test(e)},e.addingDocumentsTemplates={uploader:a.pathToModules+"oms/AddingDocumentsS/views/adding_documents.uploader.html",form:a.pathToModules+"oms/personalData/views/personal_data.html",currentTemplate:"form",selectTemplate:function(t){e.addingDocumentsTemplates.currentTemplate=t}}}])}(angular),function(e){"use strict";e.module("AddingDocumentsS").service("addingDocumentsService",["letterService","$q","CONSTS","$http",function(e,t,a,i){this.omsParams={oms_category_id:null,oms_documents:[]},this.send=e.send,this.uploader=null}])}(angular),function(e){e.module("calculatorS",[])}(angular),function(e,t){"use strict";e.module("calculatorS").controller("calculatorCascoCtrl",["$scope","$rootScope","$timeout","Dictionary","$http","$filter","calculatorService","calculatorStepsService","policyOrderingService","brandingConfigs","CONSTS",function(t,a,i,n,r,s,l,c,o,d,u){t.templates={navigation:d.templates.navigation||u.pathToModules+"shared/calculator/views/navigation.html",program_list:d.templates.program_list||u.pathToModules+"casco/calculatorS/views/calculation.program_list.html",step_3:d.templates.step_3||u.pathToModules+"casco/calculatorS/views/calculation.step_3.html",program_list_manager:d.templates.program_list_manager||u.pathToModules+"casco/carFilterS/views/program_list.manager.html"},c.calculatorOtherParams=t.params=l.calculatorOtherParams,t.brandSteps=c.brandSteps,t.getActiveStep=c.getActiveStep,t.getActiveStepSecond=c.getActiveStepSecond,t.getFullDiscount=c.getFullDiscount,t.sumOfDiscounts=t.getFullDiscount(!0),t.calculationInterParams=c.calculationInterParams,t.carAllSelected=c.carAllSelected,t.$root.crm=t.$root.crm||{},t.$watch("calculationInterParams.mileage",function(e){t.$root.crm.carMileage=e}),t.sendLetterBeforeOrder=o.sendLetterBeforeOrder,n.getItems("yesNo").then(function(e){t.yesNo=e}),t.$watch("calculationInterParams.payment_form",function(e){t.$root.crm.paymentForm=t.paymentForm.find(function(t){return t.id==e})}),t.$watch("params.count_years_break_even_insurance",function(e){t.$root.crm.countYearsBreakEvenInsurance=t.yesNo.find(function(t){return t.id==e})}),t.$watch("params.is_credit",function(e){t.$root.crm.isCreditCar=t.yesNo.find(function(t){return t.id==e})}),t.$watch("calculationInterParams.antitheft",function(e){t.$root.crm.antithefts=(t.antiThefts||[]).find(function(t){return t.id==e})}),t.$watch("params.deductible_value",function(e){t.$root.crm.deductibleValue=e}),n.getItems("paymentForm").then(function(e){t.$root.dicts=t.$root.dicts||{},t.$root.dicts.paymentForm=t.paymentForm=e}),t.getCurrentDiscountTitle=function(){var e=t.bigSteps.getBigStep().name;if("third"===e){if(d.with_sms&&!t.params.resultsAreVisible){var i=a.currentBrand.steps_discount&&a.currentBrand.steps_discount.sms_verification||3;return a.currentBrand.steps_discount_titles&&a.currentBrand.steps_discount_titles.sms_verification||"+"+i+"% за прохождение СМС-верификации."}return a.currentBrand.steps_discount_titles&&a.currentBrand.steps_discount_titles.step_3||""}try{return"first"===e?t.getActiveStep().discountParams.getTitle():t.getActiveStepSecond().discountParams.getTitle()}catch(e){_.noop()}},t.getStepObjectByName=function(e){return c.getAllSteps()[e]},t.getPrevStep=function(e){var a=[];Object.keys(t.brandSteps).forEach(function(e){t.brandSteps[e].forEach(function(e){a.push(e)})});var i=a.indexOf(e),n=a[i-1];t.setActiveStep(n)},t.setActiveStep=function(e){i(function(){c.setActiveStep(e)},10),c.setActiveStep(e)},t.getCurrentStepTitle=function(){var e=t.bigSteps.getBigStep().name;if(-1!==["third","fourth"].indexOf(e))return"third"===e&&d.with_sms&&!t.params.resultsAreVisible?a.currentBrand.steps_titles&&a.currentBrand.steps_titles.sms_verification||"Пройдите бесплатную смс-верификацию":"fourth"===e?"Оформите заявку на получение полиса":a.currentBrand.steps_titles&&a.currentBrand.steps_titles.step_3||"Выберите страховую компанию и тариф";try{return"first"===e?t.getActiveStep().getCurrStepTitle():t.getActiveStepSecond().getCurrStepTitle()}catch(e){_.noop()}},t.calculateKasko=function(){if(!t.params.recalculateButtonIsDisabled)return t.calculationInterParams.antitheft?t.calculation.antitheft=Number(t.calculationInterParams.antitheft)||null:t.calculation.antitheft=null,t.params.recalculateButtonIsDisabled=!0,t.params.isCalculationProgress=!0,t.root.messages.length=0,t.calculation.exploitation_area=t.calculation.exploitation_area||c.calculationInterParams.exploitation_area,t.calculation.deductible_currency=23,t.calculation.is_calculate_osago=!1,t.calculation.has_trailer=!!t.calculation.has_trailer,t.calculation.is_credit=!!t.params.credit_bank,t.calculation.credit_bank=t.params.credit_bank,t.calculation.is_new_car=!!t.calculation.is_new_car,t.calculation.count_years_break_even_insurance=Number(t.calculation.count_years_break_even_insurance)||0,delete t.calculation.insurance_type,delete t.calculation.insured_object,"tumen"===a.currentBrandName&&c.parseDriversDates(t.calculation.driver_set),a.currentBrand.preCalculationParse&&a.currentBrand.preCalculationParse(t.calculation),t.postCalculateParams.second&&(t.calculation.contributory_scheme=t.params.contributory_scheme||19),t.calculation.count_years_break_even_insurance=t.params.count_years_break_even_insurance?0:1,t.calculation.payment_form=t.calculationInterParams.payment_form?[t.calculationInterParams.payment_form]:null,t.calculation.insurable_risk=t.params.insurable_risk?31:29,t.calculation.deductible_value=t.params.deductible_value,t.calculation.is_deductible=!!parseInt(t.calculation.deductible_value,10),t.calculate(function(){t.cachedDrivers=e.copy(t.drivers),t.disabledFormationPolicyButtonIsActive=!0})},t.calculateKaskoDebounced=_.debounce(t.calculateKasko,600)}])}(angular),function(e,t){"use strict";e.module("calculatorS").controller("calculatorCtrl",["$scope","moduleType","$http","$state","$rootScope","brandingService","$stateParams","Dictionary","calculatorService","calculatorStepsService","CONSTS","$q","$location","Messages","formationPolicyStep1Service","brandingConfigs","addingDocumentsService","policyOrderingService",function(a,i,n,r,s,l,c,o,d,u,p,m,g,v,f,h,b,y){function w(){a.calculationResult.sort(function(e,t){return parseFloat(e.program.sum)>parseFloat(t.program.sum)?1:-1})}function k(t,a){return e.isArray(a)&&(t=_.pick(t,a)),t}var x,S=d.calculation,P={extra_parameters:1,available_programs:1,available_installments:1,ins_dir_car_name:1,installment:1,insurance_company:1,messages:1,insurer_data:1,sysinfo:1,options:1,variables:1},C={};a.calculationResult=[],d.results=[],a.params=d.calculatorOtherParams,a.params.show_all=!1,a.params.curr_date=new Date,a.templates={program_list_manager:h.templates.program_list_manager||l.program_list_manager_template||p.pathToModules+"shared/carFilter/views/program_list.manager.html"},a.bigSteps=u.bigSteps,a.postCalculateParams={first:!1,second:!1,third:!1,is_visible:!1,manager__client_phone:"",manager__client_name:"",button_is_disabled:!1},o.getItems("antiThefts").then(function(e){a.antiThefts=_.forEach(e,function(e){e._title=e.title,e.title=e.at_mark.title+" ("+e.title+")"}),a.antiThefts.unshift({title:"Не выбрана"}),s.currentBrand.antiThefts&&(a.antiThefts=_.map(s.currentBrand.antiThefts,function(t){return _.find(e,function(e){return _.get(e,"at_mark.id")===t})}))}),o.getItems("creditBank").then(function(e){a.creditBank=e}),a.toManager=function(){a.calculation.client_phone?a.sendToManager():a.postCalculateParams.third=!0},a.sendToManager=function(){var e=_.compatibleFormData(),t="",i=a.postCalculateParams.manager__client_name||a.calculation.client_name,n=a.postCalculateParams.manager__client_phone||a.calculation.client_phone;a.postCalculateParams.button_is_disabled=!0,t+="Клиент просит ему перезвонить.\n\n",t+="Имя клиента: "+i+"\n",t+="Телефон клиента: "+n+"\n\n",t+="Ссылка на расчет: http://enter.b2bpolis.ru/#/calculator/"+a.calculation.id,e.append("message",t),b.send(e).then(function(){a.postCalculateParams.button_is_disabled=!1,a.postCalculateParams.is_visible=!1,v.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){a.postCalculateParams.button_is_disabled=!1,v.error("Не удалось отправить запрос.",6e3)})},o.getItems("contributoryScheme").then(function(e){e=e.results?e.results:e,a.params.contributoryScheme=_.forEach(e,function(e){19!==e.id&&"Единовременно"!==e.title||(e.title="Нет")}),_.head(s.currentBrand.contributory_schemas)&&(a.params.contributoryScheme=_.map(s.currentBrand.contributory_schemas,function(e){return _.find(a.params.contributoryScheme,function(t){return t.id===e})}))}),a.paymentForm=s.currentBrand.payment_forms,a.getResultWithKbm=function(){var e=_.find(a.calculationResult,function(e){return 30829===e.insurance_company.id});return e||(e=_.find(a.calculationResult,function(e){return 30854===e.insurance_company.id})),e},a.setStep=function(e){a.step=e},a.root={messages:[],selectedResult:d.getSelectedResult()},a.calculation=d.calculation;var I=r.params.calculationId||a.calculation&&a.calculation.id;a.disabledSecondStep=!!a.calculation.id,a.calculateType=function(){return s.calcType},a.root.insuranceTypeTitle=function(){return"Калькулятор ОСАГО"},I?(I!=a.calculation.id&&d.resetCalculation(),C.getCalculation=d.getCalculation(I).then(function(){x=e.copy(a.calculation)}),C.getResult=d.getResult(I).then(function(e){if(!e||!e.length||!e)return void a.root.messages.push("Ошибка со стороны страховой компании.");a.calculationResult=d.results=_.filter(_.forEach(e,d.parseResult),function(e){return parseInt(e.program.sum)&&_.head(e.program.option_set)}),a.postCalculateParams.is_visible=!0,a.params.resultsAreVisible=!0,w()})):d.resetCalculation(),a.data={helpStep:1},a.showMessage=function(e,t){a.data.helpStep=4,s.currentBrand.without_steps_history=!0,s.currentBrand.without_big_steps_labels=!0;var i=new FormData;if(s.clientDataForMail=s.clientDataForMail||{},i.append("car_mark",u.carAllSelected.carMark.title),i.append("car_model",u.carAllSelected.carModel.title),i.append("car_manufacturing_year",a.calculation.car_manufacturing_year),i.append("car_price",a.calculation.car_cost),i.append("drivers_set",JSON.stringify(a.calculation.driver_set)),i.append("client_name",a.data.client&&a.data.client.name||a.calculation.client_name||s.clientDataForMail.name),i.append("client_phone",a.data.client&&a.data.client.phone||a.calculation.client_phone||s.clientDataForMail.phone),i.append("email",a.calculation.client_email),e){u.calculationInterParams.exploitation_area_title&&i.append("owner_registration_title",u.calculationInterParams.exploitation_area_title),i.append("risk","КАСКО"),i.append("ins_price",t.program.sum?parseFloat(t.program.sum).toFixed(2):""),i.append("ins_price_with_discount",t.program.sum_with_discount?parseFloat(t.program.sum_with_discount).toFixed(2):""),i.append("ins_comp_name",t.insurance_company.title),a.data.helpStep=3,i.append("remont",_.get(a,"$root.crm.paymentForm.title")||"Нет"),i.append("ubitki",a.params.count_years_break_even_insurance?"Да":"Нет"),i.append("franchisa_rub",_.get(a,"$root.crm.deductibleValue")),i.append("probeg",u.calculationInterParams.mileage||"");var r=_.find(a.antiThefts,function(e){return e.id===Number(u.calculationInterParams.antitheft)});i.append("PUS",r&&r.title||"Нет");var l=_.find(a.creditBank,function(e){return e.id===Number(a.params.credit_bank)});i.append("credit",!(!l||!l.title)||"Нет"),i.append("bank",l&&l.title||"Нет")}i.append("power",u.calculationInterParams.engine_power),i.append("recommended",""),i.append("fullRequest","true");var c="Основная";a.calculation.id&&(c+=" https://enter.b2bpolis.ru/#/calculator/"+a.calculation.id),i.append("mess",c),n({method:"POST",url:AngularAppConfig.proxyPath+"holding_dom/index.php",headers:{"Content-Type":void 0},data:i}),i.append("isHTML",!0),i.append("moduleType",s.currentModuleType),b.send(i)},a.selectResult=function(e,t,i){var n;i?(n=_.find(a.calculationResult,function(t){return t.id==e}),n=_.find(n.availablePrograms,function(e){return e.id===i})):!(n=_.find(a.calculationResult,function(t){return t.id==e})||null)&&a.calculationCustomResult&&a.calculationCustomResult.id===e&&(n=a.calculationCustomResult),t?(d.setResultAsSelected(_.extend(n,{is_from_interface:!0})),d.setSelectedResult(n)):d.setSelectedResult(n),a.selectedResult=d.getSelectedResult(),n&&!s.currentBrand.without_policy_ordering&&(a.bigSteps.setBigStep("fourth"),d.setResultAsSelected(n)),n&&s.currentBrand.without_policy_ordering&&("fake_result_hack"===!n.id&&d.setResultAsSelected(n),y.sendLetterBeforeOrderWithPUS(t),setTimeout(function(){window.location.reload()},3e3))},a.getYearRange=function(e,t){var a,i,n;return a=new Date,e=e||0,t=void 0===t?90:t,n=a.getFullYear()-t,i=a.getFullYear()-e,n+":"+i},a.resetCalculation=function(){a.calculation.id?v.success('Данные по расчету очищены, ваш расчет сохранен в разделе <a href="#/calculator/archive">Расчеты</a>.',7e3):v.success("Данные по расчету очищены.",4e3),d.resetCalculation(),f.resetAll(),a.calculationResult.length=0,g.search("policy",null),g.path("/calculator/"+s.calcType+"/",!1)};this.postResultByCompany=function(e,t,a,i){var r=k(P,i),s={"X-Calculation-Token":void 0};return n({method:"POST",url:p.urlPrefixV3+"calculation/"+e+"/result/"+t+"/",params:r,headers:s,data:JSON.stringify(a)}).then(function(e){return e.data})},a.calculate=function(i){a.prevCalculationResult=e.copy(a.calculationResult),a.calculationResult.length=0,d.results.length=0,a.selectResult(null),a.calculation.created_by_user=null,d.createCalculation().then(function(n){var l=[],c=0;a.root.messages.length=0,console.log("%c createCalculationSuccess ","color: green"),x=e.copy(a.calculation),r.go(r.current,{calculationId:a.calculation.id},{notify:!1}),d.companiesInProgress.length&&_.forEach(d.companiesInProgress,function(e){var t=d.createResult(e.id).then(function(e){e=_.filter(e,function(e){return e.calculation.id===d.calculation.id}),a.currentDiscount=u.getFullDiscount(),_.forEach(e,function(e){function t(t){return d.createResult(e.insurance_company.version,null,{programs:[t.id]}).then(function(e){return e=_.filter(e,function(e){return e.calculation.id===d.calculation.id}),e[0]})}var i=[],n=!1;if(e.is_default&&parseInt(e.program.sum)){if(a.calculationResult.push(d.parseResult(e)),d.results.push(d.parseResult(e)),s.currentBrand.disable_discount||("function"==typeof s.currentBrand.customDiscount?e=s.currentBrand.customDiscount(e,a.currentDiscount):e.program.sum_with_discount=Number(e.program.sum)*(100-a.currentDiscount)/100),"function"==typeof s.currentBrand.customResults){var r=s.currentBrand.customResults(_.filter(a.calculationResult),S.car_cost);!a.calculationCustomResult&&r.customResult&&(a.calculationCustomResult=r.customResult),a.calculationResult=r.calcResult}"function"==typeof s.currentBrand.sortResults?a.calculationResult=s.currentBrand.sortResults(a.calculationResult):w(),c++,c>=5&&(a.params.recalculateButtonIsDisabled=!1),s.currentBrand.with_programs&&(i=_.map(_.filter(e.available_programs,function(t){return t.id!==e.program.id}),t),m.all(i).then(function(t){t=_.filter(t,function(e){return!_.isNil(e.program.sum)}),s.currentBrand.antiThefts&&(t=_.filter(t,function(e){return _.find(a.antiThefts,function(t){return _.find(e.program.option_set,function(a){if("tech_assist"===a.code&&-1!==a.note.toUpperCase().indexOf(t.at_mark.title.toUpperCase())&&null!==a.note.match(/\([А-Яа-я| ]+([0-9|\,]+)[А-Яа-я| |\.]+\)/)&&a.note.match(/\([А-Яа-я| ]+([0-9|\,]+)[А-Яа-я| |\.]+\)/)[1])return e.PUS_cost=a.note.match(/\([А-Яа-я| ]+([0-9|\,]+)[А-Яа-я| |\.]+\)/)[1].replace(",",""),e.PUS_title=t.at_mark.title,a})})})),e.availablePrograms=t,!n&&s.currentBrand.additionalResult&&(e.availablePrograms=s.currentBrand.additionalResult(e.availablePrograms),n=!0)}))}}),a.postCalculateParams.is_visible=!0});l.push(t)}),"function"==typeof i&&i(n),m.all(l).then(function(e){var i,n=_.flatten(e);if(console.log("%c createResultSuccess ","color: green"),a.params.resultsAreCreated=!0,a.params.recalculateButtonIsDisabled=!1,!n||!n.length)return v.error("Ошибка на стороне сервера.",4e3),void(a.params.isCalculationProgress=!1);(i=t(".js-kasko-result").offset())&&jQueryApp("html,body").animate({scrollTop:i.top},"fast")},function(e){console.log("%c createResultError: ","color: red"),console.warn(e)}).then(function(e){a.params.recalculateButtonIsDisabled=!1,a.params.isCalculationProgress=!1})},function(e){console.log("%c createCalculationError: ","color: red"),console.warn(e),v.error("По Вашему запросу нет данных.",4e3),v.error("Попробуйте изменить настройки калькулятора.",4e3),a.params.isCalculationProgress=!1})}}])}(angular,jQueryApp),function(e){"use strict";e.module("calculator").provider("calculator",[function(){var t={created_at:"2017-04-14T18:18:59Z",countries:[],insurant_set:[],start_trip_date:null,end_trip_date:null,currency:1};this.setDefaults=function(a){e.extend(t,a)},this.getModuleType=function(){return"casco"},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e,t){"use strict";e.module("calculatorS").service("calculatorService",["$http","$q","Messages","CONSTS","$rootScope","resources","calculator","$filter","$timeout","requester",function(a,i,n,r,s,l,c,o,d,u){function p(e,t){return _.map(e,function(e){return _.extend({id:e,title:e},t)})}function m(e){return e=e||new Date,o("date")(e,"yyyy-MM-dd")}function g(e){var a=t(".ui-datepicker-year").val();return(e=new Date(e))?(e.setFullYear(a),o("date")(e,"yyyy-MM-dd")):""}var v=c.getDefaults(),f={},h={calculationTypeIsSelected:s.currentBrand.without_osago||!1,cascoBigSteps:[{name:"first",icon:"car",title:"Выбор параметров автомобиля"},{name:"second",icon:"user",title:"Выбор параметров водителей"},{name:"third",icon:"file",title:"Выбор тарифа"},{name:"fourth",icon:"credit card alternative",title:"Оформление заявки на получение полиса"}],getBigStepIndex:function(e){return void 0!==f[e]?f[e]:(f[e]=_.findIndex(h.cascoBigSteps,function(t){return t.name===e}),f[e])},selectCalcType:function(){h.calculationTypeIsSelected=!h.calculationTypeIsSelected},years:{newCar:s.currentBrand.carYears&&s.currentBrand.carYears.newCar||p(_.range((new Date).getFullYear(),(new Date).getFullYear()-3,-1),{type:"new"}),oldCar:s.currentBrand.carYears&&s.currentBrand.carYears.oldCar||p(_.range((new Date).getFullYear()-1,(new Date).getFullYear()-9,-1),{type:"old"})},selectYear:function(e){this.calculatorOtherParams.car_manufacturing_year=e}.bind(this)},b={result:null,full_year:null,field_was_clicked:!1,drivers_count:1,drivers_count_full:1,signalization_type:"",show_empty_fields:!1,resultsAreCreated:!1,deductible_value:15e3,contributory_scheme:19,payment_form:107,recalculateButtonIsDisabled:!1,isCalculationProgress:!1,resultsAreVisible:!s.currentBrand.with_sms,multidriveForm:{birth_date:"",driving_experience_started:""},cascoParams:h};this.clientInfo={client_phone:""},this.parseResult=function(e){if(e.company_logo="http://enter.b2bpolis.ru/"+e.insurance_company.logo,s.currentBrand.with_custom_program){var t=e.variables.autograd_kasko&&e.variables.autograd_kasko.split("\n");t&&(e.company_rating=t[0].split("Рейтинг надежности: ")[1],t.splice(0,1),e.company_options=t)}return e},this.currentResult=null,this.getOtherCompanies=function(){return[{id:41243,title:"Росгосстрах",insurance_company:{logo:"media/logo_main_ins/Logo_24.png"}},{id:41465,title:"Ренессанс",insurance_company:{logo:"media/logo_main_ins/Logo_47.png"}}]},this.calculation=e.copy(v),this.companiesInProgress=[],this.getDefaultCalculation=function(){return v},this.selectedResult=null,this.setSelectedResult=function(e){this.selectedResult=e},this.getSelectedResult=function(){return this.selectedResult},this.calculationFormIsValid=_.noop,this._promises={},this.getPromises=function(){return this._promises},this.calculatorOtherParams=e.copy(b),this.resetCalculation=function(t){var a=e.copy(this.getDefaultCalculation());this.companiesInProgress.length=0,t=t||s.calcType;for(var i in this.calculation)this.calculation.hasOwnProperty(i)&&delete this.calculation[i];for(var n in a)a.hasOwnProperty(n)&&(this.calculation[n]=a[n]);for(var r in this.calculatorOtherParams)this.calculatorOtherParams.hasOwnProperty(r)&&(this.calculatorOtherParams[r]=b[r]);return this["to_defaults_"+t]&&this["to_defaults_"+t](),this},this.to_defaults_osago=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=m(t)},this.to_defaults_kasko=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=m(t),this.calculation.deductible_currency=23},this.defaultCalcDriver={is_married:!1,gender:"M",expirience:null,age:null,has_children:!1},this.createCalculation=function(t){return t=t||this.calculation,this.companiesInProgress.length=0,t=this.correctCalculation(t),delete t.token,u.post(l.calculation+"?token",t).then(function(t){var a,i=t.data,n=["optional_equipment"];this.calculationToken=i.token,this.companiesInProgress=i.available_insurance_departments,delete i.available_insurance_departments;for(a in i)i.hasOwnProperty(a)&&-1===n.indexOf(a)&&(e.equals(this.calculation[a],i[a])||(this.calculation[a]=i[a]));return t.data}.bind(this))},this.getCalculation=function(e){return(e=e||this.calculation.id)==this.calculation.id?i.when(this.calculation):(this._promises.getCalculation=u.get(l.calculation+e+"/").then(function(e){var t;e=e.data;for(t in e)"user"!==t&&(this.calculation[t]=e[t])
;return this.calculation}.bind(this)),this._promises.getCalculation)},this.getResult=function(e){return e=e||this.calculation.id,u.get(l.calculationV3+e+"/result/?insurance_company=1&messages=1&variables=1&options=1").then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.createResult=function(e,t,i){var n=this.calculationToken;return t=t||this.calculation.id,a({url:"https://enter.b2bpolis.ru"+l.calculationV3+t+"/result/"+e+"/?available_programs=1&insurance_company=1&messages=1&variables=1&options=1",method:"POST",headers:{"X-Calculation-Token":n},data:i}).then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.setResultAsSelected=function(t,i){var n=this.calculationToken;return i=i||this.calculation.id,a({url:"https://enter.b2bpolis.ru"+l.calculationV3+i+"/result/"+t.insurance_company.version+"/?insurance_company=1&messages=1&variables=1&options=1",method:"PUT",headers:{"X-Calculation-Token":n},data:e.extend({},t,{is_selected:!0,is_default:!0,client_name:"Расчет отправлен",client_phone:null})}).then(function(e){return e.data})},this.getCredentialList=function(e){return a.get(r.urlPrefixDefault+"client/natural-person/"+e+"/credential").then(function(e){return e.data})},this.getAddressList=function(e){return a.get(r.urlPrefixDefault+"client/natural-person/"+e+"/address").then(function(e){return e.data})},this.correctCalculation=function(e){return e=e||this.calculation},this.personDateChanged=function(e,t,a){t=t||"birth_date",-1!==t.indexOf(".")?(t=t.split("."),e[t[0]][t[1]]=g(e[t])):e[t]=g(e[t])}}])}(angular,jQueryApp),function(e){e.module("brandingS",[])}(angular),function(e){"use strict";e.module("brandingS").service("brandingService",["$rootScope","CONSTS","$stateParams","brandingConfigs",function(t,a,i,n){var r={car_model_group_template:a.pathToModules+"casco/carFilterS/views/car_filter.car_group_models_list.html",car_model_template:a.pathToModules+"casco/carFilterS/views/car_filter.car_models_list.html",drivers_template:_.get(t.currentBrand,"templates.drivers")||a.pathToModules+"casco/calculatorStepsS/views/step.drivers.html",is_multidrive_template:a.pathToModules+"casco/calculatorStepsS/views/step.is_multidrive.html",third_big_step_template:a.pathToModules+"casco/carFilterS/views/third_big_step.html",program_list_manager_template:_.get(t.currentBrand,"templates.manager")||a.pathToModules+"casco/carFilterS/views/program_list.manager.html"},s={steps_buttons_color:"orange",united_buttons_color:"blue"};return r[a.currentBrand]=e.extend(s,n),r}])}(angular),function(e){e.module("formationPolicyS",[])}(angular),function(e){"use strict";e.module("formationPolicyS").service("formationPolicyService",["$http","CONSTS","$q","$rootScope","$filter","resources","requester",function(t,a,i,n,r,s,l){function c(e){return e=e||new Date,r("date")(e,"yyyy-MM-dd")}function o(e){var t;return t="legal_person"===e.personType?["title","title_eng","id","inn","ogrn","kpp","representative_first_name","representative_last_name","representative_patronymic","representative_post","representative_credential_type","representative_number","representative_issue_date"]:["id","first_name","last_name","patronymic","first_name_eng","last_name_eng","patronymic_eng","birth_date","gender","driving_experience_started","is_individual_entrepreneur","is_foreigner"],_.pick(e,t)}var d={object:{credential:[{issue_date:"2016-02-04",creator:10585,series:"3456",number:"45",object_id:1751,issue_point:"",credential_type:10,content_type:480,expiration_date:null,external_id:"9374",id:5449}],keys_count:2,manufacturing_date:"2015-01-01",engine_power:"200.00",car_modification:null,creator:10585,car_model:7687,engine_displacement:"2.00",car_body_number:null,mileage:null,number_plate:"",car_mark:303,vin_number:"55TTEEE5E5R5R6TT7",external_id:"7628",id:1751,cost:null},object_type:"car",person:[]},u=null,p=null;return{orderMessage:"",clear:function(){p=null},resetCurrentPolicy:function(){u=null},updateCustomer:function(e){var a=i.defer();return this.getCustomer(null).then(function(i){i.natural_persons=i.natural_persons.concat(e.natural_persons),i.natural_persons=_.uniq(i.natural_persons),t.put(s.customer+"/null",i).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},getCustomer:function(e){return e=e||null,t.get(s.customer+"/"+e).then(function(e){return e.data})},getCustomerCars:function(e){return e=e||null,t.get(s.customerCar,{params:{owner:e}}).then(function(e){return e.data})},getCarCredential:function(e){return t.get(s.customerCar+"/"+e+"/credential").then(function(e){return e.data})},getCustomerFull:function(e){var a=i.defer();return this.getCustomer(e).then(function(e){t.get(s.person+"/"+e.person).then(function(i){var n=i.data,r="naturalPerson",l=n.natural_person;n.legal_person&&(r="legalPerson",l=n.legal_person),t.get(s[r]+"/"+l).then(function(t){var i=t.data;a.resolve({person:i,drivers:e.natural_persons})},function(e){a.reject(e)})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},saveCar:function(a){var n=i.defer(),r=_.pick(a,["id","mileage","car_mark","car_model","car_modification","owner","manufacturing_date","vin_number","number_plate","engine_displacement","engine_power","cost","keys_count"]),l="post",c=s.customerCar;return r.owner=r.owner||null,r.id&&(l="put",c+="/"+r.id),t[l](c,r).then(function(r){var l=r.data,c=_.map(a.credential,function(e){return _.pick(e,["id","number","series","credential_type","issue_date","issue_point","expiration_date"])}),o=[];e.forEach(c,function(e){var a="post",i=s.customerCar+"/"+l.id+"/credential";e.id&&(a="put",i+="/"+e.id),o.push(t[a](i,e).then(function(e){return e.data}))}),i.all(o).then(function(e){n.resolve({car:l,credential:e})},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},createDeal:function(a){var n=i.defer();return t.post(s.deal,e.extend({deal_status:1,customer:null},a)).then(function(e){var i=e.data;i.car=a.car,t.put(s.deal+"/"+i.id,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},getDeal:function(e){return t.get(s.deal+"/"+e)},createInsuranceProduct:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/from-calculation",a).then(function(e){return e.data})},updateInsuranceProduct:function(e,a,i){return t.put(s.deal+"/"+e+"/insurance-product/"+a,i).then(function(e){return e.data})},createInvoice:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/"+a+"/invoice/generate").then(function(e){return e.data})},createPersonContainer:function(e,a){var i={};return a="legal_person"===a?"legal_person":"natural_person",i[a]=e,t.post(s.person,i).then(function(e){return e.data})},saveBSO:function(e,a){return t.post(s.resultPolicy+"/"+e+"/enter_bso/",a).then(function(e){return e.data})},createInsuredObjectByIds:function(e){return t.post("/rest/default/client/insured-object",e).then(function(e){return e.data})},createInsuredObjectOsago:function(t){var a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:+t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,car_body_number:t.car.car_body_number,engine_power_kilowatt:t.car.engine_power_kilowatt,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]};return e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this),e.forEach(t.persons,function(t,i){var n,r,s={},l=[],d=t.id||this.generateId(),u=t.address_registration?[t.address_registration]:[],p=o(t),m=t.personType;u&&u.lendth&&(u[0].address_type=1),"natural_person"===m?(r=t.credential,e.forEach(r,function(e){e&&(e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId())},this),!t.is_same_address&&t.address_residential&&(u.push(t.address_residential),u[1].content_type=482,u[1].address_type=2),t.birth_date=c(t.birth_date),t.driving_experience_started=c(t.driving_experience_started)):r=null,e.forEach(["owner","insurant"],function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&l.push(e)}),l.length>0&&(s.role=l,s.external_id=d,s.id=t.person_id,s[m]=p,s[m].external_id=d,s[m].credential=r,s[m].address=u,a.person.push(s)),t.isDriver&&(n=e.copy(p),n.external_id=d,n.credential=[],n.credential.push(_.find(r,function(e){return 3===e.credential_type})),n.credential.push(_.find(r,function(e){return 1===e.credential_type})),n.credential[1]||(n.credential.length=1),a.drivers.push(n))},this),l.post(s.insuredObjectOsago,a).then(function(t){return p=e.copy(t.data),t.data})},sendPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token",_.pick(e,"phone")).then(function(e){return e.data})},confirmPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token-verified",_.pick(e,"token")).then(function(e){return e.data})},toPay:function(e){return t.post("/payment/"+e+"/ ").then(function(e){return e.data})},createInsuredObject:function(t){var a,i;return t.car?(a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,is_new_car:t.car.is_new_car,is_temporary:t.car.is_temporary,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]},i=["owner","insurant","beneficiary"],e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this)):(a=d,i=["owner","insurant"]),e.forEach(t.persons,function(t,n){var r,s,l={},d=[],u=t.id||this.generateId(),p=[t.address_registration],m=_.filter(t.contact,function(e){return e.data}),g=o(t),v=t.personType;"legal_person"===v?s=null:(s=t.credential,e.forEach(s,function(e){e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId()},this),t.is_same_address||p.push(t.address_residential),t.is_temporary_registration&&p.push(t.address_temporary_registration),t.birth_date=c(new Date(t.birth_date)),t.driving_experience_started=t.driving_experience_started?c(new Date(t.driving_experience_started)):null),e.forEach(i,function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&d.push(e)}),e.forEach(p,function(e){e&&!e.country&&(e.country="Россия")}),d.length>0&&(l.role=d,l.external_id=u,l.id=t.person_id,l[v]=g,l[v].external_id=u,l[v].contact=m,l[v].credential=s,l[v].address=p,a.person.push(l)),t.isDriver&&(r=e.copy(g),r.external_id=u,r.address=p,r.credential=_.filter(s,function(e){return 3===e.credential_type}),a.drivers.push(r))},this),l.post(s.insuredObject,a).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObject:function(t){return l.get(s.insuredObject+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObjectOsago:function(t){return l.get(s.insuredObjectOsago+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getPolicyFile:function(e,a){return a=a?"?type="+a:"",t({method:"GET",url:s.resultPolicy+e+"/template/"+a,headers:{}}).then(function(e){return e.data})},createInsuredObjectCRM:function(e){return t.post(s.insuredObjectCRM,e).then(function(e){return e.data})},createPolicy:function(a){return t.post(s.resultPolicy,e.extend({external_id:null},a)).then(function(e){return u=e.data})},savePolicy:function(a){var i="post",n=s.resultPolicy;return a.id&&(i="put",n=s.resultPolicy+a.id+"/"),t[i](n,e.extend({external_id:null},a)).then(function(e){return u=e.data})},getPolicy:function(e){return t.get(s.resultPolicy+e+"/",{params:{external_id:null}}).then(function(e){return u=e.data})},getSavedNaturalPersons:function(e){return t.get(s.savedNaturalPersons,{params:e}).then(function(e){return e.data})},getSavedLegalPersons:function(e){return t.get(s.savedLegalPersons,{params:e}).then(function(e){return e.data})},getSavedCars:function(e){return t.get(s.savedCars,{params:e}).then(function(e){return e.data})},getInsObjList:function(e){return t.get(s.insuredObectList,{params:e}).then(function(e){return console.log(e),e.data})},getCurrentPolicy:function(){return u},getCurrentInsuredObject:function(){return p},sendNotification:function(e){return t.post(s.notificationSend,e).then(function(e){return e.data})},generateId:function(){return~~(9900*Math.random()+100)},getPolicyActionsParameters:function(e){return t.get(s.resultPolicy+e+"/actions_parameters/",{params:{external_id:null}}).then(function(e){return e.data})},executePolicyAction:function(e,i,n){return t.post(a.urlPrefixPolicy+"result_policy/"+e+"/"+i+"/",n).then(function(e){return e.data})},getPolicyDocsArchive:function(e){return t.get(a.urlPrefixPolicy+"result_policy/"+e+"/zip/").then(function(e){return e.data})},getPolicyAttachments:function(e){return t.get(s.resultPolicy+e+"/attachment/").then(function(e){return e.data})},deletePolicyAttachment:function(e,a){return t.delete(s.resultPolicy+e+"/attachment/"+a).then(function(e){return e.data})},issueToSavedPolicy:function(e){return t.post(s.resultPolicy+e+"/issue_to_saved_policy/").then(function(e){return e})},setPersonValidationDates:function(e){e.isDriver?(e.birthDateRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age),c(t)}()},e.expirienceRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience),c(t)}()}):(e.birthDateRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-90),c(e)}(),max:function(){var e=new Date;return e.setFullYear(e.getFullYear()-18),c(e)}()},e.expirienceRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-72),c(e)}(),max:function(){return c(new Date)}()}),e.birthDateRange.yearRange=new Date(e.birthDateRange.min).getFullYear()+":"+new Date(e.birthDateRange.max).getFullYear(),e.expirienceRange.yearRange=new Date(e.expirienceRange.min).getFullYear()+":"+new Date(e.expirienceRange.max).getFullYear(),e.dateChanged=function(t,a){var i=new Date(t).getFullYear(),n=new Date(a).getFullYear();e.invalidDates=i-n>=18}}}}])}(angular),function(e,t){"use strict";e.module("formationPolicyS").service("formationPolicyStep1Service",["$filter","$rootScope","formationPolicyService","Person","calculatorService","$q","brandingConfigs",function(t,a,i,n,r,s,l){var c=r.calculation,o=[],d=l.max_persons,u={address_type:1,postal_index:null,country:"Российская Федерация",city:"",street:"",house:"",housing:"",flat:""},p={type:"Паспорт",series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},m={is_same_address:!0,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:null,birth_date:"",document:e.copy(p),address_registration:e.copy(u)},g=function(){0==o.length&&(o.push(_.extend({},m,{id:1})),2==b()&&f())},v=function(e){e.isInsurant?(_.forEach(o,function(e){e.isInsurant=!1}),e.isInsurant=!0):e.isInsurant=!1},f=function(){var t=_.extend({},m,{id:o.length+1});t.document=e.copy(p),t.address_registration=e.copy(u),o.length<d&&o.push(t)},h=function(e){o.length>b()&&o.splice(e,1)},b=function(){return c.age_category&&2==c.age_category?2:1};return{init:g,persons:o,getPersons:function(){return o},setInsurant:v,addPerson:f,removePerson:h}}])}(angular),function(e){"use strict";e.module("personalDataS",[])}(angular),function(e){e.module("calculatorStepsS",[])}(angular),function(e){e.module("carFilterS",[])}(angular),function(e){e.module("AddingDocumentsU",[])}(angular),function(e){"use strict";e.module("AddingDocumentsU").controller("AddingDocumentsCtrl",["$scope","FileUploader","CONSTS","addingDocumentsService","Dictionary","$rootScope",function(e,t,a,i,n,r){e.typeInput="personalData",e.omsParams=i.omsParams,e.isSaveDataProgress=!1,e.uploader=i.uploader||new t({url:"/some_url",formData:[{attachment_type:1,description:""}]}),i.uploader=e.uploader,e.omsCategories=n.getItems("omsCategories"),e.selectCategory=function(t){e.omsCategories.then(function(a){var i=_.find(a,function(e){return e.id==t});e.omsParams.oms_documents=_.map(i&&i.documents,function(e,t){return{title:e,model:null}})})},!e.omsParams.oms_category_id&&r.currentBrand.default_data&&(e.omsParams.oms_category_id=r.currentBrand.default_fields.second_step.oms_category,e.selectCategory(e.omsParams.oms_category_id)),e.confirmationList={},e.isDocument=function(e){return/document/.test(e)},e.addingDocumentsTemplates={uploader:a.pathToModules+"oms/AddingDocumentsU/views/adding_documents.uploader.html",form:a.pathToModules+"oms/personalData/views/personal_data.html",currentTemplate:"form",selectTemplate:function(t){e.addingDocumentsTemplates.currentTemplate=t}}}])}(angular),function(e){"use strict";e.module("AddingDocumentsU").service("addingDocumentsService",["letterService","$q","CONSTS","$http",function(e,t,a,i){this.omsParams={oms_category_id:null,oms_documents:[]},this.send=e.send,this.uploader=null}])}(angular),function(e){e.module("calculatorU",[])}(angular),function(e){"use strict";e.module("calculatorU").directive("carInline",["calculatorService","Dictionary","$filter",function(e,t,a){return{restrict:"A",link:function(i){i.calculation=e.calculation,i.calculatorParams=e.calculatorOtherParams;var n=a("carFilterYears");i.car=e.car,i.car=_.extend(e.car,{car_mark:null,car_model_group:null,car_model:null}),i.calculation.car_manufacturing_year=null,t.getItems("carMarks").then(function(e){i.carMarks=e.results}),i.carModelGroups=[],i.carMarksChanged=function(){i.carModelGroups=[],i.carModels=[],i.car.car_model=null,i.car.car_model_group=null,i.calculation.car_manufacturing_year=null,i.calculation.car_mark=i.car.car_mark},i.carManufacturingYearChanged=function(){i.carModelGroups=[],i.carModels=[],i.car.car_model=null,i.car.car_model_group=null,t.getItems("carModelGroups",{car_mark:i.calculation.car_mark}).then(function(e){i.carModelGroups=n(e.results,i.calculation.car_manufacturing_year)})},i.carModels=[],i.carModelGroupChanged=function(){i.carModels=[],i.car.car_model=null,i.calculation.car_model_group=i.car.car_model_group,t.getItems("carModels",{car_model_group:i.calculation.car_model_group}).then(function(e){var t=n(e.results,i.calculation.car_manufacturing_year);i.carModels=t.length>100?[]:t})},i.carModelChanged=function(){i.calculation.car_model=i.car.car_model}}}}])}(angular),function(e,t){"use strict";e.module("calculatorU").directive("contactManager",["Messages","letterService",function(e,t){return{restrict:"A",link:function(a){function i(){return{client_name:"",client_phone:""}}a.contactParams={contactIsVisible:!1,toggleContact:function(){a.contactParams.contactIsVisible=!a.contactParams.contactIsVisible},form:i(),sendContact:function(){var n=_.compatibleFormData(),r="Заявка на звонок менеджера\n";r+="Имя: "+a.contactParams.form.client_name+"\n",r+="Телефон: "+a.contactParams.form.client_phone+"\n",n.append("message",r),t.send(n).then(function(){e.success("Спасибо за обращение. Менеджер свяжется с вами в ближайшее время.",6e3),a.contactParams.form=i(),a.contactParams.contactIsVisible=!1})}}}}}])}(angular),function(e){"use strict";e.module("calculatorU").directive("driversFull",["calculatorService","$rootScope","Person","Dictionary",function(e,t,a,i){return{restrict:"A",link:function(n){function r(e){var t=new a(_.extend({is_same_address:!0,credential:[],isOwner:!0,personType:"natural_person",isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:"M",birth_date:"",passport:{credential_type:1,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""}},e));n.persons.push(t)}function s(e){var t=new a(_.extend({credential:[],address:[],expirience:null,contact:[],first_name:"",last_name:"",patronymic:"",isDriver:!0,personType:"natural_person",birth_date:"",gender:"M",driving_experience_started:"",driver_license:{credential_type:3,series:"",number:"",issue_date:"",issue_point:"РФ",expiration_date:""}},e));n.drivers.push(t)}n.calculation=e.calculation,n.calculatorParams=e.calculatorOtherParams,n.drivers=e.drivers&&e.drivers.length?e.drivers:[],e.drivers=n.drivers,n.persons=e.persons&&e.persons.length?e.persons:[],e.persons=n.persons,i.getItems("driversCountOsagoFull").then(function(e){t.currentBrand.max_drivers_count&&(e=_.filter(e,function(e){return e.id<=t.currentBrand.max_drivers_count})),n.driversCountOsagoFull=e}),n.driversFullExperienceChanged=function(e){(e.expirience||0===Number(e.expirience))&&(e.driving_experience_started=new Date((new Date).getFullYear()-e.expirience,0,1))},n.drivers.length||s(),n.driversCountChanged=function(){var e=n.drivers.length,t=Number(n.calculatorParams.drivers_count_full);if(n.calculation.is_multidrive=!t,t?n.persons.length=0:(n.persons.length=0,r()),t>e)for(var a=0;t-e>a;a++)s();else n.drivers.length=t}}}}])}(angular),function(e){"use strict";e.module("calculatorU").directive("fullCalculation",["calculatorService","$rootScope","Dictionary","brandingConfigs","calculatorStepsService","$q","$filter","Messages","formationPolicyService",function(t,a,i,n,r,s,l,c,o){return{restrict:"A",link:function(a){function i(){var e=t.drivers.length?t.drivers:t.persons;if(!t.requiringDrivers(e[0]))return s.when({});var i={car:{car_mark:a.calculation.car_mark,car_model:a.calculation.car_model,car_model_group:a.calculation.car_model_group,manufacturing_date:(a.calculation.car_manufacturing_year||(new Date).getFullYear())+"-01-01",engine_power:Number(a.calculation.engine_power)||120,cost:0,vin_number:""},persons:e};return o.createInsuredObjectOsago(i)}a.calculation=t.calculation,a.resultsFull=t.resultsFull&&t.resultsFull.length?t.resultsFull:[],t.resultsFull=a.resultsFull,a.resultsFull.length||function(){var n={car_cost:"0",car_mark:a.calculation.car_mark,car_model:a.calculation.car_model,car_model_group:a.calculation.car_model_group,car_manufacturing_year:t.calculation.car_manufacturing_year,owner_registration:t.calculation.owner_registration,drivers_count:t.calculation.driver_set.length,driver_set:t.calculation.driver_set,is_multidrive:!1,insurance_duration:82,count_years_break_even_insurance:0,calculation_at_date:_.formatDate(t.calculation.calculation_at_date),engine_power:Number(r.calculationInterParams.engine_power),is_legal_entity:!1,has_trailer:!1,calculation_type:45426,is_calculate_osago:!0,is_credit:!1,is_new_car:!1,date_of_exploitation_period:"2016-01-01"},c=[],o=[];a.resultsFull.length=0,n.driver_set=[],e.forEach(t.drivers,function(t){var a=l("calcAge")(t.birth_date),i=t.expirience||l("calcAge")(t.driving_experience_started);t.isDriver=!0,t.personType="natural_person",n.driver_set.push({age:a||18,expirience:i,is_married:!1,has_children:!1}),c.push(a),o.push(i),t.driving_experience_started=_.formatDate(t.driving_experience_started),t.driver_license.credential_type=3,t.credential=[e.copy(t.driver_license)]}),n.drivers_minimal_age=Math.min.apply(Math,c),n.drivers_minimal_experience=Math.min.apply(Math,o),i().then(function(e){n.insured_object=e.id,t.calculation.insured_object=e.id,t.createCalculation(n).then(function(){var e;if(t.companiesInProgress.length)return e=_.map(t.companiesInProgress,function(e){return t.createResult(e.id).then(function(e){return e=_.head(e),parseInt(e.program.sum)&&a.resultsFull.push(t.parseResult(e)),e})}),s.all(e)}).then(function(){a.resultsFull=a.resultsFull.sort(function(e,t){return e.program.sum-t.program.sum})}).catch(function(){})}).catch(function(){})}(),a.selectedResult=t.result||null,a.selectResult=function(e){t.result=e,a.selectedResult=e,a.toNextStep("usago_calculation")}}}}])}(angular),function(e){"use strict";e.module("calculatorU").directive("personalDataCar",["calculatorService","formationPolicyStep1Service",function(e,t){return{restrict:"A",link:function(t){t.calculation=e.calculation,t.params={},t.car=e.car}}}])}(angular),function(e){"use strict";e.module("calculatorU").directive("personalDataPersons",["calculatorService","formationPolicyStep1Service",function(t,a){return{restrict:"A",link:function(i){i.calculation=t.calculation,i.params={},i.persons=[],i.setPersonAs=function(t,a){t[a]=!0,"isOwner"===a&&(t.isBeneficiary=!0),e.forEach(i.persons,function(e){t.$$hashKey!==e.$$hashKey&&(e[a]=!1,t.isBeneficiary=!1)})},i.setPersonType=function(e,t){i.setPersonAs(e,t)},i.addPerson=function(e,t){t=t||"natural_person",i.params.person_type=null,i.persons.push(a.addPerson(e,t))},i.removePerson=function(e){i.persons.splice(i.persons.indexOf(e),1)},i.insurantTypes=[{id:"natural_person",title:"Физическое лицо"},{id:"legal_person",title:"Юридическое лицо"}],i.allDriversAreChanged=function(){var e=_.filter(i.persons,function(e){return e.isDriver});return e&&e.length===i.calculation.driver_set.length},i.personCheckUsed=a.personCheckUsed,i.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},i.drivers_set=t.drivers.length?t.drivers:t.persons,_.forEach(i.drivers_set,function(e,t){i.addPerson(_.extend({},e,{isOwner:!t,isInsurant:!t}),"natural_person")})}}}])}(angular),function(e){"use strict";e.module("calculatorU").directive("preCalculation",["calculatorService","letterService","policyOrderingService","calculatorStepsService","Dictionary","$filter","Messages","$q",function(e,t,a,i,n,r,s,l){return{restrict:"A",link:function(t){t.results=e.results&&e.results.length?e.results:[],e.results=t.results,t.results.length||function(){var a={car_cost:"0",car_mark:429,car_model_group:32504,car_model:41711,car_manufacturing_year:e.calculation.car_manufacturing_year,owner_registration:e.calculation.owner_registration,drivers_count:e.calculation.driver_set.length,driver_set:e.calculation.driver_set,is_multidrive:!1,insurance_duration:82,count_years_break_even_insurance:0,calculation_at_date:_.formatDate(e.calculation.calculation_at_date),engine_power:Number(i.calculationInterParams.engine_power),is_legal_entity:!1,has_trailer:!1,calculation_type:45426,is_calculate_osago:!0,is_credit:!1,is_new_car:!1,date_of_exploitation_period:"2016-01-01"};t.results.length=0,e.createCalculation(a).then(function(){var a;if(e.companiesInProgress.length)return a=_.map(e.companiesInProgress,function(a){return e.createResult(a.id).then(function(a){return a=_.head(a),parseInt(a.program.sum)&&t.results.push(e.parseResult(a)),a})}),l.all(a)}).then(function(){t.results=t.results.sort(function(e,t){return e.program.sum-t.program.sum})}).catch(function(){s.error("По Вашему запросу нет данных.",4e3),s.error("Попробуйте изменить настройки калькулятора.",4e3)})}(),t.selectedResult=e.result||null,t.selectResult=function(a){t.selectedResult=e.result=a,t.isSelectedOnPreCalculation=!0}}}}])}(angular),function(e,t){"use strict";e.module("calculatorU").controller("calculatorCtrl",["$scope","moduleType","$http","$state","$rootScope","brandingService","$stateParams","Dictionary","calculatorService","calculatorStepsService","CONSTS","$q","$location","Messages","formationPolicyStep1Service","brandingConfigs","addingDocumentsService","policyOrderingService",function(a,i,n,r,s,l,c,o,d,u,p,m,g,v,f,h,b,y){function w(){a.calculationResult.sort(function(e,t){return parseFloat(e.program.sum)>parseFloat(t.program.sum)?1:-1})}function k(t,a){return e.isArray(a)&&(t=_.pick(t,a)),t}var x,S=(d.calculation,{extra_parameters:1,available_programs:1,available_installments:1,ins_dir_car_name:1,installment:1,insurance_company:1,messages:1,insurer_data:1,sysinfo:1,options:1,variables:1}),P={};a.calculationResult=[],d.results=[],a.params=d.calculatorOtherParams,a.params.show_all=!1,a.params.curr_date=new Date,a.templates={navigation_custom:h.templates.navigation_custom,program_list_manager:h.templates.program_list_manager||l.program_list_manager_template||p.pathToModules+"shared/carFilter/views/program_list.manager.html",step_3:h.templates.step_3||l.step_3_template||p.pathToModules+"usago/calculatorU/views/calculation.step_3.html"},a.bigSteps=u.bigSteps,a.postCalculateParams={first:!1,second:!1,third:!1,is_visible:!1,manager__client_phone:"",manager__client_name:"",button_is_disabled:!1},a.getCurrentStep=u.getCurrentStep,o.getItems("antiThefts").then(function(e){a.antiThefts=_.forEach(e,function(e){e._title=e.title,e.title=e.at_mark.title+" ("+e.title+")"}),s.currentBrand.antiThefts&&(a.antiThefts=_.map(s.currentBrand.antiThefts,function(t){return _.find(e,function(e){return _.get(e,"at_mark.id")===t})}))}),a.toManager=function(){a.calculation.client_phone?a.sendToManager():a.postCalculateParams.third=!0},a.sendToManager=function(){var e=_.compatibleFormData(),t="",i=a.postCalculateParams.manager__client_name||a.calculation.client_name,n=a.postCalculateParams.manager__client_phone||a.calculation.client_phone;a.postCalculateParams.button_is_disabled=!0,t+="Клиент просит ему перезвонить.\n\n",t+="Имя клиента: "+i+"\n",t+="Телефон клиента: "+n+"\n\n",t+="Ссылка на расчет: http://enter.b2bpolis.ru/#/calculator/"+a.calculation.id,e.append("message",t),b.send(e).then(function(){a.postCalculateParams.button_is_disabled=!1,a.postCalculateParams.is_visible=!1,v.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){a.postCalculateParams.button_is_disabled=!1,v.error("Не удалось отправить запрос.",6e3)})},o.getItems("contributoryScheme").then(function(e){e=e.results?e.results:e,a.params.contributoryScheme=_.forEach(e,function(e){19!==e.id&&"Единовременно"!==e.title||(e.title="Нет")}),_.head(s.currentBrand.contributory_schemas)&&(a.params.contributoryScheme=_.map(s.currentBrand.contributory_schemas,function(e){return _.find(a.params.contributoryScheme,function(t){return t.id===e})}))}),a.paymentForm=s.currentBrand.payment_forms,a.getResultWithKbm=function(){var e=_.find(a.calculationResult,function(e){return 30829===e.insurance_company.id});return e||(e=_.find(a.calculationResult,function(e){return 30854===e.insurance_company.id})),e},a.setStep=function(e){a.step=e},a.root={messages:[],selectedResult:d.getSelectedResult()},a.calculation=d.calculation;var C=r.params.calculationId||a.calculation&&a.calculation.id;a.disabledSecondStep=!!a.calculation.id,a.calculateType=function(){return s.calcType},a.root.insuranceTypeTitle=function(){return"Калькулятор ОСАГО"},C?(C!=a.calculation.id&&d.resetCalculation(),P.getCalculation=d.getCalculation(C).then(function(){x=e.copy(a.calculation)}),P.getResult=d.getResult(C).then(function(e){if(!e||!e.length||!e)return void a.root.messages.push("Ошибка со стороны страховой компании.");a.calculationResult=d.results=_.filter(_.forEach(e,d.parseResult),function(e){return parseInt(e.program.sum)&&_.head(e.program.option_set)}),a.postCalculateParams.is_visible=!0,a.params.resultsAreVisible=!0,w()})):d.resetCalculation(),a.selectResult=function(e,t,i){var n;i?(n=_.find(a.calculationResult,function(t){return t.id==e}),n=_.find(n.availablePrograms,function(e){return e.id===i})):n=_.find(a.calculationResult,function(t){return t.id==e})||null,t?(d.setResultAsSelected(_.extend(n,{is_from_interface:!0})),d.setSelectedResult(n)):d.setSelectedResult(n),a.selectedResult=d.getSelectedResult(),n&&!s.currentBrand.without_policy_ordering&&(a.bigSteps.setBigStep("fourth"),d.setResultAsSelected(n)),n&&s.currentBrand.without_policy_ordering&&("fake_result_hack"===!n.id&&d.setResultAsSelected(n),y.sendLetterBeforeOrderWithPUS(t),setTimeout(function(){window.location.reload()},3e3))},a.getYearRange=function(e,t){var a,i,n
;return a=new Date,e=e||0,t=void 0===t?90:t,n=a.getFullYear()-t,i=a.getFullYear()-e,n+":"+i},a.resetCalculation=function(){a.calculation.id?v.success('Данные по расчету очищены, ваш расчет сохранен в разделе <a href="#/calculator/archive">Расчеты</a>.',7e3):v.success("Данные по расчету очищены.",4e3),d.resetCalculation(),f.resetAll(),a.calculationResult.length=0,g.search("policy",null),g.path("/calculator/"+s.calcType+"/",!1)};this.postResultByCompany=function(e,t,a,i){var r=k(S,i),s={"X-Calculation-Token":void 0};return n({method:"POST",url:p.urlPrefixV3+"calculation/"+e+"/result/"+t+"/",params:r,headers:s,data:JSON.stringify(a)}).then(function(e){return e.data})},a.calculate=function(i){a.prevCalculationResult=e.copy(a.calculationResult),a.calculationResult.length=0,d.results.length=0,a.selectResult(null),a.calculation.created_by_user=null,d.createCalculation().then(function(n){var l=[],c=0;a.root.messages.length=0,console.log("%c createCalculationSuccess ","color: green"),x=e.copy(a.calculation),r.go(r.current,{calculationId:a.calculation.id},{notify:!1}),d.companiesInProgress.length&&_.forEach(d.companiesInProgress,function(e){var t=d.createResult(e.id).then(function(e){e=_.filter(e,function(e){return e.calculation.id===d.calculation.id}),_.forEach(e,function(e){function t(t){return d.createResult(e.insurance_company.version,null,{programs:[t.id]}).then(function(e){return e=_.filter(e,function(e){return e.calculation.id===d.calculation.id}),e[0]})}var i=[],n=!1;e.is_default&&parseInt(e.program.sum)&&(a.calculationResult.push(d.parseResult(e)),d.results.push(d.parseResult(e)),w(),c++,c>=5&&(a.params.recalculateButtonIsDisabled=!1),s.currentBrand.with_programs&&(i=_.map(_.filter(e.available_programs,function(t){return t.id!==e.program.id}),t),m.all(i).then(function(t){t=_.filter(t,function(e){return!_.isNil(e.program.sum)}),s.currentBrand.antiThefts&&(t=_.filter(t,function(e){return _.find(a.antiThefts,function(t){return _.find(e.program.option_set,function(a){if("tech_assist"===a.code&&-1!==a.note.toUpperCase().indexOf(t.at_mark.title.toUpperCase())&&null!==a.note.match(/\([А-Яа-я| ]+([0-9|\,]+)[А-Яа-я| |\.]+\)/)&&a.note.match(/\([А-Яа-я| ]+([0-9|\,]+)[А-Яа-я| |\.]+\)/)[1])return e.PUS_cost=a.note.match(/\([А-Яа-я| ]+([0-9|\,]+)[А-Яа-я| |\.]+\)/)[1].replace(",",""),e.PUS_title=t.at_mark.title,a})})})),e.availablePrograms=t,!n&&s.currentBrand.additionalResult&&(e.availablePrograms=s.currentBrand.additionalResult(e.availablePrograms),n=!0)})))}),a.postCalculateParams.is_visible=!0});l.push(t)}),"function"==typeof i&&i(n),m.all(l).then(function(e){var i,n=_.flatten(e);if(console.log("%c createResultSuccess ","color: green"),a.params.resultsAreCreated=!0,a.params.recalculateButtonIsDisabled=!1,!n||!n.length)return a.root.messages.push("Ошибка на стороне сервера."),void(a.params.isCalculationProgress=!1);(i=t(".js-kasko-result").offset())&&jQueryApp("html,body").animate({scrollTop:i.top},"fast")},function(e){console.log("%c createResultError: ","color: red"),console.warn(e)}).then(function(e){a.params.recalculateButtonIsDisabled=!1,a.params.isCalculationProgress=!1})},function(e){console.log("%c createCalculationError: ","color: red"),console.warn(e),a.root.messages.push("Не удалось создать расчет. Пожалуйста, попробуйте позже."),a.params.isCalculationProgress=!1})}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorU").controller("calculatorUsagoCtrl",["$scope","$rootScope","$timeout","Dictionary","$http","$filter","calculatorService","calculatorStepsService","brandingConfigs","CONSTS",function(t,a,i,n,r,s,l,c,o,d){t.templates.navigation=o.templates.navigation||d.pathToModules+"shared/calculator/views/navigation.html",t.templates.program_list=o.templates.program_list||d.pathToModules+"usago/calculatorU/views/calculation.program_list.html",c.calculatorOtherParams=t.params=l.calculatorOtherParams,t.brandSteps=c.brandSteps,t.getActiveStep=c.getActiveStep,t.getActiveStepSecond=c.getActiveStepSecond,t.getFullDiscount=c.getFullDiscount,t.sumOfDiscounts=t.getFullDiscount(!0),t.calculationInterParams=c.calculationInterParams,t.carAllSelected=c.carAllSelected,o.parseCarInfo&&n.getItems("carMarks").then(function(e){var t=_.find(e.results,function(e){return e.title===a.brandExternalInfo.car_mark});n.getItems("carModelGroups",{car_mark:t.id}).then(function(e){var i=_.find(e.results,function(e){return-1!==e.title.toLowerCase().indexOf(a.brandExternalInfo.car_model.toLowerCase())});n.getItems("carModels",{car_model_group:i.id}).then(function(e){var n=e.results[0];_.extend(l.calculation,{car_mark:t.id,car_model:n.id,car_model_group:i.id,engine_power:a.brandExternalInfo.engine_power,car_cost:a.brandExternalInfo.car_cost,car_manufacturing_year:a.brandExternalInfo.car_manufacturing_year})})})}),n.getItems("yesNo").then(function(e){t.yesNo=e}),n.getItems("paymentForm").then(function(e){t.paymentForm=e.results}),t.params.getYRange=function(e,t){return"now"===e&&(e=(new Date).getFullYear()),"now"===t&&(t=(new Date).getFullYear()),_.map(_.range(e,t),function(e){return{id:e,title:e}})},t.params.driversCountChangedSimple=function(){var a=t.calculation.driver_set.length,i=t.params.drivers_count;if(t.params.field_was_clicked){if(i>a)for(var n=0;i-a>n;n++)t.calculation.driver_set.push(e.copy(l.defaultCalcDriver));else t.calculation.driver_set.length=+i;t.calculation.is_multidrive=!t.calculation.driver_set.length}},t.getCurrentDiscountTitle=function(){var e=t.bigSteps.getBigStep().name;if("third"===e)return o.with_sms&&t.params.resultsAreVisible,"";try{return"first"===e?t.getActiveStep().discountParams.getTitle():t.getActiveStepSecond().discountParams.getTitle()}catch(e){_.noop()}},t.getStepObjectByName=function(e){return c.getAllSteps()[e]},t.getPrevStep=c.toPrevSmallStep,t.setActiveStep=c.setActiveStep,t.getCurrentStepTitle=function(){var e=t.bigSteps.getBigStep().name;try{return"first"===e?t.getActiveStep().getCurrStepTitle():t.getActiveStepSecond().getCurrStepTitle()}catch(e){_.noop()}}}])}(angular),function(e){"use strict";e.module("calculator").provider("calculator",[function(){var t={created_at:"2017-04-14T18:18:59Z",countries:[],insurant_set:[],start_trip_date:null,end_trip_date:null,currency:1};this.setDefaults=function(a){e.extend(t,a)},this.getModuleType=function(){return"usago"},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e,t){"use strict";e.module("calculatorU").service("calculatorService",["$http","$q","Messages","CONSTS","$rootScope","resources","calculator","$filter","$timeout","requester",function(a,i,n,r,s,l,c,o,d,u){function p(e,t){return _.map(e,function(e){return _.extend({id:e,title:e},t)})}function m(e){return e=e||new Date,o("date")(e,"yyyy-MM-dd")}function g(e){var a=t(".ui-datepicker-year").val();return(e=new Date(e))?(e.setFullYear(a),o("date")(e,"yyyy-MM-dd")):""}var v=c.getDefaults(),f={},h={calculationTypeIsSelected:s.currentBrand.without_osago||!1,cascoBigSteps:[{name:"first",icon:"user",title:"Выбор параметров страхования"},{name:"second",icon:"file",title:"Выбор тарифа"},{name:"third",icon:"credit card alternative",title:"Оформление заявки на получение полиса"}],getBigStepIndex:function(e){return void 0!==f[e]?f[e]:(f[e]=_.findIndex(h.cascoBigSteps,function(t){return t.name===e}),f[e])},selectCalcType:function(){h.calculationTypeIsSelected=!h.calculationTypeIsSelected},years:{newCar:p(_.range((new Date).getFullYear(),(new Date).getFullYear()-3,-1),{type:"new"}),oldCar:p(_.range((new Date).getFullYear()-1,(new Date).getFullYear()-9,-1),{type:"old"})},selectYear:function(e){this.calculatorOtherParams.car_manufacturing_year=e}.bind(this)},b={result:null,full_year:null,field_was_clicked:!1,drivers_count:1,drivers_count_full:1,signalization_type:"",show_empty_fields:!1,resultsAreCreated:!1,deductible_value:"stratonov"==s.currentBrand.name?0:15e3,contributory_scheme:19,payment_form:107,recalculateButtonIsDisabled:!1,isCalculationProgress:!1,resultsAreVisible:!s.currentBrand.with_sms,multidriveForm:{birth_date:"",driving_experience_started:""},cascoParams:h};this.clientInfo={client_phone:""},this.car={},this.persons=[],this.requiringDrivers=function(e){return!!(e.last_name||e.first_name||e.patronymic)||(!(!e.driver_license||!e.driver_license.series&&!e.driver_license.number)||void 0)},this.parseResult=function(e){return e.company_logo="https://enter.b2bpolis.ru/"+e.insurance_company.logo,e},this.currentResult=null,this.getOtherCompanies=function(){return[{id:41243,title:"Росгосстрах",insurance_company:{logo:"media/logo_main_ins/Logo_24.png"}},{id:41465,title:"Ренессанс",insurance_company:{logo:"media/logo_main_ins/Logo_47.png"}}]},this.calculation=e.copy(v),this.companiesInProgress=[],this.getDefaultCalculation=function(){return v},this.selectedResult=null,this.setSelectedResult=function(e){this.selectedResult=e},this.getSelectedResult=function(){return this.selectedResult||this.result},this.calculationFormIsValid=_.noop,this._promises={},this.getPromises=function(){return this._promises},this.calculatorOtherParams=e.copy(b),this.resetCalculation=function(t){var a=e.copy(this.getDefaultCalculation());this.companiesInProgress.length=0,t=t||s.calcType;for(var i in this.calculation)this.calculation.hasOwnProperty(i)&&delete this.calculation[i];for(var n in a)a.hasOwnProperty(n)&&(this.calculation[n]=a[n]);for(var r in this.calculatorOtherParams)this.calculatorOtherParams.hasOwnProperty(r)&&(this.calculatorOtherParams[r]=b[r]);return this["to_defaults_"+t]&&this["to_defaults_"+t](),this},this.to_defaults_osago=this.to_defaults_usago=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=m(t)},this.to_defaults_kasko=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=m(t),this.calculation.deductible_currency=23},this.defaultCalcDriver={is_married:!1,gender:"M",expirience:null,age:null,has_children:!1},this.createCalculation=function(t){return t=t||this.calculation,this.companiesInProgress.length=0,t=this.correctCalculation(t),delete t.token,u.post(l.calculation+"?token",t).then(function(t){var a,i=t.data,n=["optional_equipment"];this.calculationToken=i.token,this.companiesInProgress=i.available_insurance_departments,delete i.available_insurance_departments;for(a in i)i.hasOwnProperty(a)&&-1===n.indexOf(a)&&(e.equals(this.calculation[a],i[a])||(this.calculation[a]=i[a]));return t.data}.bind(this))},this.getCalculation=function(e){return(e=e||this.calculation.id)==this.calculation.id?i.when(this.calculation):(this._promises.getCalculation=u.get(l.calculation+e+"/").then(function(e){var t;e=e.data;for(t in e)"user"!==t&&(this.calculation[t]=e[t]);return this.calculation}.bind(this)),this._promises.getCalculation)},this.getResult=function(e){return e=e||this.calculation.id,u.get(l.calculationV3+e+"/result/?insurance_company=1&messages=1&variables=1&options=1").then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.createResult=function(t,i,n){var r=this.calculationToken;i=i||this.calculation.id;var c="https://enter.b2bpolis.ru"+l.calculationV3+i+"/result/"+t+"/?available_programs=1&insurance_company=1&messages=1&variables=1&options=1";return a({url:c,method:"POST",headers:{"X-Calculation-Token":r},data:e.extend({},n)}).then(function(e){if(this.companiesInProgress=e.data,this.currentResult=e.data,"OSAGO"==_.get(e,"data[0].insurance_type")){var t=_.get(e,"data[0].variables.KBM");t&&(s.driversKBM=t)}return e.data}.bind(this))},this.setResultAsSelected=function(t,i){var n=this.calculationToken;return i=i||this.calculation.id,a({url:"https://enter.b2bpolis.ru"+l.calculationV3+i+"/result/"+t.insurance_company.version+"/?insurance_company=1&messages=1&variables=1&options=1",method:"PUT",headers:{"X-Calculation-Token":n},data:e.extend({},t,{is_selected:!0,is_default:!0,client_name:"Расчет отправлен",client_phone:null})}).then(function(e){return e.data})},this.getCredentialList=function(e){return a.get(r.urlPrefixDefault+"client/natural-person/"+e+"/credential").then(function(e){return e.data})},this.getAddressList=function(e){return a.get(r.urlPrefixDefault+"client/natural-person/"+e+"/address").then(function(e){return e.data})},this.correctCalculation=function(e){return e=e||this.calculation},this.personDateChanged=function(e,t,a){t=t||"birth_date",-1!==t.indexOf(".")?(t=t.split("."),e[t[0]][t[1]]=g(e[t])):e[t]=g(e[t])}}])}(angular,jQueryApp),function(e){e.module("brandingU",[])}(angular),function(e){"use strict";e.module("brandingU").service("brandingService",["CONSTS","$stateParams","brandingConfigs",function(t,a,i){var n={car_model_group_template:t.pathToModules+"usago/carFilterU/views/car_filter.car_group_models_list.html",car_model_template:t.pathToModules+"usago/carFilterU/views/car_filter.car_models_list.html",drivers_template:t.pathToModules+"usago/calculatorStepsU/views/step.usago_drivers_simple.html",is_multidrive_template:t.pathToModules+"usago/calculatorStepsU/views/step.is_multidrive.html",third_big_step_template:i.templates.third_big_step||t.pathToModules+"usago/carFilterU/views/third_big_step.html",program_list_manager_template:t.pathToModules+"usago/carFilterU/views/program_list.manager.html"},r={steps_buttons_color:"orange",united_buttons_color:"blue"};return n[t.currentBrand]=e.extend(r,i),n}])}(angular),function(e){e.module("formationPolicyU",[])}(angular),function(e){"use strict";e.module("formationPolicyU").service("formationPolicyService",["$http","CONSTS","$q","$rootScope","$filter","resources","requester",function(t,a,i,n,r,s,l){function c(e){return e=e||new Date,r("date")(e,"yyyy-MM-dd")}function o(e){var t;return t="legal_person"===e.personType?["title","title_eng","id","inn","ogrn","kpp","representative_first_name","representative_last_name","representative_patronymic","representative_post","representative_credential_type","representative_number","representative_issue_date"]:["id","first_name","last_name","patronymic","first_name_eng","last_name_eng","patronymic_eng","birth_date","gender","driving_experience_started","is_individual_entrepreneur","is_foreigner"],_.pick(e,t)}var d={object:{credential:[{issue_date:"2016-02-04",creator:10585,series:"3456",number:"45",object_id:1751,issue_point:"",credential_type:10,content_type:480,expiration_date:null,external_id:"9374",id:5449}],keys_count:2,manufacturing_date:"2015-01-01",engine_power:"200.00",car_modification:null,creator:10585,car_model:7687,engine_displacement:"2.00",car_body_number:null,mileage:null,number_plate:"",car_mark:303,vin_number:"55TTEEE5E5R5R6TT7",external_id:"7628",id:1751,cost:null},object_type:"car",person:[]},u=null,p=null;return{orderMessage:"",clear:function(){p=null},resetCurrentPolicy:function(){u=null},updateCustomer:function(e){var a=i.defer();return this.getCustomer(null).then(function(i){i.natural_persons=i.natural_persons.concat(e.natural_persons),i.natural_persons=_.uniq(i.natural_persons),t.put(s.customer+"/null",i).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},getCustomer:function(e){return e=e||null,t.get(s.customer+"/"+e).then(function(e){return e.data})},getCustomerCars:function(e){return e=e||null,t.get(s.customerCar,{params:{owner:e}}).then(function(e){return e.data})},getCarCredential:function(e){return t.get(s.customerCar+"/"+e+"/credential").then(function(e){return e.data})},getCustomerFull:function(e){var a=i.defer();return this.getCustomer(e).then(function(e){t.get(s.person+"/"+e.person).then(function(i){var n=i.data,r="naturalPerson",l=n.natural_person;n.legal_person&&(r="legalPerson",l=n.legal_person),t.get(s[r]+"/"+l).then(function(t){var i=t.data;a.resolve({person:i,drivers:e.natural_persons})},function(e){a.reject(e)})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},saveCar:function(a){var n=i.defer(),r=_.pick(a,["id","mileage","car_mark","car_model","car_modification","owner","manufacturing_date","vin_number","number_plate","engine_displacement","engine_power","cost","keys_count"]),l="post",c=s.customerCar;return r.owner=r.owner||null,r.id&&(l="put",c+="/"+r.id),t[l](c,r).then(function(r){var l=r.data,c=_.map(a.credential,function(e){return _.pick(e,["id","number","series","credential_type","issue_date","issue_point","expiration_date"])}),o=[];e.forEach(c,function(e){var a="post",i=s.customerCar+"/"+l.id+"/credential";e.id&&(a="put",i+="/"+e.id),o.push(t[a](i,e).then(function(e){return e.data}))}),i.all(o).then(function(e){n.resolve({car:l,credential:e})},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},createDeal:function(a){var n=i.defer();return t.post(s.deal,e.extend({deal_status:1,customer:null},a)).then(function(e){var i=e.data;i.car=a.car,t.put(s.deal+"/"+i.id,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},getDeal:function(e){return t.get(s.deal+"/"+e)},createInsuranceProduct:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/from-calculation",a).then(function(e){return e.data})},updateInsuranceProduct:function(e,a,i){return t.put(s.deal+"/"+e+"/insurance-product/"+a,i).then(function(e){return e.data})},createInvoice:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/"+a+"/invoice/generate").then(function(e){return e.data})},createPersonContainer:function(e,a){var i={};return a="legal_person"===a?"legal_person":"natural_person",i[a]=e,t.post(s.person,i).then(function(e){return e.data})},saveBSO:function(e,a){return t.post(s.resultPolicy+"/"+e+"/enter_bso/",a).then(function(e){return e.data})},createInsuredObjectByIds:function(e){return t.post("/rest/default/client/insured-object",e).then(function(e){return e.data})},createInsuredObjectOsago:function(t){var a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:+t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,car_body_number:t.car.car_body_number,engine_power_kilowatt:t.car.engine_power_kilowatt,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]};return e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this),e.forEach(t.persons,function(t,i){var n,r,s={},l=[],d=t.id||this.generateId(),u=t.address_registration?[t.address_registration]:[],p=o(t),m=t.personType;u&&u.lendth&&(u[0].address_type=1),"natural_person"===m?(t.passport&&t.passport.series&&t.passport.number?(t.passport.external_id=this.generateId(),r=[t.passport]):(r=t.credential,e.forEach(r,function(e){e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId()},this)),!t.is_same_address&&t.address_residential&&(u.push(t.address_residential),u[1].content_type=482,u[1].address_type=2),t.birth_date=c(t.birth_date),t.driving_experience_started=c(t.driving_experience_started)):r=null,e.forEach(["owner","insurant"],function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&l.push(e)}),l.length>0&&(s.role=l,s.external_id=d,s.id=t.person_id,s[m]=p,s[m].external_id=d,s[m].credential=r,s[m].address=u,a.person.push(s)),t.isDriver&&(n=e.copy(p),n.external_id=d,n.credential=[],n.credential.push(_.find(r,function(e){return 3===e.credential_type})),n.credential.push(_.find(r,function(e){return 1===e.credential_type})),n.credential[1]||(n.credential.length=1),a.drivers.push(n))},this),l.post(s.insuredObjectOsago,a).then(function(t){var a=_.get(t,"data.drivers");return a&&(n.driversToKBM=a),p=e.copy(t.data),t.data})},sendPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token",_.pick(e,"phone")).then(function(e){return e.data})},confirmPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token-verified",_.pick(e,"token")).then(function(e){return e.data})},toPay:function(e){return t.post("/payment/"+e+"/ ").then(function(e){return e.data})},createInsuredObject:function(t){var a,i;return t.car?(a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,is_new_car:t.car.is_new_car,is_temporary:t.car.is_temporary,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]},i=["owner","insurant","beneficiary"],e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this)):(a=d,i=["owner","insurant"]),e.forEach(t.persons,function(t,n){var r,s,l={},d=[],u=t.id||this.generateId(),p=[t.address_registration],m=_.filter(t.contact,function(e){return e.data}),g=o(t),v=t.personType;"legal_person"===v?s=null:(s=t.credential,e.forEach(s,function(e){e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId()},this),t.is_same_address||p.push(t.address_residential),t.is_temporary_registration&&p.push(t.address_temporary_registration),t.birth_date=c(new Date(t.birth_date)),t.driving_experience_started=t.driving_experience_started?c(new Date(t.driving_experience_started)):null),e.forEach(i,function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&d.push(e)}),e.forEach(p,function(e){e&&!e.country&&(e.country="Россия")}),d.length>0&&(l.role=d,l.external_id=u,l.id=t.person_id,l[v]=g,l[v].external_id=u,l[v].contact=m,l[v].credential=s,l[v].address=p,a.person.push(l)),t.isDriver&&(r=e.copy(g),r.external_id=u,r.address=p,r.credential=_.filter(s,function(e){return 3===e.credential_type}),a.drivers.push(r))},this),l.post(s.insuredObject,a).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObject:function(t){return l.get(s.insuredObject+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getInsuredObjectOsago:function(t){return l.get(s.insuredObjectOsago+"/"+t).then(function(t){return p=e.copy(t.data),t.data})},getPolicyFile:function(e,a){return a=a?"?type="+a:"",t({method:"GET",url:s.resultPolicy+e+"/template/"+a,headers:{}}).then(function(e){return e.data})},createInsuredObjectCRM:function(e){return t.post(s.insuredObjectCRM,e).then(function(e){return e.data})},createPolicy:function(a){return t.post(s.resultPolicy,e.extend({external_id:null},a)).then(function(e){return u=e.data})},savePolicy:function(a){var i="post",n=s.resultPolicy;return a.id&&(i="put",n=s.resultPolicy+a.id+"/"),t[i](n,e.extend({external_id:null},a)).then(function(e){return u=e.data})},getPolicy:function(e){return t.get(s.resultPolicy+e+"/",{params:{external_id:null}}).then(function(e){return u=e.data})},getSavedNaturalPersons:function(e){return t.get(s.savedNaturalPersons,{params:e}).then(function(e){return e.data})},getSavedLegalPersons:function(e){return t.get(s.savedLegalPersons,{params:e}).then(function(e){return e.data})},getSavedCars:function(e){return t.get(s.savedCars,{params:e}).then(function(e){return e.data})},getInsObjList:function(e){return t.get(s.insuredObectList,{params:e}).then(function(e){return console.log(e),e.data})},getCurrentPolicy:function(){return u},getCurrentInsuredObject:function(){return p},sendNotification:function(e){return t.post(s.notificationSend,e).then(function(e){return e.data})},generateId:function(){return~~(9900*Math.random()+100)},getPolicyActionsParameters:function(e){return t.get(s.resultPolicy+e+"/actions_parameters/",{params:{external_id:null}}).then(function(e){return e.data})},executePolicyAction:function(e,i,n){return t.post(a.urlPrefixPolicy+"result_policy/"+e+"/"+i+"/",n).then(function(e){return e.data})},getPolicyDocsArchive:function(e){return t.get(a.urlPrefixPolicy+"result_policy/"+e+"/zip/").then(function(e){return e.data})},getPolicyAttachments:function(e){return t.get(s.resultPolicy+e+"/attachment/").then(function(e){return e.data})},deletePolicyAttachment:function(e,a){return t.delete(s.resultPolicy+e+"/attachment/"+a).then(function(e){return e.data})},issueToSavedPolicy:function(e){return t.post(s.resultPolicy+e+"/issue_to_saved_policy/").then(function(e){return e})},setPersonValidationDates:function(e){e.isDriver?(e.birthDateRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age),c(t)}()},e.expirienceRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience),c(t)}()}):(e.birthDateRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-90),c(e)}(),max:function(){var e=new Date;return e.setFullYear(e.getFullYear()-18),c(e)}()},e.expirienceRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-72),c(e)}(),max:function(){return c(new Date)}()}),e.birthDateRange.yearRange=new Date(e.birthDateRange.min).getFullYear()+":"+new Date(e.birthDateRange.max).getFullYear(),e.expirienceRange.yearRange=new Date(e.expirienceRange.min).getFullYear()+":"+new Date(e.expirienceRange.max).getFullYear(),e.dateChanged=function(t,a){var i=new Date(t).getFullYear(),n=new Date(a).getFullYear();e.invalidDates=i-n>=18}}}}])}(angular),function(e,t){"use strict";e.module("formationPolicyU").service("formationPolicyStep1Service",["$filter","$rootScope","formationPolicyService","Person","calculatorService","$q",function(t,a,i,n,r,s){function l(){return S=e.copy(O)}function c(t,a){a=a||S;var i=_.filter(t,function(e){return e.credential_type===$.credential_type}),n=_.filter(t,function(e){return e.credential_type===B.credential_type});a.vehicle_registration=_.maxBy(i,function(e){return e.id})||e.copy($),a.vehicle_certificate=_.maxBy(n,function(e){return e.id})||e.copy(B)}function o(t){if(_.head(t.credential)&&"natural_person"===t.personType){var a=_.filter(t.credential,function(e){return e.credential_type==F.credential_type}),i=_.filter(t.credential,function(e){return e.credential_type==D.credential_type});t.driver_license=_.maxBy(a,function(e){return e.id}),t.passport=_.maxBy(i,function(e){return e.id})||e.copy(D)}return t}function d(t){return e.isArray(t.contact)&&t.contact.length>0&&(t.contact=_.sortBy(_.uniqBy(t.contact,function(e){return e.contact_type}),function(e){return e.contact_type})),t}function u(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970}function p(e){e.full=e.city+", "+e.street+", д."+e.house}function m(t){if(e.isArray(t.address)&&t.address.length>0){var a=_.filter(t.address,function(e){return 1===e.address_type});a=_.maxBy(a,function(e){return e.id});var i=_.filter(t.address,function(e){return 2===e.address_type});i=_.maxBy(i,function(e){return e.id});var n=_.filter(t.address,function(e){return 3===e.address_type});n=_.maxBy(n,function(e){return e.id}),t.is_same_address=!i,t.is_temporary_registration=Boolean(n),a&&(t.address_registration=a,p(a)),i&&(t.address_residential=i,p(i)),n&&(t.address_temporary_registration=n,p(n))}return t}function g(e,t){return t=t||a.calcType,A[t](e,S)}function v(e){return e=e||a.calcType,j[e]()}function f(e,t,i,n){return n=n||a.calcType,R[n](e,t,i)}function h(e,t){return t=t||a.calcType,N[t](e,t)}function b(e){return q.allTypes(e)}function y(e){return e=e||a.calcType,U[e]()}function w(e){return E.allTypes(e)}function k(){P.length=0,l()}function x(e){return e=e||a.calcType,L[e](e)}var S,P=[],C=r.calculation,I=function(e){return t("date")(e,"yyyy-MM-dd")},T={address_type:1,postal_index:null,content_type:482,country:"Россия",city:"",street:"",house:"",housing:"",flat:"",kladr:""},D={credential_type:1,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},F={credential_type:3,series:"",number:"",issue_date:"",issue_point:"РФ",expiration_date:""},$={credential_type:4,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},B={credential_type:7,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},M={is_same_address:!0,person_type:"natural_person",credential:[],isOwner:!1,isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:null,birth_date:"",passport:e.copy(D),address_registration:e.copy(T),address_residential:e.extend(e.copy(T),{address_type:2})},O={car_mark:null,car_model_group:null,car_model:null,car_manufacturing_year:null,car_modification:null,cost:0,vin_number:"",chassis_number:"",number_plate:"",engine_displacement:"",engine_power:"",engine_power_kilowatt:"",engine_power_loshad:"",keys_count:C.driver_set.length||1,mileage:"",manufacturing_date:null,selectedCar:"",vehicle_registration:e.copy($),vehicle_certificate:e.copy(B),document_issue_date:"",mode:"edit"};l();var R={osago:function(t,a,r){var s,l=new Date,c=new n(e.extend(e.copy(M),{personType:a||"natural_person",isOwner:!1,isInsurant:!1,isDriver:!1,selectedPerson:"",mode:"edit"}));return t=t||{},"legal_person"===a?(c.extend({title:"",isDriver:!1,inn:"",ogrn:""}),c.address_registration=c.addAddress(e.copy(T))):(s=t.expirience||0===t.expirience?t.expirience:null,null===s&&(s=u(t.driving_experience_started)),c.extend({age:t.age||18,expirience:s,gender:"M",birth_date:t.birth_date||"",is_same_address:!0,is_temporary_registration:!1,driving_experience_started:t.driving_experience_started||""}),c.passport=c.addCredential(e.copy(D)),c.driver_license=c.addCredential(e.copy(F)),c.address_registration=c.addAddress(e.copy(T)),c.address_residential=c.addAddress(e.copy(T)),c.address_temporary_registration=c.addAddress(e.copy(T)),c.driving_experience_started||(l=new Date,l.setFullYear(l.getFullYear()-c.expirience),c.driver_license.issue_date=I(l),c.driving_experience_started=I(l))),c.extend(t),i.setPersonValidationDates(c),c.hasRole=function(){return c.isInsurant||c.isOwner},r||P.push(c),c}};R.usago=R.osago;var j={osago:function(){return function(){return C.id||(C.insured_object=11920),C.insured_object?i.getInsuredObject(C.insured_object):s.when({})}().then(function(t){t&&t.id?g(t):0===P.length&&_.forEach(C.driver_set,function(t){var a={isDriver:!0,showFioFields:!0};f(e.extend(a,t))}),e.extend(S,{car_mark:C.car_mark,car_model:C.car_model,car_modification:C.car_modification,cost:Math.floor(C.car_cost),car_body_number:"",vin_number:null,number_plate:"",engine_displacement:null,engine_power:C.engine_power,mileage:null,manufacturing_date:C.car_manufacturing_year+"-01-01",vehicle_registration:e.copy($),vehicle_certificate:e.copy(B),credential:[]}),e.extend(S,t.object),S.id=null;var i=_.head(P);if(C.is_legal_entity&&"false"!==C.is_legal_entity&&(i.address_registration=e.copy(T)),C.is_legal_entity&&a.currentUser){i.isInsurant=!1;var n=f({isInsurant:!0,isOwner:!1,isDriver:!1,title:a.currentUser.last_name,inn:a.currentUser.inn,ogrn:a.currentUser.ogrn},"legal_person");a.currentUser.address&&(e.extend(n.address_registration,a.currentUser.address),p(n.address_registration))}else i&&a.currentUser&&a.currentUser.id&&(i.passport&&!i.passport.series&&(i.passport.series=a.currentUser.passport_series,i.passport.number=a.currentUser.passport_number),i.address_registration&&!i.address_registration.city&&a.currentUser.address&&(e.extend(i.address_registration,a.currentUser.address),p(i.address_registration))),i.isInsurant=!0;i.isOwner=!0})}},A={osago:function(a){var i;P.length=0,S=a.object,c(S.credential),S.engine_power_kilowatt=+(.7355*C.engine_power).toFixed(2),S.engine_power=C.engine_power,
_.forEach(a.person,function(e){var a=e.natural_person?"natural_person":"legal_person";e[a].personType=a,e[a].person=e.id,o(e[a]),m(e[a]),e[a].selectedPerson=e[a].external_id,"natural_person"===a&&(e[a].age=t("calcAge")(e[a].birth_date)),e.role.length&&_.forEach(e.role,function(t){e[a]["is"+t[0].toUpperCase()+t.substr(1)]=!0}),f(e[a])}),i=_.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,o(e),m(e)}),_.forEach(i,function(t){var a;_.forEach(P,function(i,n){t.external_id===i.external_id&&(a=!0,e.extend(i,t),i.isDriver=!0)}),t.driver_license=_.find(t.credential,function(e){return 3===e.credential_type})||e.copy(F),a||f(t)})}},N={osago:function(e){var t=P.indexOf(e),a=t-1>=0?t-1:t+1;e.isOwner&&(P[a].isOwner=!0),e.isInsurant&&(P[a].isInsurant=!0),-1!==t&&P.splice(t,1)}},U={osago:function(){e.forEach(P,function(e){e.address=[],e.credential=[],e.birth_date=I(e.birth_date),"natural_person"===e.personType&&((e.isInsurant||e.isOwner)&&(e.passport.credential_type=1,e.credential.push(e.passport)),e.isDriver&&(e.driver_license&&e.credential.push(e.driver_license),e.driving_experience_started=I(e.driving_experience_started)))});var t=_.find(P,function(e){return e.isOwner}),a=_.find(P,function(e){return e.isInsurant}),n=_.map(_.filter(P,function(e){return e.isDriver}),"id"),r={owner:t.person,beneficiary:t.person,insurant:a.person,drivers:n,object_type:"car",object_id:S.id};return S.credential=[],S.vehicle_registration&&S.credential.push(S.vehicle_registration),S.vehicle_certificate&&S.credential.push(S.vehicle_certificate),i.createInsuredObjectByIds(r)}},E={allTypes:function(t){return function(a){return e.isObject(a)&&(b(t),t.extend(a),t.getCredentialList().then(function(){o(t)}),t.getAddressList().then(function(){m(t)}),t.getContactList().then(function(){d(t)})),!0}}},q={allTypes:function(t){return e.extend(t,{id:null,age:t.selectedPerson?18:t.age,birth_date:"",last_name:"",first_name:"",patronymic:"",last_name_eng:"",first_name_eng:"",patronymic_eng:"",is_same_address:!0,driving_experience_started:"",selectedPerson:"",document:{credential_type:1,series:"Не указан",number:"",issue_date:""},title:"",title_eng:"",inn:"",ogrn:"",kpp:"",representative_first_name:"",representative_last_name:"",representative_patronymic:"",representative_post:"",representative_credential_type:"",representative_number:"",representative_issue_date:"",rsa_check_id:null,person:null,is_verified:null,is_current_user:!1}),t.pT=t.pT||t.personType,t.passport=t.addCredential(e.copy(D)),t.ogrntip=t.addCredential(e.copy(D)),t.driver_license=t.addCredential(e.copy(F)),t.address_registration=t.addAddress(e.copy(T)),t.address_residential=t.addAddress(e.copy(T)),t.address_temporary_registration=t.addAddress(e.copy(T)),t.contact=[{contact_type:1,data:""},{contact_type:2,data:""}],t.address_registration.country=null,t.address_residential.country=null,t.address_temporary_registration.country=null,t.credential.length=0,t.address.length=0,t.contact.length=0,t}},L={osago:function(){var e={isInsurant:!1,isOwner:!1,all:!1};return _.forEach(P,function(t){t.isInsurant&&(e.isInsurant=!0),t.isOwner&&(e.isOwner=!0)}),e.all=e.isInsurant&&e.isOwner,e}};return L.usago=L.osago,{init:function(){},addPerson:f,resetPerson:b,initFromCalculation:v,initFromInsuredObject:g,removePerson:h,persons:P,getPersons:function(){return P},createInsuredObject:y,resetAll:k,showSavedPersonsCallback:w,resetCar:l,getCar:function(){return S},setCarCredentials:c,getDefaultObject:function(t){var a={defaultAddressObject:T,defaultPassportObject:D,defaultDriverLicenseObject:F,defaultVehicleRegistrationObject:$};return e.copy(a[t])},setPersonCredential:o,setPersonAddress:m,setFullAddress:p,personCheckUsed:x}}])}(angular),function(e){"use strict";e.module("personalDataU",[])}(angular),function(e){"use strict";e.module("personalDataU").controller("personalDataCtrl",["$scope","CONSTS","Person","formationPolicyStep1Service","formationPolicyService","$filter","$state","Dictionary","calculatorStepsService",function(e,t,a,i,n,r,s,l,c){function o(e){-1!==e.patronymic.indexOf("ич")&&e.patronymic.indexOf("ич")===e.patronymic.length-2&&(e.gender="M"),-1!==e.patronymic.indexOf("на")&&e.patronymic.indexOf("на")===e.patronymic.length-2&&(e.gender="F")}function d(e){return r("date")(e,"dd.MM.yyyy")}function u(e,t){var a="";return e.city&&(a+=t+": ",a+=e.city+" "+e.street+" д."+e.house+" ",e.housing&&(a+="Корпус "+e.housing+" "),e.flat&&(a+="Кв./офис "+e.flat+" "),a+="\n"),a}function p(){var t="";_.forEach(e.persons,function(e,a){t+=a+1+"-й участник договора \n",e.isInsurant&&(t+="Страхователь. "),t+="\n",t+="ФИО: "+e.last_name+" "+e.first_name+" "+(e.patronymic||"")+"\n",t+="Дата рождения: "+d(e.birth_date)+"\n",t+="Пол: "+e.gender+"\n",t+="Тип документа: "+e.document_type+"\n",e.citizenship&&(t+="Гражданство: "+e.citizenship+"\n"),e.snils_number&&(t+="Номер СНИЛС: "+e.snils_number+"\n"),t+="Серия и номер документа: "+e.document.series+" "+e.document.number+"\nДата получения: "+d(e.document.issue_date)+"\nКем выдан: "+e.document.issue_point+"\n",t+=u(e.address_registration,"Адрес регистрации"),t+="\n"}),n.orderMessage=t}i.init(),e.dicts={countries:l.getItems("countries"),document_types:l.getItems("document_types")},e.persons=i.persons;var m=function(){p(),c.bigSteps.setBigStep("fourth")};e.personalDataActions={removePerson:i.removePerson,addPerson:i.addPerson,savePersonalData:m,insurantIsExist:_.find.bind(_,i.persons,"isInsurant"),setInsurant:i.setInsurant,patronymicChange:o},e.addressIsValid=function(e){return e.city&&e.house&&e.street}}])}(angular),function(e){e.module("calculatorStepsU",[])}(angular),function(e){e.module("carFilterU",[])}(angular),function(e){e.module("application",[]).directive("popup",function(){return{restrict:"A",link:function(e,t,a){jQueryApp(t).popup({popup:a.popup,position:"top center",delay:{show:50,hide:2e3}})}}}),e.module("application").component("agreementCheckbox",{bindings:{checked:"<",changed:"&"},template:['<div class="ui checkbox">','<input type="checkbox" ng-model="$ctrl.checked" ng-change="$ctrl.changed({$value: $ctrl.checked})">','<label style="text-align: left">','<span style="font-weight: bold">Я даю согласие на обработку персональных данных</span><br>',"<small>Обработка персональных данных осуществляется согласно ФЗ РФ №152-ФЗ</small>","</label>","</div>"].join("")})}(angular),function(e){"use strict";e.module("application").service("applicationService",["requester",function(e){this.getCurrentBrandsUser=function(){return e.get("/rest/v3/default/accounts/user/current").then(function(e){return e.data})}}])}(angular),function(e){e.module("utils",[])}(angular),function(e){"use strict";e.module("utils").directive("compile",["$compile",function(e){return function(t,a,i){t.$watch(function(e){return e.$eval(i.compile)},function(i){a.html(i),e(a.contents())(t)})}}])}(angular),function(e,t){"use strict";e.module("utils").directive("focusing",[function(){return{restrict:"A",link:function(e,a,i,n){function r(e){return e=e||o,e.find(".field input").filter(":visible")}function s(e){var a,i,n=r(),s=t(e.target);s.hasClass("ng-invalid")||13===e.keyCode&&(a=n.eq(n.index(e.target)+1),a.length?a.focus():(i=t("."+(+d+1)+"-is-focusing"),i.length?r(i).eq(0).focus():t("#id-after-focusing").focus()))}var l,c,o=t(a),d=_.uniqueId();o.addClass("is-focusing "+d+"-is-focusing"),setTimeout(function(){l=r(),c=l.filter(".focusing-first"),c.length?c.eq(0).focus():l.eq(1).focus(),l.on("keypress",s)},300)}}}])}(angular,jQueryApp),function(e){"use strict";e.module("utils").directive("ngMax",[function(){function t(t){return e.isUndefined(t)||""===t||null===t||t!==t}return{restrict:"A",require:"ngModel",link:function(e,a,i,n){var r=function(e){var a=i.ngMax||0;return!t(e)&&e>a?n.$setValidity(i.name+"_max",!1):n.$setValidity(i.name+"_max",!0),e};n.$parsers.push(r),n.$formatters.push(r),e.$watch(function(){return i.ngMax},function(e,t){e!==t&&r(n.$viewValue)})}}}])}(angular),function(e){"use strict";e.module("utils").directive("ngMin",[function(){function t(t){return e.isUndefined(t)||""===t||null===t||t!==t}return{restrict:"A",require:"ngModel",link:function(e,a,i,n){var r=function(e){var a=i.ngMin||0;return!t(e)&&e<a?n.$setValidity(i.name+"_min",!1):n.$setValidity(i.name+"_min",!0),e};n.$parsers.push(r),n.$formatters.push(r),e.$watch(function(){return i.ngMin},function(e,t){e!==t&&r(n.$viewValue)})}}}])}(angular),function(e){"use strict";e.module("utils").directive("noEmpty",[function(){function t(t){return e.isUndefined(t)||""===t||null===t||t!==t||"0"===t||0===t}return{restrict:"A",require:"ngModel",link:function(e,a,i,n){var r=function(e){return t(e)?(n.$setValidity(i.name,!1),e):(n.$setValidity(i.name,!0),e)};n.$parsers.push(r),n.$formatters.push(r)}}}])}(angular),function(e,t){"use strict";e.module("utils").directive("scrollTo",[function(){return{restrict:"A",link:function(e,a,i){var n,r,s=t(a),l=i.scrollTo?+i.scrollTo:500;s.addClass("js-scroll-to"),function(){setTimeout(function(){n=s.offset(),r=n&&n.top||0,t("html,body").animate({scrollTop:r},"fast")},l)}()}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("utils").directive("scrollToTarget",[function(){return{restrict:"A",link:function(e,a,i){t(a).on("click",function(e){e.preventDefault();var a=t(i.scrollToTarget),n=a.offset();n&&t("html, body").animate({scrollTop:n.top},400)}),t("html,body").on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(){t("html,body").stop()})}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("utils").directive("yaMetrika",["$rootScope","moduleType",function(e,a){return{restrict:"A",scope:!1,link:function(i,n,r){var s=t(n),l=r.yaMetrika;l+="--"+a,e.currentBrand.ya_metrika_id&&s.on("click.YaMetrika",function(t){window["yaCounter"+e.currentBrand.ya_metrika_id].reachGoal.call(n,l)})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("utils").filter("boolFormatter",[function(){return function(e){return e?"да":"нет"}}])}(angular),function(e){"use strict";e.module("utils").filter("calcAge",[function(){return function(e){var t=+new Date(e);return~~((Date.now()-t)/315576e5)}}])}(angular),function(e){"use strict";e.module("utils").filter("dateExpired",[function(){return function(t,a){var i=new Date(t);return!(e.isDate(i)&&!isNaN(i.getTime()))||!!a&&Math.abs((new Date-i)/864e5)>a}}])}(angular),function(e){"use strict";e.module("utils").filter("fioFormatter",[function(){return function(t,a){var i="";return e.isObject(t)?void 0!==t.last_name&&void 0!==t.first_name?(i=(t.last_name||"")+" "+(t.first_name||""),"full"===a&&t.patronymic&&(i+=" "+t.patronymic),i):void 0!==t.title?(i=t.title,"full"===a&&t.full_title&&(i=t.full_title),i):"":t}}])}(angular),function(e){e.module("utils").filter("fractionalFormatter",[function(){return function(e,t){var a,i=parseFloat(e);if(isNaN(i))return"";for(a=i%1,t&&a&&(a=(a.toFixed(2)+"").substr(2,t)),a+="";a.length<t;)a+="0";return a}}])}(angular),function(e){"use strict";e.module("utils").filter("multiColumn",[function(){var t=[];return function(a,i){var n;if(!i||!e.isArray(a))return a;if(n=_.find(t,function(e){return JSON.stringify(e.items)===JSON.stringify(a)&&JSON.stringify(e.options)===JSON.stringify(i)}))return n.filtered;var r,s=i.columns||null,l=i.rows||null,c=[[]],o=0,d=0;if(!s&&!l)throw new Error("Number of rows or columns must be specified");if(s&&l)throw new Error("Number of rows and columns can not be used simultaneously");s=s>a.length?a.length:s,l=l>a.length?a.length:l,r=s?Math.ceil(a.length/s):l;for(var u=0,p=a.length;u<p;u++,o++)o===r&&(d++,o=0,c[d]=[]),c[d].push(a[u]);return t.push({items:a,options:i,filtered:c}),c}}])}(angular),function(e){"use strict";e.module("utils").filter("num",[function(){return function(e){var t=parseInt(e,10);return isNaN(t)?e:t}}])}(angular),function(e){"use strict";e.module("utils").filter("formatTime",[function(){return function(e){var t=e.split("");return t[0].toString()+t[1].toString()+":"+t[2].toString()+t[3].toString()}}])}(angular),function(e){"use strict";e.module("utils").service("fakeData",function(){function e(e,t){_.forEach(t,function(t){e[t.name]=t.value})}return{fill:e}})}(angular),function(e){"use strict";e.module("utils").service("letterService",["moduleType","$q","CONSTS","$http","$rootScope",function(e,t,a,i,n){function r(){var e;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e||"undefined"==typeof XMLHttpRequest||(e=new XMLHttpRequest),e}function s(e,t){var a=_.compatibleFormData();return a.append("message","Запрос на консультацию от юридического лица\nТелефон: "+e+"\nEmail: "+t),a.append("clientMail",t),c(a)}function l(e){return i({method:"post",url:a.proxyUrl+"/sendmail",headers:{"Content-Type":"application/json"},data:{content:e,brand:n.currentBrandName,calc_type:n.calcType}})}function c(e,n){var s,l=t.defer(),c=a.currentProxyPath+"mail.php";return e.isFake?i({method:"post",url:c,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:_.reduce(e,function(e,t,a){return t?(e?e+"&":"")+a+"="+t:e},"")}).then(function(e){return e.data}):(s=r(),s.open("POST",c,!0),s.onreadystatechange=function(){4==s.readyState&&(200==s.status?l.resolve(s.responseText):l.reject(n?n(s.responseText):s.responseText))},s.send(e),l.promise)}return{send:c,sendViaApi:l,sendOmsConsultOrder:s}}])}(angular),function(e){"use strict";e.module("utils").service("md5",[function(){function e(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function t(e,t){return e<<t|e>>>32-t}function a(a,i,n,r,s,l){return e(t(e(e(i,a),e(r,l)),s),n)}function i(e,t,i,n,r,s,l){return a(t&i|~t&n,e,t,r,s,l)}function n(e,t,i,n,r,s,l){return a(t&n|i&~n,e,t,r,s,l)}function r(e,t,i,n,r,s,l){return a(t^i^n,e,t,r,s,l)}function s(e,t,i,n,r,s,l){return a(i^(t|~n),e,t,r,s,l)}function l(t,a){t[a>>5]|=128<<a%32,t[14+(a+64>>>9<<4)]=a;var l,c,o,d,u,p=1732584193,m=-271733879,_=-1732584194,g=271733878;for(l=0;l<t.length;l+=16)c=p,o=m,d=_,u=g,p=i(p,m,_,g,t[l],7,-680876936),g=i(g,p,m,_,t[l+1],12,-389564586),_=i(_,g,p,m,t[l+2],17,606105819),m=i(m,_,g,p,t[l+3],22,-1044525330),p=i(p,m,_,g,t[l+4],7,-176418897),g=i(g,p,m,_,t[l+5],12,1200080426),_=i(_,g,p,m,t[l+6],17,-1473231341),m=i(m,_,g,p,t[l+7],22,-45705983),p=i(p,m,_,g,t[l+8],7,1770035416),g=i(g,p,m,_,t[l+9],12,-1958414417),_=i(_,g,p,m,t[l+10],17,-42063),m=i(m,_,g,p,t[l+11],22,-1990404162),p=i(p,m,_,g,t[l+12],7,1804603682),g=i(g,p,m,_,t[l+13],12,-40341101),_=i(_,g,p,m,t[l+14],17,-1502002290),m=i(m,_,g,p,t[l+15],22,1236535329),p=n(p,m,_,g,t[l+1],5,-165796510),g=n(g,p,m,_,t[l+6],9,-1069501632),_=n(_,g,p,m,t[l+11],14,643717713),m=n(m,_,g,p,t[l],20,-373897302),p=n(p,m,_,g,t[l+5],5,-701558691),g=n(g,p,m,_,t[l+10],9,38016083),_=n(_,g,p,m,t[l+15],14,-660478335),m=n(m,_,g,p,t[l+4],20,-405537848),p=n(p,m,_,g,t[l+9],5,568446438),g=n(g,p,m,_,t[l+14],9,-1019803690),_=n(_,g,p,m,t[l+3],14,-187363961),m=n(m,_,g,p,t[l+8],20,1163531501),p=n(p,m,_,g,t[l+13],5,-1444681467),g=n(g,p,m,_,t[l+2],9,-51403784),_=n(_,g,p,m,t[l+7],14,1735328473),m=n(m,_,g,p,t[l+12],20,-1926607734),p=r(p,m,_,g,t[l+5],4,-378558),g=r(g,p,m,_,t[l+8],11,-2022574463),_=r(_,g,p,m,t[l+11],16,1839030562),m=r(m,_,g,p,t[l+14],23,-35309556),p=r(p,m,_,g,t[l+1],4,-1530992060),g=r(g,p,m,_,t[l+4],11,1272893353),_=r(_,g,p,m,t[l+7],16,-155497632),m=r(m,_,g,p,t[l+10],23,-1094730640),p=r(p,m,_,g,t[l+13],4,681279174),g=r(g,p,m,_,t[l],11,-358537222),_=r(_,g,p,m,t[l+3],16,-722521979),m=r(m,_,g,p,t[l+6],23,76029189),p=r(p,m,_,g,t[l+9],4,-640364487),g=r(g,p,m,_,t[l+12],11,-421815835),_=r(_,g,p,m,t[l+15],16,530742520),m=r(m,_,g,p,t[l+2],23,-995338651),p=s(p,m,_,g,t[l],6,-198630844),g=s(g,p,m,_,t[l+7],10,1126891415),_=s(_,g,p,m,t[l+14],15,-1416354905),m=s(m,_,g,p,t[l+5],21,-57434055),p=s(p,m,_,g,t[l+12],6,1700485571),g=s(g,p,m,_,t[l+3],10,-1894986606),_=s(_,g,p,m,t[l+10],15,-1051523),m=s(m,_,g,p,t[l+1],21,-2054922799),p=s(p,m,_,g,t[l+8],6,1873313359),g=s(g,p,m,_,t[l+15],10,-30611744),_=s(_,g,p,m,t[l+6],15,-1560198380),m=s(m,_,g,p,t[l+13],21,1309151649),p=s(p,m,_,g,t[l+4],6,-145523070),g=s(g,p,m,_,t[l+11],10,-1120210379),_=s(_,g,p,m,t[l+2],15,718787259),m=s(m,_,g,p,t[l+9],21,-343485551),p=e(p,c),m=e(m,o),_=e(_,d),g=e(g,u);return[p,m,_,g]}function c(e){var t,a="",i=32*e.length;for(t=0;t<i;t+=8)a+=String.fromCharCode(e[t>>5]>>>t%32&255);return a}function o(e){var t,a=[];for(a[(e.length>>2)-1]=void 0,t=0;t<a.length;t+=1)a[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)a[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return a}function d(e){return c(l(o(e),8*e.length))}function u(e,t){var a,i,n=o(e),r=[],s=[];for(r[15]=s[15]=void 0,n.length>16&&(n=l(n,8*e.length)),a=0;a<16;a+=1)r[a]=909522486^n[a],s[a]=1549556828^n[a];return i=l(r.concat(o(t)),512+8*t.length),c(l(s.concat(i),640))}function p(e){var t,a,i="0123456789abcdef",n="";for(a=0;a<e.length;a+=1)t=e.charCodeAt(a),n+=i.charAt(t>>>4&15)+i.charAt(15&t);return n}function m(e){return unescape(encodeURIComponent(e))}function _(e){return d(m(e))}function g(e){return p(_(e))}function v(e,t){return u(m(e),m(t))}function f(e,t){return p(v(e,t))}function h(e,t,a){return t?a?v(t,e):f(t,e):a?_(e):g(e)}return h}])}(angular);var index=0;!function(e){"use strict";e.module("utils").service("requester",["$http","CONSTS","$rootScope",function(t,a,i){function n(n){return function(r,s){return"attiks"!=i.currentBrandName&&r.toString().includes("calculation")&&s&&(["casco","kasko"].includes(i.calcType)?s.client_name=["СМС лид","Расчет отправлен"][index++]:["osago","usago"].includes(i.calcType)&&(s.client_name=["Лид без КБМ","Лид c КБМ","Расчет отправлен"][index++]),delete s.client_phone),t({url:i.currentBrand.proxyApi?a.proxyUrl+"/proxy":a.proxyPathC+"proxy.php",method:n,data:e.extend({},s),headers:{"Access-Control-Allow-Origin":"*","X-Itform-Forward":r,"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:0},params:{brand:i.currentBrandName,url:r}})}}return{get:n("GET"),post:n("POST"),put:n("PUT"),getOriginal:function(a,i){return t({method:"GET",url:a,params:e.extend({v:Math.floor(1e8*Math.random())},i)})}}}])}(angular),function(e){"use strict";e.module("utils").service("transformToFormData",function(){function e(e){var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}return e})}(angular),function(e){e.module("dictionary",[])}(angular),function(e){"use strict";e.module("dictionary").directive("dictionary",["Dictionary","$parse",function(t,a){return{template:"{{foundResult}}",scope:{dictionary:"@",dictionaryId:"=",dictionaryArray:"=",dictionaryProp:"@"},link:function(i){function n(){var n;a(i.dictionaryProp);if(i.foundResult="",e.isString(i.dictionary)&&""!==i.dictionary)t.findItem(i.dictionary,i.dictionaryId,i.dictionaryProp).then(function(e){return i.foundResult=e,i.foundResult});else if(e.isArray(i.dictionaryArray))return(n=_.find(i.dictionaryArray,function(e){return e.id==i.dictionaryId}))&&i.dictionaryProp?(i.foundResult=n[i.dictionaryProp],i.foundResult):(i.foundResult=n,n)}i.$watch("dictionaryId",function(e,t){e!==t&&n()}),i.$watch("dictionaryArray",function(e,t){e!==t&&n()}),n()}}}])}(angular),function(e,t){"use strict";e.module("dictionary").provider("Dictionary",function(){var a={},i=[],n=86400;return{$get:["$q","$filter","requester",function(r,s,l){function c(){var e=window.localStorage;try{return e.setItem("test","1"),e.removeItem("test"),!0}catch(e){return!1}}function o(t,a,i){var n,r,s,l={};if(t.results&&(t=t.results),void 0!==(n=_.find(t,function(e){return a==e.id}))){if(e.isArray(i))for(r=0,s=i.length;r<s;r++)l[i[r]]=n[i[r]];else l=e.isString(i)?n[i]:n;return l}}function d(a,i,n){var r,s,l={defaults:n||{},urlParams:{}},c=a,o=l.urlParams;return e.forEach(c.split(/\W/),function(t){if("hasOwnProperty"===t)throw e.$$minErr("$resource")("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(t)&&t&&new RegExp("(^|[^\\\\]):"+t+"(\\W|$)").test(c)&&(o[t]=!0)}),c=c.replace(/\\:/g,":"),i=i||{},e.forEach(l.urlParams,function(t,a){r=i.hasOwnProperty(a)?i[a]:l.defaults[a],e.isDefined(r)&&null!==r?(s=u(r),c=c.replace(new RegExp(":"+a+"(\\W|$)","g"),function(e,t){return s+t})):c=c.replace(new RegExp("(/?):"+a+"(\\W|$)","g"),function(e,t,a){return"/"==a.charAt(0)?a:t+a}),i.hasOwnProperty(a)&&delete i[a]}),/\/+$/.test(a)||(c=c.replace(/\/+$/,"")||"/"),c=c.replace(/\/\.(?=\w+($|\?))/,"."),c=c.replace(/\/\\\./,"/."),e.isObject(i)&&_.keys(i).length>0&&(c+="?"+t.param(i)),c}function u(e){return p(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function p(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function m(e){if(void 0===e||""===e)throw new Error("Empty dictionary name");if(void 0===k[e])throw new Error("Invalid dictionary name: "+e);return k[e]instanceof g||(k[e]=new g(k[e]),k[e].dictName=e),!0}var g,v="https://enter.b2bpolis.ru"+a.urlPrefixV4,f="http://vzr-demo.dev.cmios.ru/rest/v1/",h=a.vzrAggregatorUrl+"/api/v1/dictionaries/",b=s("priceFormatter"),y=function(){try{if(c())return window.localStorage}catch(e){return{getItem:function(){},setItem:function(){}}}}(),w={},k={vzrMedical:{getItems:function(){return r.when(_.map([3e4,35e3,4e4,5e4,1e5],function(e){return{id:e,title:b(e)+" €"}}))}},vzrInsuranceOptions:{url:h+"insurance-option/by-groups/"},vzrCurrencies:{url:h+"currency"},vzrInsuranceCompany:{url:h+"insurance-company"},vzrInsuranceRiskType:{url:h+"insurance-risk-type"},vzrAggregatorSportType:{url:h+"sport-type"},insuranceRiskAmount:{url:h+"insurance-risk-amount"},countries:{url:h+"territory"},vzrInsuranceDay:{url:h+"insurance-day"},vzrInsurancePeriods:{url:f+"accident/insurance-period"},vzrAgeCategory:{url:f+"accident/age-category"},vzrSportType:{url:f+"accident/sport-type"},vzrSportKind:{url:f+"accident/sport-kind"},cities:{url:a.urlPrefixCalc+"city/:id/"},tripPurpose:{url:a.urlPrefixCalc+"trip_purpose/"},validity:{url:a.urlPrefixCalc+"validity/"},insuranceSum:{url:a.urlPrefixCalc+"insurance_sum/"},credentialTypes:{url:a.urlPrefixDefault+"client/credential-type/:id"},carMarksByPopularity:{url:v+"car-mark?ordering=-rank",localStorage:!1},carMarks:{url:v+"car-mark/:id",localStorage:!0},carModelGroups:{url:v+"car-model-group",localStorage:!0},carModelsByGroup:{url:v+"car-model/:id",localStorage:!0},carModels:{url:v+"car-model/:id",localStorage:!0},carModelPrices:{url:a.urlPrefixDefault+"car_mark/:markId/car_model/:modelId/?fields=prices&year=:year",localStorage:!1,resourceParams:{markId:"@markId",modelId:"@modelId",year:"@year"}},carModifications:{url:v+"car_mark/:markId/car_model/:modelId/car_modification/:id",resourceParams:{markId:"@markId",modelId:"@modelId",id:"@id"}},ownerRegistration:{url:v+"owner-registration",localStorage:!1},exploitationArea:{url:v+"exploitationarea",localStorage:!1,urlForProxy:"/rest/full/exploitation_area/"},creditBank:{url:a.urlPrefixCalc+"bank/",localStorage:!1,urlForProxy:a.urlPrefixCalc+"bank/"},earlierCompany:{urlForProxy:a.urlPrefixCalc+"main_insurance_company/all/",url:a.urlPrefixCalc+"main_insurance_company/all/"},carBody:{url:v+"car-body",localStorage:!1},insuranceDuration:{url:v+"insurance-duration",localStorage:!1,urlForProxy:a.urlPrefixCalc+"insurance_duration/"},contractDurations:{url:a.urlPrefixCalc+"contract_duration/",localStorage:!1},antiThefts:{url:a.urlPrefixDefault+"antitheft/models/",localStorage:!1,urlForProxy:a.urlPrefixDefault+"antitheft/models/"},carType:{url:a.urlPrefixCalc+"car_type/",localStorage:!1,urlForProxy:a.urlPrefixCalc+"car_type/"},contributoryScheme:{url:v+"contributory-scheme",localStorage:!1},paymentForm:{getItems:function(){return r.when([{id:105,title:"Ремонт на СТОА по направлению Страховщика"},{id:107,title:"Официальный дилер"}])}},insCompanyCarModels:{url:a.host+"/car_groups/rest/groups/:id/items/"},deductibleTypes:{url:a.urlPrefixCalc+"deductible_type/",localStorage:!1},targetOfUsing:{url:a.urlPrefixCalc+"target_of_using/",localStorage:!1},coverageConditions:{url:a.urlPrefixCalc+"coverage_condition/",localStorage:!1},optionalEquipments:{url:a.urlPrefixCalc+"optional_equipment/",localStorage:!1},insuranceProductStatus:{url:a.urlPrefix+"deal/insurance-product-status/:id",localStorage:!1},insuranceType:{url:v+"insurance-type"},compensationWithoutReferences:{url:a.urlPrefixCalc+"compensation_without_references/"},deductibleHarmIncident:{url:a.urlPrefixCalc+"deductible_harm_incident/"},omsReceiptRegions:{getItems:function(){return r.when([{id:1,title:"Москва"},{id:2,title:"Московская область"},{id:3,title:"другой"}])}},omsCategories:{getItems:function(){return r.when([{id:1,title:"Дети до 14 лет, являющиеся гражданами РФ",documents:["Свидетельство о рождении","Документ, удостоверяющий личность законного представителя ребенка","Страховое свидетельство обязательного пенсионного страхования – СНИЛС"]},{id:2,title:"Граждане РФ в возрасте 14 лет и старше",documents:["Документ, удостоверяющий личность (паспорт гражданина РФ, временное удостоверение личности гражданина РФ, выдаваемое на период оформления паспорта)","Страховое свидетельство обязательного пенсионного страхования – СНИЛС"]},{id:3,title:"Лица, имеющие право на медицинскую помощь в соответствии с Федеральным законом «О беженцах»",documents:["Удостоверение беженца","Или свидетельство о рассмотрении ходатайства о признании беженцем по существу","Или копия жалобы на решение о лишении статуса беженца в ФМС с отметкой о её приеме к рассмотрению","Или свидетельство о предоставлении временного убежища на территории Российской Федерации"]},{id:4,title:"Иностранные граждане, постоянно проживающие в РФ",documents:["Паспорт иностранного гражданина либо иной документ, установленный федеральным законом или признаваемый в соответствии с международным договором РФ в качестве документа, удостоверяющего личность иностранного гражданина","Вид на жительство","Страховое свидетельство обязательного пенсионного страхования – СНИЛС(при наличии)"]},{id:5,title:"Лица без гражданства, постоянно проживающие в РФ",documents:["Документ, признаваемый в соответствии с международным договором РФ в качестве документа, удостоверяющего личность лица без гражданства","Вид на жительство","Страховое свидетельство обязательного пенсионного страхования – СНИЛС(при наличии)"]},{id:5,title:"Лица без гражданства, временно проживающие в РФ",documents:["Документ, признаваемый в соответствии с международным договором РФ в качестве документа, удостоверяющего личность лица без гражданства, с отметкой о разрешение на временное проживание в РФ","Или документ установленной формы, выдаваемый в Российской Федерации лицу без гражданства, не имеющему документа, удостоверяющего его личность","Страховое свидетельство обязательного пенсионного страхования – СНИЛС (при наличии)"]},{id:6,title:"Представители застрахованного лица",documents:["Документ, удостоверяющий личность","Доверенность на регистрацию в качестве застрахованного лица в выбранной страховой медицинской организации, оформленная в соответствии со статьей 185 части первой ГК РФ"]},{id:7,title:"Законные представители застрахованного лица",documents:["Документ, удостоверяющий личность и (или) документ, подтверждающий полномочия законного представителя"]}])}},omsIssuedFor:{getItems:function(){return r.when([{id:"1",title:"Себя"},{id:"2",title:"Другого лица"}])}},omsDesiredInsuranceCompany:{getItems:function(){return r.when([{id:"1",title:"АО ВТБ Медицинское страхование"},{id:"2",title:"АО «Медицинская Страховая Компания «УралСиб»"},{id:"3",title:"ЗАО «Медицинская акционерная страховая компания» (ЗАО «МАКС-М»)"},{id:"4",title:"ООО «МСК «МЕДСТРАХ»"},{id:"5",title:"АО «Страховая группа «Спасские ворота - М»"},{id:"6",title:"ООО «Страховая медицинская компания РЕСО-МЕД»"},{id:"7",title:"ЗАО Страховая компания «Согласие-М»"},{id:"8",title:"АО «Страховая компания «СОГАЗ-Мед»"},{id:"9",title:"ООО «Страховая компания «Ингосстрах-М»"},{id:"10",title:"ООО «Росгосстрах-Медицина»"}])}},isProlongation:{getItems:function(){var e=r.defer();return this.items=[{title:"Новый",id:!1},{title:"Из предыдущих",id:!0}],e.resolve(this.items),e.promise}},personTypes:{getItems:function(){var e=r.defer();return this.items=[{id:2,title:"Физическое лицо",shortTitle:"Физ. лицо",code:"naturalPerson"},{id:1,title:"Юридическое лицо",shortTitle:"Юр. лицо",code:"legalPerson"}],e.resolve(this.items),e.promise}},policyAreas:{url:a.urlPrefixCalc+"policy_area/",localStorage:!1},driversCountOsagoFull:{getItems:function(){return r.when([{id:1,title:"Один водитель"},{id:2,title:"Два водителя"},{id:3,title:"Три водителя"},{id:4,title:"Четыре водителя"},{id:5,title:"Пять водителей"},{id:6,title:"Шесть водителей"},{id:7,title:"Семь водителей"},{id:8,title:"Восемь водителей"},{id:9,title:"Девять водителей"},{id:10,title:"Десять водителей"},{title:"Без ограничений",id:0}])}},driversCountOsagoSimple:{getItems:function(){return r.when(_.map(_.range(0,11),function(e){return{id:e.toString(),title:e?e.toString():"Мультидрайв"}}))}},enginePower:{getItems:function(){return r.when([{id:1,title:"до 50 вкл.",value:50},{id:2,title:"свыше 50 и до 70 вкл.",value:70},{id:3,title:"свыше 70 и до 100 вкл.",value:100},{id:4,title:"свыше 100 и до 120 вкл.",value:120},{id:5,title:"свыше 120 и до 150 вкл.",value:150},{id:6,title:"свыше 150",value:160}])}},kbm:{getItems:function(){return r.when([{title:"Класс М  (коэф. = 2,45)",id:2.45},{title:"Класс 0 (коэф. = 2,3)",id:2.3},{title:"Класс 1 (коэф. = 1,55)",id:1.55},{title:"Класс 2 (коэф. = 1,4)",id:1.4},{title:"Класс 3 (коэф. = 1)",id:1},{title:"Класс 4 (коэф. = 0,95)",id:.95},{title:"Класс 5 (коэф. = 0,9)",id:.9},{title:"Класс 6 (коэф. = 0,85)",id:.85},{title:"Класс 7 (коэф. = 0,8)",id:.8},{title:"Класс 8 (коэф. = 0,75)",id:.75},{title:"Класс 9 (коэф. = 0,7)",id:.7},{title:"Класс 10 (коэф. = 0,65)",id:.65},{title:"Класс 11 (коэф. = 0,6)",id:.6},{title:"Класс 12 (коэф. = 0,55)",id:.55},{title:"Класс 13 (коэф. = 0,5)",id:.5}])}},driversCount:{getItems:function(){return r.when([{title:"",item_type:"divider",code:"nat"},{title:"Ограниченный список",item_type:"header",code:"nat|active"},{id:1,title:"1 водитель",code:"nat|active"},{id:2,title:"2 водителя",code:"nat|active"},{id:3,title:"3 водителя",code:"nat|active"},{id:4,title:"4 водителя",code:"nat|active"},{id:5,title:"5 водителей",code:"nat|active"},{title:"",item_type:"divider",code:"nat"},{title:"Без ограничений",id:100,code:"nat|leg|active"}])}},document_types:{getItems:function(){return r.when([{id:"Паспорт",title:"Паспорт"},{id:"Иностранный паспорт",title:"Иностранный паспорт"}])}},deductibleValue:{getItems:function(){var e=r.defer();return this.items=[{id:6e3,title:6e3},{id:12e3,title:12e3},{id:2e4,title:2e4},{id:25e3,title:25e3},{id:5e4,title:5e4}],e.resolve(this.items),e.promise}},civilLiabilityVoluntaryCost:{getItems:function(){var e=r.defer();return this.items=[{id:5e5,title:5e5},{id:1e6,title:1e6},{id:15e5,title:15e5}],e.resolve(this.items),e.promise}},paymentTypes:{getItems:function(){return t.when([{title:"Банковская карта",id:"AC",img_name:"visamastercard.png"},{title:"Альфа-Клик",id:"AB",img_name:"alfaclick.jpg"},{title:"Кошелек Яндекс.Денег",id:"PC",img_name:"yandex.png"},{title:"Наличные через терминал",id:"GP",img_name:"qiwi.png"},{title:"Интернет-банк Промсвязьбанка",id:"PB",img_name:"psb.jpg"},{title:"Кошелек WebMoney",id:"WM",img_name:"webmoney.png"}])}},yesNo:{getItems:function(){return r.when([{id:!0,title:"Да"},{id:!1,title:"Нет"}])}},calcTypes:{getItems:function(){return r.when([{id:"simple",title:"Примерный"},{id:"full",title:"Точный (с данными КБМ водителей)"}])}},driversChanging:{getItems:function(){return r.when([{id:1,title:"1 водитель"},{id:2,title:"2 водителя"},{id:3,title:"3 водителя"},{id:4,title:"4 водителя"},{id:0,title:"Без ограничений"}])}},numberType:{getItems:function(){return r.when([{id:"vin_number",title:"VIN"},{id:"car_body_number",title:"Номер кузова"},{id:"chassis_number",title:"Номер шасси"}])}},fuelType:{getItems:function(){return r.when([{id:"Бензин",
title:"Бензин"},{id:"Дизель",title:"Дизель"},{id:"Газ",title:"Газ"}])}},policyStatus:{getItems:function(){var e=r.defer();return this.items=[{id:"saved",title:"Оформление договора",code:"saved"},{id:"payed",title:"Выдан",code:"payed"},{id:"annuled",title:"Аннулирован",code:"annuled"},{id:"issued",title:"Проект договора",code:"issued"},{id:"archived",title:"Архив заключенных договоров",code:"archived"},{id:"onapproval",title:"Требует согласования",code:"onapproval"},{id:"denied",title:"Отклонен",code:"denied"}],e.resolve(this.items),e.promise}},policyActions:{getItems:function(){var e=r.defer();return this.items=[{id:"status_policy",title:"Проверить статус"},{id:"save_policy",title:"Сохранить"},{id:"print_policy",title:"Печать"},{id:"annul_policy",title:"Аннулировать"},{id:"issue_policy",title:"Оформить"}],e.resolve(this.items),e.promise}},transmission:{getItems:function(){return r.when([{id:"Автомат",title:"Автомат"},{id:"Механика",title:"Механика"}])}},driveOfCar:{getItems:function(){return r.when([{id:"Полный",title:"Полный"},{id:"Передний",title:"Передний"},{id:"Задний",title:"Задний"}])}},driverLicenseAccessory:{getItems:function(){return r.when([{id:"РФ",title:"РФ"},{id:"Иное",title:"Иное"}])}},currencies:{getItems:function(){return r.when([{id:"RUB",title:"RUB"},{id:"USD",title:"USD"}])}},insuranceSums:{getItems:function(){return r.when(_.map([1e4,2e4,3e4,4e4,5e4],function(e){return{id:e,title:s("priceFormatter")(e,0)}}))}},adultsCount:{getItems:function(){return r.when(_.map(_.range(1,5),function(e){return{id:e,title:4===e?"4 и более":e}}))}},childrenCount:{getItems:function(){return r.when(_.map(_.range(0,5),function(e){return{id:e,title:4===e?"4 и более":e}}))}},keysCount:{getItems:function(){var e=r.defer();return this.items=_.map(_.range(1,4),function(e){return{id:e,title:e}}),e.resolve(this.items),e.promise}},notificationTypes:{url:a.urlPrefix+"notification/message-type",localStorage:!1},invoiceStatus:{url:a.urlPrefix+"invoice/invoice-status/:id",localStorage:!1},cbmCasco:{url:a.urlPrefixCalc+"cbm_casco/:id",localStorage:!1},osagoLossesCount:{url:a.urlPrefixCalc+"osago_losses_count/:id",localStorage:!1},specialProgram:{url:a.urlPrefixCalc+"special_program/:id",localStorage:!1},carParkSize:{url:a.urlPrefixCalc+"car_park_size/:id",localStorage:!1},prolongations:{url:a.urlPrefixCalc+"prolongation/:id",localStorage:!1},signalizationType:{url:a.urlPrefixCalc+"signalization_type/",localStorage:!1},insurantType:{url:a.urlPrefixCalc+"insurant_type/",localStorage:!1},dealCount:{url:a.urlPrefixCalc+"deal_count/",localStorage:!1},carParkSizeItems:{url:a.urlPrefixCalc+"car_park_size/",localStorage:!1},technicalInspectionType:{url:a.urlPrefixCalc+"technical_inspection_type/",localStorage:!1},osagoRegion:{url:a.urlPrefixCalc+"osago_region/",localStorage:!1},osagoCity:{url:a.urlPrefixCalc+"osago_city/:id",localStorage:!1}};return g=function(t){this.items=[],this.dictName="",this.url="",this.cache=!0,this.localStorage=!1,this.lastUpdate="",this.lifeTime=n,this.resourceParams={id:"@id"},this._loadStack={},e.extend(this,t),this.defaultUrl=d(this.url)},this.localStorage&&null===y.getItem("lastUpdates")&&y.setItem("lastUpdates",e.toJson({})),g.prototype.load=function(t,a){var i,n;return t=t||d(this.url,a),e.isArray(this._loadStack[t])&&this.cache?(i=r.defer(),0===this._loadStack[t].length?i.resolve(this.items[t]):this._loadStack[t].push(i),i.promise):(this.urlForProxy&&(t=this.urlForProxy),n=l[this.urlForProxy?"get":"getOriginal"](t),this.cache&&(this._loadStack[t]=[],this._loadStack[t].push(n)),n.then(function(a){var i=a.data;return this.cache&&(this.items[t]=i,this._loadStack[t].shift(),e.forEach(this._loadStack[t],function(e){e.resolve(i)}),this._loadStack[t].length=0),this.localStorage&&y&&(y.setItem(t,e.toJson(i)),this.setLastUpdate(t)),i}.bind(this),function(a){this.cache&&(this._loadStack[t].shift(),e.forEach(this._loadStack[t],function(e){e.reject(a)}),this._loadStack[t].length=0)}.bind(this)))},g.prototype.setLastUpdate=function(t,a){var i=y.getItem("lastUpdates"),n=e.fromJson(i);a=a||(new Date).getTime(),t=t||this.dictName,i&&(this.lastUpdate=a,n[t]=a,y.setItem("lastUpdates",e.toJson(n)))},g.prototype.getLastUpdate=function(t){t=t||this.dictName;var a=y&&e.fromJson(y.getItem("lastUpdates"));return this.lastUpdate||a&&a[t]},g.prototype.checkLastUpdate=function(e){var t=this.getLastUpdate(e);return!isNaN(parseInt(t,10))&&t+1e3*this.lifeTime>(new Date).getTime()},g.prototype.getItems=function(t){var a,i=e.isObject(t)?d(this.url,t):this.defaultUrl,n=r.defer();return this.cache&&void 0!==this.items[i]?n.resolve(e.copy(this.items[i])):this.localStorage&&this.checkLastUpdate(i)&&(a=y.getItem(i))?(a=e.fromJson(a),this.cache&&(this.items[i]=a),n.resolve(e.copy(a))):this.load(i,t).then(function(t){n.resolve(e.copy(t)||[])},function(e){n.reject(e)}),n.promise},g.prototype.filter=function(e){return this.getItems().then(function(t){return s("filter")(t,e)})},g.prototype.findItem=function(t,a){var i,n=r.defer();return e.isObject(t)&&(i=e.copy(t),t=t.id),this.getItems(i).then(function(e){n.resolve(o(e,t,a))},function(e){n.reject(e)}),n.promise},g.prototype.loadItem=function(t){var a,i=r.defer();return void 0===t||null===t||""===t?i.reject("The params is empty"):((e.isString(t)||e.isNumber(t))&&(t={id:t}),a=d(this.url,t),(e.isString(t)||e.isNumber(t))&&(t={id:t}),l.getOriginal(a).then(function(e){i.resolve(e.data)},function(e){i.reject(e)})),i.promise},w.getItems=function(e){var t,a;try{m(e)}catch(e){console.log(e.message)}return t=Array.prototype.slice.apply(arguments),t.splice(0,1),a=k[e],a.getItems.apply(a,t)},w.findItem=function(e,t,a){var i,n;try{m(e)}catch(e){console.log(e.message)}return i=Array.prototype.slice.apply(arguments),i.splice(0,1),n=k[e],n.findItem.apply(n,i)},w.loadItem=function(e,t){var a,i;try{m(e)}catch(e){console.log(e.message)}return a=Array.prototype.slice.apply(arguments),a.splice(0,1),i=k[e],i.loadItem.apply(i,a)},w.filter=function(e,t){var a,i;try{m(e)}catch(e){console.log(e.message)}return a=Array.prototype.slice.apply(arguments),a.splice(0,1),i=k[e],i.filter.apply(i,a)},e.forEach(i,function(e){w.getItems(e)}),w}],setConstants:function(e){a=e},setLifeTime:function(e){n=e},preload:function(t){if(e.isString(t))return void(i=[t]);e.isArray(t)&&(i=t)}}})}(angular,jQueryApp),function(e){e.module("policyOrdering",[])}(angular),function(e){"use strict";e.module("policyOrdering").controller("policyOrderingCtrl",["$scope","$http","$rootScope","brandingConfigs","policyOrderingService","CONSTS","calculatorService","Dictionary","Messages","$timeout","addingDocumentsService","$filter","calculatorStepsService","formationPolicyService","letterService",function(e,t,a,i,n,r,s,l,c,o,d,u,p,m,g){e.carInfo={},e.policyInfo={};var v=s.calculation,f=v&&v.id||9093963,h=(s.calculatorOtherParams,["Бесплатная доставка в течение 2-х дней","Бесплатная доставка день в день","Доставка в течение 2-х дней (стоимость 500р.)"]),b=["Время доставки:","Примерное время доставки:"],y=["Оформление в офисе","Оформление в офисе - г. Санкт-Петербург, ул. Белоостровская, 22, офис 507"];e.omsDesiredInsuranceCompany=l.getItems("omsDesiredInsuranceCompany"),e.omsIssuedFor=l.getItems("omsIssuedFor"),e.policyOrderingInProgress=!1,e.optionsIsOpened=!1,e.disableOrderBtn=!1,e.root={},e.params={disableFormFields:!1,deliveryTypeTitle:h[a.currentBrand.delivery_type_title_index||0],deliveryTimeTitle:b[a.currentBrand.delivery_time_title_index||0],deliveryInOfficeTitle:y[a.currentBrand.delivery_in_office_title_index||0]},e.selectedResult=s.getSelectedResult(),e.dictionaryTitles={},e.formFields=n.defaultFormFields,a.currentBrand.with_agreement_on_ordering||(e.formFields.client_is_agree=!0);var w=a.currentBrand.default_data?a.currentBrand.default_fields.fourth_step:{};for(var k in w)e.formFields["_"+k]=w[k];e.setIssuedForTitle=function(t){e.omsIssuedFor.then(function(a){e.formFields.issued_for=_.find(a,function(e){return e.id===t})})},e.setDesiredInsuranceCompanyTitle=function(t){e.omsDesiredInsuranceCompany.then(function(a){e.formFields.desired_company=_.find(a,function(e){return e.id===t})})},e.calculation=v,e.calculationInterParams=p.calculationInterParams,e.getFullDiscount=p.getFullDiscount,e.sumOfDiscounts=e.getFullDiscount(!0),e.selectedResult&&(e.policy_price=e.selectedResult.sumWithKBM||e.selectedResult.programSum||e.selectedResult.program.sum),a.currentBrand.disable_discount||(e.policy_price_with_discount=Number(e.policy_price)*(100-Number(e.sumOfDiscounts))/100),e.templates={navigation:r.pathToModules+"shared/calculator/views/navigation.html",policy_info:i.templates.policy_info||r.pathToModules+"shared/carFilter/views/policy_info.html"},e.getSelectedResult=function(){return e.root.selectedResult=s.getSelectedResult(),e.root.selectedResult},e.sendOrderLetter=n.sendOrderLetter,e.sendOmsOrderLetter=function(){n.sendOmsOrderLetter(e.formFields)},e.orderPolicy=function(){e.sendOrderLetter(),e.params.orderButton=!0},e.sendPolicyOrdering=function(i){if(console.log("$scope",e),a.currentBrand.useCRM){var r=new FormData,o=(e.formFields.client_name||"").split(" ");return r.append("TITLE","КАСКО модуль"),r.append("COMPANY_TITLE",s.selectedResult.insurance_company.title),r.append("CURRENCY_ID","RUB"),r.append("OPPORTUNITY",e.selectedResult.program.sum_with_discount),r.append("PHONE_MOBILE",e.formFields.client_phone),r.append("NAME",o[0]||""),r.append("LAST_NAME",o[1]||""),r.append("COMMENTS","Какие то комментарии"),r.append("PRODUCT_ID","КАСКО"),r.append("UF_CRM_1518447933",s.calculation.car_manufacturing_year),r.append("UF_CRM_1518188485",p.carAllSelected.carMark.title),r.append("UF_CRM_1518188585",p.carAllSelected.carModel.title),r.append("UF_CRM_1518447856",p.carAllSelected.carModelGroup.title),r.append("UF_CRM_1518447739",p.calculationInterParams.exploitation_area_title),r.append("UF_CRM_1518448100",e.calculationInterParams.car_cost),r.append("UF_CRM_1518448110",e.calculationInterParams.mileage),r.append("UF_CRM_1518448124",p.calculationInterParams.engine_power),r.append("UF_CRM_1518448257",s.calculation.calculation_at_date),r.append("UF_CRM_1518449804",e.calculationInterParams.drivers[0].age),r.append("UF_CRM_1518449827",e.calculationInterParams.drivers[0].expirience),r.append("UF_CRM_1518449854",e.calculationInterParams.drivers[0].gender),r.append("UF_CRM_1519220145",s.calculation.driver_set.length),r.append("UF_CRM_1518450063",_.get(e,"$root.crm.deductibleValue")),r.append("UF_CRM_1518450105",e.calculationInterParams.car_cost),r.append("UF_CRM_1518450146",_.get(e,"$root.crm.antithefts.title")||"Нет"),r.append("UF_CRM_1518450211",s.calculation.is_credit?"Да":"Нет"),r.append("UF_CRM_1518450264",e.calculation.count_years_break_even_insurance?"Нет":"Да"),r.append("UF_CRM_1518450428",_.get(e,"$root.crm.paymentForm.title")||"Нет"),r.append("UF_CRM_1519743837","delivery"==e.formFields.receipt_type?"Доставка":"В офисе"),r.append("UF_CRM_1519743858","delivery"==e.formFields.receipt_type?e.formFields.delivery_address:""),r.append("UF_CRM_1519743905","delivery"!=e.formFields.receipt_type?e.formFields.arrival_date:""),r.append("UF_CRM_1519743921","delivery"!=e.formFields.receipt_type?e.formFields.arrival_time.match(/(\d{2})/g).join(":"):""),console.log(Array.from(r.entries()),e.formFields),t({method:"POST",url:AngularAppConfig.proxyPath+"crm/index.php",headers:{"Content-Type":void 0},data:r})}if(a.currentBrand.old_module)return n.sendOrderLetter();var m=_.compatibleFormData();e.params.disableFormFields=!0,e.policyOrderingInProgress=!0,m.append("client_name",e.formFields.client_name||v.client_name),m.append("client_phone",e.formFields.client_phone||v.client_phone),(e.formFields.client_mail||v.client_mail)&&m.append("client_mail",e.formFields.client_mail||v.client_mail),(e.formFields.payment_type||v.payment_type)&&m.append("payment_type",e.formFields.payment_type||v.payment_type),m.append("calculation_id",s.calculation.id),m.append("selected_company",e.selectedResult.insurance_company.title);var f="fake_result_hack"!==e.selectedResult.id?e.selectedResult.id:"";m.append("selected_result_id",f),m.append("policy_price",u("priceFormatter")(e.selectedResult.program.sum,2)),a.currentBrand.disable_discount||(m.append("policy_price_with_discount",u("priceFormatter")(e.selectedResult.program.sum_with_discount,2)),m.append("policy_discount",e.sumOfDiscounts)),m.append("car_mark",e.carInfo.carMark.title),m.append("car_model_group",e.carInfo.carModelGroup.title),m.append("car_model",e.carInfo.carModel.title),m.append("car_manufacturing_year",v.car_manufacturing_year),m.append("car_engine_power",v.engine_power),a.currentBrand.hidden_in_mail&&-1!==a.currentBrand.hidden_in_mail.indexOf("car_cost")||m.append("car_price",u("priceFormatter")(e.calculationInterParams.car_cost,2)),m.append("is_miltidrive",v.is_multidrive),v.is_multidrive?(m.append("drivers_minimal_age",v.drivers_minimal_age),m.append("drivers_minimal_experience",v.drivers_minimal_experience)):m.append("drivers_set",JSON.stringify(v.driver_set)),v.deductible_value&&m.append("deductible_value",v.deductible_value),v.antitheft&&l.getItems("antiThefts").then(function(e){var t=_.find(e.results,function(e){return e.id===Number(v.antitheft)});t&&t.title&&m.append("antitheft",t.title)}),v.car_cost&&m.append("car_cost",u("priceFormatter")(v.car_cost,2)),v.is_credit&&m.append("is_credit",v.is_credit?"Да":"Нет"),v.count_years_break_even_insurance&&m.append("count_years_break_even_insurance",0===v.count_years_break_even_insurance?"Нет":"Да"),v.with_repair&&l.getItems("paymentForm").then(function(e){var t=_.find(e.results,function(e){return e.id===Number(v.with_repair)});t&&t.title&&m.append("with_repair",t.title)}),m.append("receipt_type","delivery"===e.formFields.receipt_type?"Доставка":"Получение в офисе"),"delivery"===e.formFields.receipt_type?(m.append("delivery_address",e.formFields.delivery_address),e.formFields.delivery_date&&""!==e.formFields.delivery_date&&m.append("delivery_date",e.formFields.delivery_date),e.formFields.delivery_time&&""!==e.formFields.delivery_time&&m.append("delivery_time",e.formFields.delivery_time)):(m.append("arrival_date",e.formFields.arrival_date),m.append("arrival_time",u("formatTime")(e.formFields.arrival_time))),m.append("owner_registration_title",e.calculationInterParams.owner_registration_title),m.append("program_sum",u("priceFormatter")(e.selectedResult.program.sum,2));return m.append("moduleType",a.currentModuleType),m.append("isHTML",!0),d.uploader&&_.forEach(d.uploader.queue,function(e,t){m.append("file_"+t,e._file)}),(a.currentBrand.sendMailByRequest?g.sendViaApi(""):d.send(m)).then(function(){e.policyOrderingInProgress=!1,"laura"==a.currentBrandName||"kaska24"==a.currentBrandName||"broker-kapital"==a.currentBrandName||"sbaru"==a.currentBrandName?(c.success('Ваш заказ принят, в ближайшее время с вами свяжется наш специалист для подтверждения заказа. Если вы желаете рассчитать стоимость страхования для другого автомобиля, то нажмите "Рассчитать Каско" или "Рассчитать ОСАГО"'),e.disableOrderBtn=!0):(e.disableOrderBtn=!0,"a24"===a.currentBrandName&&v.client_mail?c.success("Расчет отправлен Вам на почту.",3e3):c.success("Ваш заказ принят. Мы свяжемся с вами в ближайшее время.",3e3))},function(){c.error("Не удалось отправить запрос.",6e3),e.policyOrderingInProgress=!1})},e.toPayment=function(){s.clientInfo.client_phone=e.formFields.client_phone,c.success("Ваш заказ принят. Мы свяжемся с вами в ближайшее время.",6e3),e.formFields=n.defaultFormFields,p.bigSteps.setBigStep("fifth")},e.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},e.paymentType=["Наличными","Банковской картой","Денежным переводом"],"kaska24"!=a.currentBrandName&&"broker-kapital"!=a.currentBrandName||(e.paymentType=e.paymentType.concat(["Наличными курьеру","Банковской картой курьеру"])),s.getCalculation(f).then(function(t){e.calculation=t,l.getItems("carModelGroups",{car_mark:t.car_mark}).then(function(a){e.carInfo.carModelGroup=_.find(a.results,function(e){return e.id==t.car_model_group})}),l.getItems("ownerRegistration").then(function(t){var a=_.find(t.results,function(t){return t.id==e.calculation.owner_registration});a&&(e.carInfo.owner_registration_title=a.title)}),l.getItems("contributoryScheme").then(function(t){var a=_.find(t.results,function(t){return t.id==e.calculationInterParams.contributory_scheme});a&&(e.policyInfo.contributory_scheme=a.title)}),l.getItems("paymentForm").then(function(t){var a=_.find(t.results,function(t){return t.id==e.calculationInterParams.payment_form});a&&(e.policyInfo.payment_form=a.title)}),l.getItems("insuranceDuration").then(function(a){var i=_.find(a.results||a,function(e){return e.id==t.insurance_duration});i&&(e.policyInfo.insurance_duration=i.title)}),l.getItems("carType").then(function(t){var a=_.find(t.results||t,function(t){return t.id==e.calculationInterParams._car_type});a&&(e.policyInfo.carType=a.title)}),l.getItems("enginePower").then(function(t){var a=_.find(t.results||t,function(t){return t.id==e.calculationInterParams.engine_power_id});a&&(e.policyInfo.enginePower=a.title)}),l.getItems("carMarks",{id:t.car_mark}).then(function(t){t=t.results?t.results:t,e.carInfo.carMark=t}),l.getItems("carModels",{id:t.car_model}).then(function(t){t=t.results?t.results:t,e.carInfo.carModel=t}),t.insured_object&&m.getInsuredObject(t.insured_object).then(function(t){e.carInfo.drivers=t.drivers})}),s.getResult(f).then(function(t){e.calculationResult=t,e.selectedResult=e.selectedResult||t})}])}(angular),function(e){"use strict";e.module("policyOrdering").directive("policyOrdering",["$rootScope","calculatorService","policyOrderingService","CONSTS",function(e,t,a,i){return{restrict:"A",templateUrl:_.get(e.currentBrand,"templates.fast")||i.pathToModules+"shared/policyOrdering/views/policy_ordering.fast.html",link:function(e){e.poParams=a.poParams={receipt_type:"delivery"},e.sendLetter=function(){a.sendLetterUsago().then(function(){e.selectResult&&e.selectResult(null)})},e.clientParams.client_name=e.clientParams.client_name||e.calculation.client_name,e.clientParams.client_phone=e.clientParams.client_phone||e.calculation.client_phone,e.clientParams.sms_is_visible=!1}}}])}(angular),function(e){"use strict";e.module("policyOrdering").directive("policyOrderingFull",["calculatorService",function(e){return{restrict:"A",link:function(t){t.result=e.result}}}])}(angular),function(e){"use strict";e.module("policyOrdering").service("policyOrderingService",["calculatorStepsService","calculatorService","letterService","addingDocumentsService","$q","Dictionary","Messages","$rootScope","$filter","formationPolicyService","CONSTS","$http",function(t,a,i,n,r,s,l,c,o,d,u,p){function m(e){return o("date")(e,"dd.MM.yyyy")}function g(e){return o("formatTime")(e)}function v(e){return p({method:"post",url:u.proxyUrl+"/sendmail",headers:{"Content-Type":"application/json"},data:{content:e,brand:c.currentBrandName}})}var f=a.calculation;this.defaultFormFields={payment_type:"Наличными",receipt_type:c.currentBrand.without_delivery_on_ordering?"office":"delivery",client_phone:"",client_name:"",delivery_date:"",delivery_time:"",delivery_address:"",arrival_date:"",arrival_time:"",client_is_agree:!1},this.sendOmsOrderLetter=function(e){var a="",i=_.compatibleFormData();return a+="Телефон: "+e.client_phone,a+="\nEmail: "+e.client_email,a+="\nКлиент хочет оформить полис для "+e.issued_for.title,a+="\nЖелаемая страховая компания: "+e.desired_company.title,a+="\nМесто получения полиса: "+t.calculationInterParams.receipt_region.title,a+=d.orderMessage,i.append("moduleType",c.currentModuleType),i.append("message",a),n.uploader&&!c.isIE&&_.forEach(n.uploader.queue,function(e,t){i.append("file_"+t,e._file)}),n.send(i).then(function(){var e="Заявка оформлена успешно. В ближайшее время с Вами свяжется специалист нашей компании.";c.currentBrand.feedback_phone&&(e+="\nЕсли у Вас возникли вопросы - позвоните по телефону "+c.currentBrand.feedback_phone),l.success(e,0)},function(){l.error("Не удалось отправить запрос.",6e3)})},this.sendLetterUsago=function(t){var d={},u=a.calculation,p=a.result,v=_.compatibleFormData(),f=this;return d.ownerRegistration=s.getItems("ownerRegistration").then(function(e){return _.find(e.results,function(e){return e.id===Number(u.owner_registration)})}),r.all(d).then(function(r){if(v.append("client_name",u.client_name),v.append("client_phone",u.client_phone),u.client_mail&&v.append("client_mail",u.client_mail),u.payment_type&&v.append("payment_type",u.payment_type),t||(v.append("selected_company",p.insurance_company.title),v.append("policy_price",o("priceFormatter")(p.program.sum,2))),r.ownerRegistration&&v.append("owner_registration",r.ownerRegistration.title),u.engine_power&&v.append("engine_power",u.engine_power),u.calculation_at_date&&v.append("calculation_at_date",m(u.calculation_at_date)),u.insured_object){var s=e.extend([],a.drivers);_.forEach(s,function(e){e.birth_date=m(e.birth_date),e.driving_experience_started=m(e.driving_experience_started)}),v.append("drivers_set",JSON.stringify(s)),a.car&&a.car.vin_number&&(v.append("car_vin_number",a.car.vin_number),v.append("car_number_plate",a.car.number_plate),v.append("car_document_series",a.car.document_series),v.append("car_document_number",a.car.document_number),v.append("car_document_issue_date",m(a.car.document_issue_date)));var d=e.extend([],a.persons);_.forEach(d,function(e){"legal_person"!==e.personType&&(e.birth_date=m(e.birth_date),(e.isInsurant||e.isOwner)&&(e.passport.issue_date=m(e.passport.issue_date)))}),v.append("persons_set",JSON.stringify(d))}else v.append("drivers_set",JSON.stringify(u.driver_set));if(!t){var h="delivery"===f.poParams.receipt_type;v.append("receipt_type",h?"Доставка":"Получение в офисе"),h?f.poParams.delivery_address&&v.append("delivery_address",f.poParams.delivery_address):(v.append("arrival_date",m(f.poParams.arrival_date)),v.append("arrival_time",g(f.poParams.arrival_time)))}v.append("isBeforeOrder",t),v.append("moduleType",c.currentModuleType),v.append("isHTML",!0);var b=c.currentBrand.sendMailByRequest?i.sendViaApi(""):i.send(v);return n.uploader&&!c.isIE&&_.forEach(n.uploader.queue,function(e,t){v.append("file_"+t,e._file)}),b.then(function(){t||l.success("Ваш запрос на оформление полиса отправлен.",5e3)}).catch(function(e){throw t||l.error("Не удалось отправить запрос.",5e3),e})})}.bind(this);var h=this.sendOrderLetter=function(){var e="",r=_.compatibleFormData(),s=a.getSelectedResult(),u=t.carAllSelected,p={name:f.client_name||c.clientDataForMail.name,phone:f.client_phone||c.clientDataForMail.phone};p.name&&(e+="Имя : "+p.name+"\n"),p.phone&&(e+="Телефон : "+p.phone+"\n"),f.id&&(e+="Номер расчета: "+f.id+"\n"),s&&s.insurance_company&&(e+="Выбранная страховая компания: "+s.insurance_company.title+" ("+s.id+")\n\n"),c.currentBrand.link_to_registration_in_email&&f.id&&(e+="Ссылка на оформление: http://enter.b2bpolis.ru/#/calculator/"+f.id),e+="\n",e+="Автомобиль: "+u.carMark.title+" ",e+=u.carModelGroup.title+" ",e+=u.carModel.title+" ",e+=f.car_manufacturing_year+" г. выпуска, ",e+=f.engine_power+" л.с. \n",e+="Куплен в кредит: "+(f.is_credit?"да":"нет")+"\n",e+="\n",f.is_multidrive?(e+="Минимальный возраст: "+f.drivers_minimal_age,e+="Минимальный стаж: "+f.drivers_minimal_experience,e+="\n"):_.forEach(f.driver_set,function(t,a){if(e+=a+1+"-й водитель возраст: "+t.age+" стаж: "+t.expirience+"\n",e+="Пол: "+("F"===t.gender?"Женский":"Мужской")+"\n",c.currentBrand.without_children_and_marriage_in_main||(e+="В браке: "+(t.is_married?"да":"нет")+"\n",e+="Дети: "+(t.has_children?"да":"нет")+"\n"),c.clientDataForMail.drivers){var i=c.clientDataForMail.drivers[a];e+="ФИО: "+(i.last_name||"")+" "+(i.first_name||"")+" "+(i.patronymic||"")+"\n",e+="Серия и номер водит. удостоверения: "+i.license.series+" "+i.license.number+"\n",console.log("message",e)}e+="\n"}),s&&s.program&&(e+="Страховая премия: "+o("priceFormatter")(s.program.sum,2)+" рублей \n\n"),e+="\n",r.append("moduleType",c.currentModuleType),d.personalData&&(e+="\n"+d.personalData),r.append("message",e),r.append("exploitationAreaTitle",t.calculationInterParams.exploitation_area_title),n.uploader&&!c.isIE&&_.forEach(n.uploader.queue,function(e,t){r.append("file_"+t,e._file)});var m=c.currentBrand.sendMailByRequest?i.sendViaApi(e):n.send(r);return console.log("sendLetter",m),m.then(function(){l.success("Ваш заказ принят. Мы свяжемся с вами в ближайшее время.",6e3),c.orderSending=!0},function(){l.error("Не удалось отправить запрос.",6e3)})};this.sendMailByRequest=v,this.sendLetterBeforeOrder=function(){if(c.currentBrand.old_module)return h();var e=[];e.__proto__.addRow=function(e,t){var a="<div><b>"+e+": </b>"+t+"</div>";this.push(a)};var r=_.compatibleFormData(),d=t.carAllSelected,u=c.clientDataForMail.name||t.calculationInterParams.client_name||f.client_name,m=c.clientDataForMail.phone||t.calculationInterParams.client_phone||f.client_phone,g=f.client_mail||t.calculationInterParams.client_mail;if(u&&r.append("client_name",u),m&&r.append("client_phone",m),g&&r.append("client_mail",g),f.id&&r.append("calculation_id",f.id),r.append("car_mark",d.carMark.title),r.append("car_model_group",d.carModelGroup.title),r.append("car_model",d.carModel.title),r.append("car_manufacturing_year",f.car_manufacturing_year),r.append("car_engine_power",f.engine_power),c.currentBrand.hidden_in_mail&&-1!==c.currentBrand.hidden_in_mail.indexOf("car_cost")||r.append("car_price",o("priceFormatter")(f.car_cost,2)),r.append("is_miltidrive",f.is_multidrive),c.currentBrand.with_sms_before_calculate&&"full"===t.calculationInterParams.calculation_type?r.append("drivers_set",JSON.stringify(a.rsaVerifiedDrivers)):f.is_multidrive?(r.append("drivers_minimal_age",f.drivers_minimal_age),r.append("drivers_minimal_experience",f.drivers_minimal_experience)):r.append("drivers_set",JSON.stringify(f.driver_set)),f.car_cost&&r.append("car_cost",o("priceFormatter")(f.car_cost,2)),f.is_credit&&r.append("is_credit",f.is_credit?"Да":"Нет"),f.credit_bank&&r.append("credit_bank",f.credit_bank),f.calculation_at_date&&r.append("calculation_at_date",f.calculation_at_date),f.with_repair&&s.getItems("paymentForm").then(function(e){var t=_.find(e.results,function(e){return e.id===Number(f.with_repair)});t&&t.title&&r.append("with_repair",t.title)}),t.calculationInterParams.exploitation_area_title&&r.append("owner_registration_title",t.calculationInterParams.exploitation_area_title),r.append("isBeforeOrder",!0),r.append("addressType","beforeOrder"),r.append("moduleType",c.currentModuleType),r.append("isHTML",!0),c.currentBrand.sendMailByRequest)return i.sendViaApi(e.join("")||"");if("attiks"===c.currentBrandName){r.append("power",t.calculationInterParams.engine_power),r.append("mess","Предварительная"),r.append("fullRequest","true"),r.append("probeg",t.calculationInterParams.mileage||""),r.append("franchisa_rub","15000");var v="Предварительная";f.id&&(v+=" https://enter.b2bpolis.ru/#/calculator/"+f.id),r.append("mess",v),p({method:"POST",url:AngularAppConfig.proxyPath+"holding_dom/index.php",headers:{"Content-Type":void 0},data:r})}return e.addRow("Имя клиента",u),e.addRow("Телефон клиента",m),g&&e.addRow("E-mail клиента",g),e.push("<p></p>"),t.calculationInterParams.exploitation_area_title&&e.addRow("Регион",t.calculationInterParams.exploitation_area_title),e.addRow("Авто",d.carMark.title+" "+d.carModelGroup.title+"  - "+d.carModel.title+" "+f.car_manufacturing_year+" г.в. "+f.engine_power+" л.с. "),c.currentBrand.hidden_in_mail&&-1!==c.currentBrand.hidden_in_mail.indexOf("car_cost")||e.addRow("Стоимость",o("priceFormatter")(f.car_cost,2)),e.addRow("Мультидрайв",+f.is_multidrive?"Да":"Нет"),c.currentBrand.with_sms_before_calculate&&"full"===t.calculationInterParams.calculation_type?(e.addRow("Водители",""),a.rsaVerifiedDrivers.forEach(function(t){e.addRow("&emsp;Возраст",t.age),e.addRow("&emsp;Стаж",t.expirience),e.addRow("&emsp;Пол",t.gender),e.addRow("&emsp;Дата рождения",t.birth_date),e.addRow("&emsp;Дата начала стажа",t.driving_experience_started),e.addRow("&emsp;Женат / замужем",t.is_married?"Да":"Нет"),e.addRow("&emsp;Есть дети",t.has_children?"Да":"Нет"),e.addRow("&emsp;Есть дети",t.has_children?"Да":"Нет"),e.push("")})):f.is_multidrive?e.addRow("Минимальный возраст / стаж",f.drivers_minimal_age+"/"+f.drivers_minimal_experience):(e.addRow("Водители",""),f.driver_set.forEach(function(t){e.addRow("&emsp;Возраст",t.age),e.addRow("&emsp;Стаж",t.expirience),e.addRow("&emsp;Пол",t.gender),e.addRow("&emsp;Дата рождения",t.birth_date),e.addRow("&emsp;Дата начала стажа",t.driving_experience_started),e.addRow("&emsp;Женат / замужем",t.is_married?"Да":"Нет"),e.addRow("&emsp;Есть дети",t.has_children?"Да":"Нет"),e.addRow("&emsp;Есть дети",t.has_children?"Да":"Нет"),e.push("")})),r.append("message","<div>"+e.join("")+"</div>"),n.send(r).then(function(){if(c.currentBrand.beforeOrderMessage){var e=c.currentBrand.beforeOrderMessage;l.success(e,4e3)}},function(){l.error("Не удалось отправить запрос.",4e3)})},this.sendLetterBeforeOrderWithPUS=function(e){var i="",r=_.compatibleFormData(),s=a.getSelectedResult(),d=t.carAllSelected;return f.client_name&&(i+="Имя: "+f.client_name+"\n"),f.client_phone&&(i+="Телефон : "+f.client_phone+"\n"),"fake_result_hack"!==s.id&&(i+="Номер расчета: "+f.id+"\n"),i+="Выбранная страховая компания: "+s.insurance_company.title+" ("+s.id+")\n\n",c.currentBrand.link_to_registration_in_email&&f.id&&(i+="Ссылка на оформление: http://enter.b2bpolis.ru/#/calculator/"+f.id),i+="\n",i+="Автомобиль: "+d.carMark.title+" "+d.carModelGroup.title+" "+d.carModel.title+" "+f.car_manufacturing_year+" г. выпуска, "+f.engine_power+" л.с. \n",f.is_credit&&(i+="Куплен в кредит: "+(f.is_credit?"да":"нет")+"\n"),i+="\n",f.is_multidrive?(i+="Минимальный возраст: "+f.drivers_minimal_age,i+="Минимальный стаж: "+f.drivers_minimal_experience,i+="\n"):_.forEach(f.driver_set,function(e,t){i+=t+1+"-й водитель \n",e.age&&(i+="возраст: "+e.age+"\n"),e.expirience&&(i+="стаж: "+e.expirience+"\n"),i+="Пол: "+("F"==e.gender?"Женский":"Мужской")+"\n",i+="В браке: "+(e.is_married?"да":"нет")+"\n",i+="Дети: "+(e.has_children?"да":"нет")+"\n",i+="\n"}),i+="\n",e?(i+="ПУС: BackSpacePro",i+="\n",i+="Стоимость полиса:"+o("priceFormatter")(.83*s.program.sum,2)+" рублей \n\n"):(s.PUS_title&&(i+="ПУС: ",i+=s.PUS_title,i+="\n"),i+="\n",i+="Стоимость полиса:"+o("priceFormatter")(s.program.sum,2)+" рублей \n\n"),r.append("exploitationAreaTitle",t.calculationInterParams.exploitation_area_title),r.append("addressType","beforeOrder"),r.append("moduleType",c.currentModuleType),r.append("message",i),c.currentBrand.sendMailByRequestAfterSms?v(i):n.send(r).then(function(){l.success("Ваш заказ принят. Мы свяжемся с вами в ближайшее время.",5e3)},function(){l.error("Не удалось отправить запрос.",4e3)})}}])}(angular),function(e){e.module("priceFormatter",[])}(angular),function(e,t){"use strict";e.module("priceFormatter").directive("priceFormatter",["$filter",function(e){function a(e){if(!e.selectionStart&&document.selection){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""===t.text?e.value.length:e.value.lastIndexOf(t.text)}return e.selectionStart}function i(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()}return e}return{restrict:"A",require:"^ngModel",link:function(n,r,s,l){var c=s.priceFormatter||0,o=/[^0-9]/g;c&&(o=/[^0-9.]/g),r=t(r),l.$parsers.push(function(t){var n,s,l,d=t.replace(o,""),u=r.val().length,p=r.get(0);return t?(n=a(p),l=e("priceFormatter")(d,c,".",!0,!0)||"0",r.val(l),s=r.val().length,i(p,n+(s-u)),d):t=0}),l.$formatters.push(function(t){return e("priceFormatter")(t,c,".",!0,!0)})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("priceFormatter").filter("priceFormatter",[function(){var e=function(e,t,a,i,n){if(t=t||0,i=i||".",a=a||" ",
0===t&&isNaN(parseInt(e,10))||isNaN(parseFloat(e)))return"";if(0===parseInt(e,10))return 0;var r,s,l,c=e<0?"-":"",o=e.toString().replace(/\s/g,"").replace(/^0+/g,"").split("."),d=o[0],u=!!t&&o[1],p=d.length>3?d.length%3:0;return n&&o[1]&&0===parseInt(o[1],10)&&(u=!1),t&&e===o[0]+"."&&(u=!0),u&&o[1].length>t&&(o[1]=o[1].substr(0,t)),r=p?d.substr(0,p)+a:"",s=d.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+a),l=u?i+o[1]:"",r||s||(r="0"),c+r+s+l};return function(t,a,i,n,r){return a=a||0,i=i||",",r="string"==typeof r?r:" ",e(t,a,r,i,n)}}])}(angular),function(e){e.module("inputOnly",[])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputCapitalize",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,i){var n=function(e){void 0===e&&(e="");var t=e.toUpperCase();return t!==e&&(i.$setViewValue(t),i.$render()),t};i.$parsers.push(n),n(e[a.ngModel])}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputFloat",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,i){var n=a.maxPrecision?+a.maxPrecision+1:null;i.$parsers.push(function(e){var t,a="";if(""===e||void 0===e||null===e)return e;var r=(e+"").replace(/[^0-9.,]/g,"");return r=r.replace(",","."),r=r.replace(/(\.[0-9]*)(\.+)/g,"$1"),r=r.replace(/^\./g,""),n&&-1!==(t=r.indexOf("."))&&(a=r.substr(t),a.length>n&&(r=r.slice(0,n-a.length))),r!=e&&(i.$setViewValue(r),i.$render()),r})}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputInteger",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,i){i.$parsers.push(function(e){var t;return""===e||void 0===e||null===e?e:(t=(e+"").replace(/[^0-9]/g,""),t!=e&&(i.$setViewValue(t),i.$render()),t)})}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputOnly",[function(){return{restrict:"A",priority:2,require:"ngModel",link:function(e,t,a,i){var n=new RegExp(a.inputOnly,"g");n&&i.$parsers.push(function(e){var t,a="";return""===e||void 0===e||null===e?e:(t=(e+"").match(n),t&&(a=t.join("")),a!=e&&(i.$setViewValue(a),i.$render()),a)})}}}])}(angular),function(e,t){"use strict";e.module("inputOnly").directive("inputPhone",["$timeout",function(e){function a(e){if(!e.selectionStart&&document.selection){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""===t.text?e.value.length:e.value.lastIndexOf(t.text)}return e.selectionStart}function i(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()}return e}return{restrict:"A",require:"ngModel",link:function(n,r,s,l){var c,o=/\+7\(\d{0,3}\)[\d]{0,3}-[\d]{0,4}/;r=t(r),l.$parsers.push(function(t){var n,s,d,u=r.get(0);return null===t&&(t=""),n=o.exec(t+""),n=n?n[0]:c||"+7()-",c=n,s=a(u),"+7()-"===n&&(d=3),6===s&&(d=7),10===s&&(d=11),11===s&&c.length>=n.length&&(d=10),7===s&&c.length>=n.length&&(d=6),void 0!==d&&e(function(){i(u,d)},0),n!=t&&(l.$setViewValue(n),l.$render()),n}),r.focus(function(){t(this).val()||(l.$setViewValue("+7()-"),l.$render(),n.$apply(function(){e(function(){i(r.get(0),3)},0)}))})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("inputOnly").directive("inputReplace",[function(){return{priority:1e4,restrict:"A",require:"ngModel",link:function(t,a,i,n){var r=t.$eval(i.inputReplace);if(!e.isObject(r))throw new Error("input-replace is not a object!");n.$parsers.push(function(t){if(""===t||void 0===t||null===t)return t;var a=t;return e.forEach(r,function(e,t){a=a.replace(new RegExp(t,"g"),e)}),a!=t&&(n.$setViewValue(a),n.$render()),a})}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputVinNumber",["vinNumberService",function(e){return{restrict:"A",require:"ngModel",link:function(t,a,i,n){var r=e.mappedAlph;n.$parsers.push(function(t){var i,s;if(""===t||void 0===t||null===t)return t;i=t.split("");for(var l=0,c=i.length;c>l;l++)for(var o in r)r.hasOwnProperty(o)&&r[o]===i[l]&&(i[l]=o);return i=i.join("").toUpperCase().replace(/[^0-9A-HJ-NPR-Z]/g,""),i!==t&&(n.$setViewValue(i),n.$render()),s=e.vinIsValid(i),a[s?"removeClass":"addClass"]("js-vin-is-invalid"),a.parent()[s?"removeClass":"addClass"]("js-vin-is-invalid"),i})}}}])}(angular),function(e){"use strict";e.module("inputOnly").service("vinNumberService",[function(){function e(e){for(var t={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:0},a=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],i=0,n=0;n<e.length;n++)i+=t[e[n]]*a[n];var r=i%11;return 10==r&&(r="X"),r==e[8]}function t(t){var a=new RegExp("^[a-hj-npr-z0-9]{8}[0-9xX][a-hj-npr-z0-9]{8}$","i");return null!==t.match(a)&&e(t)}return{vinIsValid:t,mappedAlph:{q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",W:"Ц",E:"У",R:"К",T:"Е",Y:"Н",U:"Г",I:"Ш",O:"Щ",P:"З",A:"Ф",S:"Ы",D:"В",F:"А",G:"П",H:"Р",J:"О",K:"Л",L:"Д",Z:"Я",X:"ч",C:"С",V:"М",B:"И",N:"Т",M:"Ь"}}}])}(angular),function(e){e.module("ngThumb",[])}(angular),function(e){"use strict";e.module("ngThumb").directive("ngThumb",["$window","ngThumb",function(t,a){var i={support:!(!t.FileReader||!t.CanvasRenderingContext2D),isFile:function(a){return e.isObject(a)&&a instanceof t.File},isImage:function(e){return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf("|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|")},isPdf:function(e){return-1!=="|pdf|".indexOf("|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|")}},n=a.pdfIcon;return{restrict:"A",template:"<canvas/>",link:function(e,t,a){function r(e){var t=new Image;t.onload=s,t.src=i.isPdf(l.file)?n:e.target.result}function s(){var e=l.width||this.width/this.height*l.height,t=l.height||this.height/this.width*l.width;c.attr({width:e,height:t}),c[0].getContext("2d").drawImage(this,0,0,e,t)}if(i.support){var l=e.$eval(a.ngThumb);if(i.isFile(l.file)&&(i.isImage(l.file)||i.isPdf(l.file))){var c=t.find("canvas"),o=new FileReader;o.onload=r,o.readAsDataURL(l.file)}}}}}])}(angular),function(e,t){"use strict";e.module("ngThumb").provider("ngThumb",function(){var e="";return{$get:[function(){return{pdfIcon:e}}],setPdfIcon:function(t){e=t}}})}(angular),function(e){e.module("jDatePicker",[])}(angular),function(e,t){"use strict";e.module("jDatePicker").directive("jdatepicker",["$parse","$rootScope","$timeout","jdatepicker",function(a,i,n,r){return{restrict:"A",priority:2,require:"ngModel",link:function(i,s,l,c){function o(a){var n,r=a,l=t.datepicker.dpDiv,d=l.find(".ui-datepicker-year").val();if(e.isString(k)&&(e.isDate(a)||(r=t.datepicker.parseDate(y,a)),r=t.datepicker.formatDate(k,r),Number(d)!==t.datepicker._curInst.selectedYear))return n=new Date(r),n.setFullYear(d),r=t.datepicker.formatDate(k,n),s.datepicker("setDate",n),o(n),void s.blur();c.$setViewValue(r),i.$apply()}function d(t){var a,i;if(e.isDate(t)){if(I&&t>new Date)return!1;if(l.jdatepickerOnlyFuture&&t<(new Date).setDate((new Date).getDate()-("=true"===l.jdatepickerOnlyFuture?1:0)))return!1;if(g.yearRange&&T)return a=g.yearRange.split(":",2),(i=t.getFullYear())>=a[0]&&i<=a[1]}return!0}function u(e){var t=new Date(l.jdatepickerMinDate).getTime(),a=new Date(l.jdatepickerMaxDate).getTime();if(new Date(e).getTime()){if(t&&t>e)return!1;if(a&&a<e)return!1}return!0}function p(e){var t=String.fromCharCode(null===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||t<" "||!_||_.indexOf(t)>-1||void 0!==P[t]}var m,_,g,v=r.getDefaults(),f=(new Date).getFullYear(),h=l.jdatepickerClass||v.class,b=void 0!==l.jdatepickerYearCount?parseInt(l.jdatepickerYearCount,10):v.yearCount,y=l.jdatepickerDateFormat||v.dateFormat,w=l.jdatepickerPDateFormat||v.pDateFormat||y,k=l.jdatepickerMDateFormat||v.mDateFormat,x=l.jdatepickerYearRange||v.yearRange||f-b+":"+f,S=l.jdatepickerValidator||null,P=void 0!==l.jdatepickerReplacedSymbols?l.jdatepickerReplacedSymbols:v.replacedSymbols,C=l.jdatepickerInputRule||v.inputRule,I=!!l.jdatepickerOnlyPast,T=void 0!==l.jdatepickerValidateYearRange?i.$eval(l.jdatepickerValidateYearRange):v.validateYearRange;s=t(s),t.datepicker.setDefaults(v),g={dateFormat:y,yearRange:x,onSelect:function(e,t){o(e),t.inline=!c.$valid},showMonthAfterYear:!0,onClose:function(e,t){t.inline=!1}},e.isObject(P)&&(g.constrainInput=!1),e.isString(h)&&""!==h&&(g.beforeShow=function(){t("#ui-datepicker-div").addClass(h)}),n(function(){s.datepicker(g)},0),S&&(S=a(S),m=/\(([\dA-Za-z_$]*)(\)|,\s)/.exec(l.jdatepickerValidator),c.$parsers.unshift(function(e){var t={};return null!==m&&(t[m[1]]=e),c.$valid&&c.$setValidity(l.name,S(i,t)),e}),c.$formatters.unshift(function(e){var t={};return null!==m&&(t[m[1]]=e),c.$valid&&c.$setValidity(l.name,S(i,t)),e})),c.$parsers.unshift(function(e){return c.$setValidity(l.name,function(e){var a;try{a=t.datepicker.parseDate(y,e)}catch(i){try{a=t.datepicker.parseDate(w,e)}catch(e){return!1}return d(a)&&u(a)}return d(a)&&u(a)}(e)),e}),c.$formatters.unshift(function(a){return c.$setValidity(l.name,function(a){var i;if(e.isDate(a))return d(a);if(e.isString(a)){try{i=t.datepicker.parseDate(w,a)}catch(e){try{i=t.datepicker.parseDate(y,a)}catch(e){return!1}return d(i)&&u(i)}return d(i)&&u(i)}return!0}(a)),a}),c.$parsers.unshift(function(a){var i,n=w;try{i=t.datepicker.parseDate(y,a)}catch(e){return a}return e.isString(k)&&(n=k),t.datepicker.formatDate(n,i)}),c.$formatters.unshift(function(a){var i;if(e.isDate(a))return t.datepicker.formatDate(y,a);if(e.isString(a)){try{i=t.datepicker.parseDate(w,a)}catch(e){i=t.datepicker.parseDate(y,a)}return t.datepicker.formatDate(y,i)}return a}),e.isObject(P)&&(_=t.datepicker._possibleChars(y),s.on("keypress",p),c.$parsers.unshift(function(t){var a;return""===t||void 0===t||null===t?t:(a=t,e.forEach(P,function(e,t){a=a.replace(new RegExp(t,"g"),e)}),a!=t&&(c.$setViewValue(a),c.$render()),a)})),e.isFunction(C)&&s.on("keyup",function(e){var t,a=s.val(),i=[8,9,16,17,37,39,46];e.ctrlKey||e.metaKey||e.altKey||-1!==i.indexOf(e.keyCode)||(t=C(a),s.val(t),c.$setViewValue(t),s.datepicker("hide"))})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("jDatePicker").provider("jdatepicker",[function(){var t={class:"",yearCount:6,dateFormat:"yy-mm-dd",pDateFormat:null,mDateFormat:null,yearRange:null,maxDate:null,minDate:null,closeText:"Закрыть",prevText:"&#x3C;Пред",nextText:"След&#x3E;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",changeMonth:!0,changeYear:!0,firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"",replacedSymbols:null,selectOtherMonths:!0,showOtherMonths:!0,validateYearRange:!0};this.setDefaults=function(a){e.extend(t,a)},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e){"use strict";e.module("calculator").controller("calculatorNavigationCtrl",["$scope","$state","calculatorService","$rootScope","calculatorStepsService","moduleType","formationPolicyService",function(e,t,a,i,n,r,s){function l(e){return function(){return e.test(t.current.name)}}function c(){return n.bigSteps.getBigStep()}e.calculation=a.calculation,e.navigation=function(){var e=[{active:function(){return l(/index.calculator/)()&&"first"===c().name},link:"index.calculator."+i.calcType,title:"Ваш автомобиль",onClick:function(){n.bigSteps.setBigStep("first")},additional_conditions:{},icon:"car"},{active:function(){return l(/index.calculator/)()&&"second"===c().name},link:"index.calculator."+i.calcType,title:"Параметры расчета",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){var e=a.calculation;return!parseInt(e.car_cost)&&"third"!==c().name},additional_conditions:{},icon:"options"},{active:function(){return"third"===c().name},onClick:function(){n.bigSteps.setBigStep("third")},link:"index.addingDocuments",title:"Тариф",condition_disabled:function(){return-1===["third","fourth"].indexOf(c().name)&&!a.getSelectedResult()},additional_conditions:{},icon:"tasks"},{active:function(){return"fourth"===c().name},onClick:function(){n.bigSteps.setBigStep("fourth")},isHidden:function(){},link:"index.ordering",title:"Заказ",condition_disabled:function(){return!a.getSelectedResult()},icon:"checked calendar"}];return"osago"===r&&(e=[{active:function(){return l(/index.calculator/)()&&"first"===c().name},title:"Рассчитайте тариф",onClick:function(){n.bigSteps.setBigStep("first")},icon:"options"},{active:function(){return l(/index.calculator/)()&&"second"===c().name},title:"Добавьте документы",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){var e=a.calculation;return!a.getSelectedResult()||!parseInt(e.car_cost)&&"fourth"!==c().name},icon:"file text outline"},{active:function(){return"fourth"===c().name},onClick:function(){n.bigSteps.setBigStep("fourth")},title:"Получите полис",condition_disabled:function(){return-1===["fourth"].indexOf(c().name)},icon:"shopping bag"}]),"health"===r&&(e=[{active:function(){return l(/index.calculator/)()&&"first"===c().name},title:"Рассчитайте страховку",onClick:function(){n.bigSteps.setBigStep("first")},icon:"options"},{active:function(){return l(/index.calculator/)()&&"second"===c().name},title:"Добавьте документы",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){return!a.calculation.id},icon:"file text outline"},{active:function(){return l(/index.calculator/)()&&"fourth"===c().name},title:"Оставьте заявку",onClick:function(){n.bigSteps.setBigStep("fourth")},condition_disabled:function(){return!s.orderMessage},icon:"comment outline"},{active:function(){return"fifth"===c().name},onClick:function(){n.bigSteps.setBigStep("fifth")},title:"Оплатите",condition_disabled:function(){return!0},icon:"shopping bag"}]),"oms"===r&&(e=[{active:function(){return l(/index.calculator/)()&&"first"===c().name},title:"Укажите параметры",onClick:function(){n.bigSteps.setBigStep("first")},icon:"options"},{active:function(){return l(/index.calculator/)()&&"second"===c().name},title:"Добавьте документы",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){return-1===["second","fourth"].indexOf(c().name)&&!a.getSelectedResult()},icon:"file text outline"},{active:function(){return l(/index.calculator/)()&&"fourth"===c().name},title:"Оставьте контактные данные",onClick:function(){n.bigSteps.setBigStep("fourth")},condition_disabled:function(){return!s.orderMessage},icon:"comment outline"}]),"usago"===r&&(e=[{active:function(){return l(/index.calculator/)()&&"first"===c().name},title:"Ввод данных",onClick:function(){n.bigSteps.setBigStep("first")},icon:"options"},{active:function(){return l(/index.calculator/)()&&"second"===c().name},title:"Выбор тарифа",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){return-1===["second","third"].indexOf(c().name)&&!a.getSelectedResult()},icon:"shopping bag"},{active:function(){return l(/index.calculator/)()&&"third"===c().name},title:"Оформление",onClick:function(){n.bigSteps.setBigStep("third")},condition_disabled:function(){return-1===["third"].indexOf(c().name)},icon:"file text outline"}]),_.forEach(e,function(e){"function"!=typeof e.isHidden&&(e.isHidden=_.noop),"function"!=typeof e.condition_disabled&&(e.condition_disabled=_.noop),"function"!=typeof e.onClick&&(e.onClick=_.noop)}),e}(),e.goToStep=function(n){var r=a.getSelectedResult();t.go(e.navigation[n].link,{calculationId:e.calculation.id||t.params.calculationId,calcType:i.calcType||"osago",companyId:r&&r.id||t.params.companyId},{reload:!1})}}])}(angular),function(e,t){"use strict";e.module("calculator").directive("goToCalculation",["$state","$rootScope","calculatorService","formationPolicyService","$timeout","formationPolicyStep1Service",function(e,a,i,n,r,s){return{restrict:"AC",scope:{calcType:"@",params:"=goToCalculation",transitionParams:"=",options:"=transitionOptions"},link:function(l,c,o,d){var u=t(c);u.click(function(t){var c=l.options||{},o=c.calcType||a.calcType,d=l.params||{},p=l.transitionParams||{};if(u.hasClass("disabled")||u.is(":disabled"))return!1;t.preventDefault(),a.calcType=o,d.rsa=e.params.rsa,r(function(){(c.resetCalc||c.resetAll)&&(s.resetAll(),i.resetCalculation()),(c.resetPolicy||c.resetAll)&&(s.resetAll(),n.resetCurrentPolicy())},0),e.go("index.calculator."+o,d,p)})}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculator").directive("moveToStep",["$timeout","moduleType","calculatorStepsService","$rootScope","CONSTS",function(e,a,i,n,r){return{restrict:"A",replace:!0,templateUrl:n.currentBrand.not_arrow_back_button?r.pathToModules+"shared/calculator/views/go_back_btn.html":r.pathToModules+"shared/calculator/views/move_to_step.html",link:function(r,s,l){var c=t(s),o="forward"===l.moveToStep?"forward":"back",d="#c7c9cc";if("button"===l.moveToStep&&!n.currentBrand.not_arrow_back_button||"arrow"===l.moveToStep&&n.currentBrand.not_arrow_back_button)return void c.hide();if(n.currentBrand.go_back_button_color&&(d=n.currentBrand.go_back_button_color),"text"===l.moveToStepType&&"casco"===a||n.currentBrand.go_back_button_text){var u=n.currentBrand.go_back_button_text||"Назад";c.addClass("nowrap"),c.addClass("c-change-step--text"),c.html('<i class="caret left icon"></i> <span class="c-change-step__text">'+u+'</span><div class="backs"></div>')}else"back"===o&&"button"!==l.moveToStep&&(c.addClass("nowrap"),c.addClass("c-change-step--"+o),c.html('<svg class="с-back-arrow c-change-step__arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="54" viewBox="0 0 16 54"><path d="M2.344 1l13.29 26.437L2.344 53" class="cls-2" fill="none" stroke="'+d+'" stroke-width="2"></path> </svg>'));c.click(function(t){return e(function(){i.toPrevSmallStep()},0),!1})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("calculator").provider("calculator",[function(){var t={id:null,car_cost:0,car_mark:null,car_model_group:null,car_model:null,car_manufacturing_year:null,exploitation_area:null,owner_registration:null,drivers_count:0,driver_set:[],drivers_minimal_age:null,drivers_minimal_experience:null,is_multidrive:!1,target_of_using:null,insurance_duration:null,contributory_scheme:null,payment_type:null,mileage:null,insurable_risk:null,claim_form:null,payment_form:null,deductible_value:null,civil_liability_voluntary_cost:null,car_type:null,insured_object:null,count_years_break_even_insurance:0,calculation_at_date:null,insurance_type:null,has_foreign_registration:!1,maximum_mass:null,seats_number:null,engine_power:null,engine_displacement:null,is_legal_entity:!1,has_trailer:null,calculation_type:null,is_earlier_insurance:null};this.setDefaults=function(a){e.extend(t,a)},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e,t){"use strict";e.module("calculator").service("calculatorStepsService",["stepsService","$rootScope","Dictionary","calculatorService","CONSTS","$filter","brandingConfigs","brandingService","moduleType","$stateParams","$q",function(a,i,n,r,s,l,c,o,d,u,p){function m(){var e=y.bigSteps.getBigStep().name;return a.steps[e]||[]}function g(){return{age:26,expirience:6,is_married:!1,has_children:!1,gender:"M",birth_date:"",driving_experience_started:""}}function v(e){_.forEach(e,function(e){var t=new Date(e.birth_date),a=new Date(e.driving_experience_started);t.setDate(t.getDate()+2),a.setDate(a.getDate()+2);var i=_.getYearByDate(t),n=_.getYearByDate(a);i=i>=18&&i<23?19:i>=23&&i<29?24:i>=29&&i<35?30:i>=35&&i<40?36:i>=40&&i<65?41:66,n=n>=0&&n<2?1:n>=2&&n<5?3:n>=5&&n<10?6:11,e.age=i,e.expirience=n})}i.paramsFromUrl={},["car_mark","car_manufacturing_year","car_model_group","car_model","city"].forEach(function(e){window.getParameterByName(e)&&(i.paramsFromUrl[e]=window.getParameterByName(e))});var f=r.calculation,h={},b={carModel:null,carModelGroup:null,carMark:null},y=this;this.brandSteps=a.steps;var w;switch(d){case"osago":w="O";break;case"kasko":w="C";break;case"vzr":w="V";break;case"casco":w="S";break;case"usago":w="U";break;default:w=""}var k={first:{name:"first",templateUrl:function(){var e=s.pathToModules+"shared/calculatorSteps/views/first_big_step.html";return c.templates.first_big_step&&(e=c.templates.first_big_step),"casco"===d&&(e=s.pathToModules+"casco/calculatorStepsS/views/first_big_step.html"),"usago"===d&&(e=s.pathToModules+"usago/calculatorStepsU/views/first_big_step.html"),e}()},second:{name:"second",templateUrl:s.pathToModules+d+"/calculatorSteps"+w+"/views/second_big_step.html"},third:{name:"third",templateUrl:function(){return c.templates.third_big_step||o.third_big_step_template||s.pathToModules+"shared/carFilter/views/third_big_step.html"}()},fourth:{name:"fourth",templateUrl:function(){return"health"===d?s.pathToModules+"health/calculatorSteps/views/fourth_big_step.html":"oms"===d?s.pathToModules+"oms/calculatorSteps/views/fourth_big_step.html":i.currentBrand.with_alternative_fourth_step?c.templates.alternative_fourth_big_step||s.pathToModules+"shared/carFilter/views/alternative_fourth_big_step.html":(console.log(c.templates.fourth_big_step),c.templates.fourth_big_step||s.pathToModules+"shared/carFilter/views/fourth_big_step.html")}()},fifth:{name:"fifth",templateUrl:s.pathToModules+"health/calculatorSteps/views/fifth_big_step.html"}};this.bigsStepsTepmplates=k;var x=function(){return{maxDiscount:1,getDiscount:function(){return 1},getTitle:function(){}}}(),S={usago_drivers_simple_full:{name:"usago_drivers_simple_full",discountParams:x,getDiscountTitle:function(){},clearStep:function(){},toNextStep:function(){},getCurrStepTitle:function(){return"Оформите заявку на получение полиса"},templateUrl:s.pathToModules+"usago/calculatorStepsU/views/step.usago_drivers_simple_full.html"},usago_ordering_full:{name:"usago_ordering_full",discountParams:x,getDiscountTitle:function(){},clearStep:function(){},toNextStep:function(){},getCurrStepTitle:function(){return"Оформите заявку на получение полиса"},templateUrl:s.pathToModules+"usago/calculatorStepsU/views/step.usago_ordering_full.html"},usago_all:{name:"usago_all",discountParams:x,getDiscountTitle:function(){},clearStep:function(){f.owner_registration=null},toNextStep:function(){f.owner_registration=y.calculationInterParams.owner_registration,n.getItems("ownerRegistration").then(function(e){var t=_.find(e.results,function(e){return e.id===Number(y.calculationInterParams.owner_registration)});y.calculationInterParams.owner_registration_title=t.title||null})},getCurrStepTitle:function(){},getLabelTitle:function(){return y.calculationInterParams.owner_registration_title?y.calculationInterParams.owner_registration_title:null},templateUrl:c.templates.usago_all||s.pathToModules+"usago/calculatorStepsU/views/step.usago_all.html"},usago_engine_power:{name:"usago_engine_power",discountParams:x,getDiscountTitle:function(){},clearStep:function(){f.engine_power=null},toNextStep:function(){f.engine_power=y.calculationInterParams.engine_power},getCurrStepTitle:function(){return"Укажите мощность двигателя"},getLabelTitle:function(){return f.engine_power?f.engine_power+" л.с.":null},templateUrl:_.get(i.currentBrand,"templates.usago_engine_power")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_engine_power.html"},usago_start_date:{name:"usago_start_date",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasDate=!1},toNextStep:function(){h.hasDate=!0},getCurrStepTitle:function(){return"Выберите дату начала действия полиса"},getLabelTitle:function(){return h.hasDate?f.calculation_at_date:null},templateUrl:_.get(i.currentBrand,"templates.usago_start_date")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_start_date.html"},usago_drivers_simple:{name:"usago_drivers_simple",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasDrivers=!1},toNextStep:function(){h.hasDrivers=!0},getCurrStepTitle:function(){return"Укажите возраст и стаж водителей"},getLabelTitle:function(){var e=f.driver_set.length?f.driver_set.length+" водит":"Мультидрайв";return h.hasDrivers?e:null},templateUrl:_.get(i.currentBrand,"templates.usago_drivers_simple")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_drivers_simple.html"},usago_precalculation:{name:"usago_precalculation",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.withKBM=!1},toNextStep:function(){h.withKBM=!0},getCurrStepTitle:function(){return"Выберите страховую компанию и тариф"},getLabelTitle:function(){return h.withKBM?"Рассчет с КБМ":null},templateUrl:_.get(i.currentBrand,"templates.usago_precalculation")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_precalculation.html"},usago_drivers_full:{name:"usago_drivers_full",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasFullDrivers=!1},toNextStep:function(){h.hasFullDrivers=!0;var e=t("#UsagoApp").offset();e&&jQueryApp("html,body").animate({scrollTop:e.top},"swing")},getCurrStepTitle:function(){return"Укажите точные данные водителей"},getLabelTitle:function(){return h.hasFullDrivers?"Водители":null},templateUrl:_.get(i.currentBrand,"templates.usago_drivers_full")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_drivers_full.html"},usago_car:{name:"usago_car",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasCarParams=!1},toNextStep:function(){b="",h.hasCarParams=!0},getCurrStepTitle:function(){return"Укажите данные транспортного средства"},getLabelTitle:function(){return h.hasCarParams?"Авто":null},templateUrl:s.pathToModules+"usago/calculatorStepsU/views/step.usago_car.html"},usago_year:{name:"usago_year",getDiscountTitle:function(){},clearStep:function(){f.year=null},toNextStep:function(){f.year=y.calculationInterParams.year},getCurrStepTitle:function(){return"Укажите год выпуска"},templateUrl:s.pathToModules+"usago/calculatorStepsU/views/step.usago_year.html"},usago_sms_verification:{name:"usago_sms_verification",discountParams:x,getDiscountTitle:function(){},clearStep:function(){},toNextStep:function(){},getCurrStepTitle:function(){return"Пройдите бесплатную СМС - верификацию"},templateUrl:_.get(i.currentBrand,"templates.usago_sms_verification")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_sms_verification.html"},usago_calculation:{name:"usago_calculation",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasSelectedResult=!1},toNextStep:function(){h.hasSelectedResult=!0},getCurrStepTitle:function(){return"Выберите страховую компанию и тариф"},getLabelTitle:function(){return h.hasSelectedResult?"СК":null},templateUrl:_.get(i.currentBrand,"templates.usago_calculation")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_calculation.html"},usago_personal_data_persons:{name:"usago_personal_data_persons",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasDealParams=!1},toNextStep:function(){h.hasDealParams=!0},getCurrStepTitle:function(){return"Введите паспортные данные участников договора"},getLabelTitle:function(){return h.hasDealParams?"Участники договора":null},templateUrl:_.get(i.currentBrand,"templates.usago_personal_data_persons")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_personal_data_persons.html"},usago_personal_data_car:{name:"usago_personal_data_car",discountParams:x,getDiscountTitle:function(){},clearStep:function(){h.hasFullCarParams=!1},toNextStep:function(){h.hasFullCarParams=!0},getCurrStepTitle:function(){return"third"===P.activeBigStep?"Оформите заявку на получение полиса":"Введите данные транспортного средства"},getLabelTitle:function(){return h.hasFullCarParams?"VIN":null},templateUrl:_.get(i.currentBrand,"templates.usago_personal_data_car")||s.pathToModules+"usago/calculatorStepsU/views/step.usago_personal_data_car.html"},casco_all:{name:"casco_all",getDiscountTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_CITY"),""},clearStep:function(){f.exploitation_area=null},toNextStep:function(){f.exploitation_area=y.calculationInterParams.exploitation_area,n.getItems("exploitationArea").then(function(e){var t=_.find(e,function(e){return e.id===Number(y.calculationInterParams.exploitation_area)});y.calculationInterParams.exploitation_area_title=_.get(t,"title")||null,window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_EVENT_CITY_"+t.title)})},getLabelTitle:function(){var e=i.currentBrand.label_titles&&i.currentBrand.label_titles.casco_all||"Город";return f.exploitation_area?e:null},templateUrl:c.templates.casco_all||s.pathToModules+"casco/calculatorStepsS/views/step.casco_all.html"},casco_car_mark:{name:"casco_car_mark",discountParams:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.casco_car_mark||1;return{maxDiscount:e,getDiscount:function(){return e},getTitle:function(){return i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.casco_car_mark||"Получите скидку "+e+"% на полис, выбрав автомобиль."}}}(),getCurrStepTitle:function(){return i.currentBrand.steps_titles&&i.currentBrand.steps_titles.casco_car_mark||"Укажите марку автомобиля"},clearStep:function(){f.car_mark=null,b.carMark=null},toNextStep:function(){f.car_mark=y.calculationInterParams.car_mark},getLabelTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_MARK"),f.car_mark&&b.carMark?b.carMark.title:null},templateUrl:s.pathToModules+"casco/calculatorStepsS/views/step.casco_car_mark.html"},casco_year:{name:"casco_year",discountParams:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.casco_year||1;return{maxDiscount:e,getDiscount:function(){return e},getTitle:function(){return window.getParameterByName("year")&&(f.year=y.calculationInterParams.year=window.getParameterByName("year"),y.toNextSmallStep()),i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.casco_year||"+"+e+"% за выбор года выпуска."}}}(),getCurrStepTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_YEAR"),window.getParameterByName("year")&&(f.year=y.calculationInterParams.year=window.getParameterByName("year"),y.toNextSmallStep()),i.currentBrand.steps_titles&&i.currentBrand.steps_titles.casco_year||"Укажите год выпуска автомобиля"},clearStep:function(){r.calculatorOtherParams.car_manufacturing_year=null,f.car_manufacturing_year=null},toNextStep:function(){f.car_manufacturing_year=y.calculationInterParams.car_manufacturing_year.id},getLabelTitle:function(){return f.car_manufacturing_year||null},templateUrl:c.templates.casco_year||s.pathToModules+"casco/calculatorStepsS/views/step.casco_year.html"},casco_car_model_group:{name:"casco_car_model_group",discountParams:function(){return{maxDiscount:0,getDiscount:function(){return 0},getTitle:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.casco_car_model||1;return i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.casco_car_model_group||"+"+e+"% за выбор модели автомобиля."}}}(),getCurrStepTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_MODEL"),i.currentBrand.steps_titles&&i.currentBrand.steps_titles.casco_car_model_group||"Укажите модель автомобиля"},clearStep:function(){f.car_model_group=null},toNextStep:function(){},getLabelTitle:function(){return f.car_model_group&&b.carModelGroup?b.carModelGroup.title:null},templateUrl:s.pathToModules+"casco/calculatorStepsS/views/step.casco_car_model_group.html"},casco_car_model:{name:"casco_car_model",discountParams:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.casco_car_model||1;return{maxDiscount:e,
getDiscount:function(){return e},getTitle:function(){return i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.casco_car_model||"+"+e+"% за выбор модели автомобиля."}}}(),getCurrStepTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_MODIFICATION"),i.currentBrand.steps_titles&&i.currentBrand.steps_titles.casco_car_model||"Укажите модификацию автомобиля"},clearStep:function(){f.car_model=null},toNextStep:function(){},getLabelTitle:function(){return f.car_model&&b.carModel?b.carModel.title:null},templateUrl:s.pathToModules+"casco/calculatorStepsS/views/step.casco_car_model.html"},casco_car_other:{discountParams:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.casco_car_other||2;return{maxDiscount:e,getDiscount:function(){return e},getTitle:function(){return i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.casco_car_other||"+"+e+"% за выбор параметров автомобиля."}}}(),getCurrStepTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_CAR.PRICE_POWER"),i.currentBrand.steps_titles&&i.currentBrand.steps_titles.casco_car_other||"Укажите параметры автомобиля"},name:"casco_car_other",clearStep:function(){f.engine_power=null,f.mileage=null,f.car_cost=null},toNextStep:function(){f.engine_power=y.calculationInterParams.engine_power,f.mileage=y.calculationInterParams.mileage,f.car_cost=y.calculationInterParams.car_cost},getLabelTitle:function(){return f.engine_power?f.engine_power+" л.с.":null},templateUrl:_.get(i.currentBrand,"templates.casco_car_other")||s.pathToModules+"casco/calculatorStepsS/views/step.casco_car_other.html"},casco_insurance_params:{name:"casco_insurance_params",discountParams:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.casco_insurance_params||.5;return{maxDiscount:e,getDiscount:function(){return e},getTitle:function(){return i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.casco_insurance_params||"+"+e+"% за выбор начала действия договора."}}}(),getCurrStepTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_DATE"),"Укажите параметры договора"},clearStep:function(){},toNextStep:function(){},getLabelTitle:function(){return f.calculation_at_date},templateUrl:c.templates.casco_insurance_params||s.pathToModules+"casco/calculatorStepsS/views/step.casco_insurance_params.html"},vzr_all:{name:"vzr_all",clearStep:function(){},toNextStep:function(){},getLabelTitle:function(){},templateUrl:c.templates.vzr_all||s.pathToModules+"vzr/calculatorSteps/views/step.vzr_all.html"},age_category:{name:"age_category",clearStep:function(){f.age_category=null},toNextStep:function(){f.age_category=y.calculationInterParams.age_category.id},getLabelTitle:function(){return f.age_category?y.calculationInterParams.age_category.title:null},templateUrl:s.pathToModules+"health/calculatorSteps/views/step.age_category.html"},person_type:{name:"person_type",clearStep:function(){f.person_type=null},toNextStep:function(){f.person_type=y.calculationInterParams.person_type.id},getLabelTitle:function(){return f.person_type?y.calculationInterParams.person_type.title:null},templateUrl:s.pathToModules+"oms/calculatorSteps/views/step.person_type.html"},receipt_region:{name:"receipt_region",clearStep:function(){f.receipt_region=null},toNextStep:function(){f.receipt_region=y.calculationInterParams.receipt_region.id},getLabelTitle:function(){return f.receipt_region?y.calculationInterParams.receipt_region.title:null},templateUrl:s.pathToModules+"oms/calculatorSteps/views/step.receipt_region.html"},consult_request:{name:"consult_request",clearStep:function(){},toNextStep:function(){},getLabelTitle:function(){return null},templateUrl:s.pathToModules+"oms/calculatorSteps/views/step.consult_request.html"},insurance_sum:{name:"insurance_sum",clearStep:function(){f.insurance_sum=null},toNextStep:function(){f.insurance_sum=y.calculationInterParams.insurance_sum},getLabelTitle:function(){return f.insurance_sum?l("priceFormatter")(y.calculationInterParams.insurance_sum,0)+" руб.":null},templateUrl:s.pathToModules+"health/calculatorSteps/views/step.insurance_sum.html"},insurance_period:{name:"insurance_period",clearStep:function(){f.insurance_period=null},toNextStep:function(){if(f.insurance_period=y.calculationInterParams.insurance_period.id,"Годовой"==y.calculationInterParams.insurance_period.title){var e=new Date;e.setFullYear(e.getFullYear()+1),y.calculationInterParams.date_difference=Math.round((e-new Date)/1e3/60/60/24)}else y.calculationInterParams.date_difference=y.calculationInterParams.date_difference_default},getLabelTitle:function(){return f.insurance_period?y.calculationInterParams.insurance_period.title:null},templateUrl:s.pathToModules+"health/calculatorSteps/views/step.insurance_period.html"},insurance_days:{name:"insurance_days",clearStep:function(){f.begin_date=null,f.end_date=null},toNextStep:function(){f.begin_date=y.calculationInterParams.begin_date,f.end_date=l("date")(y.calculationInterParams.end_date,"yyyy-MM-dd")},getLabelTitle:function(){return f.begin_date?y.calculationInterParams.date_difference+" дней с "+l("date")(y.calculationInterParams.begin_date,"dd.MM.yyyy"):null},templateUrl:s.pathToModules+"health/calculatorSteps/views/step.insurance_days.html"},sport_type:{name:"sport_type",clearStep:function(){f.sport_type=null},toNextStep:function(){f.sport_type=y.calculationInterParams.sport_type.id},getLabelTitle:function(){return f.sport_type?y.calculationInterParams.sport_type.title:null},templateUrl:s.pathToModules+"health/calculatorSteps/views/step.sport_type.html"},sport_kind:{name:"sport_kind",clearStep:function(){f.sport_kind=null,"health"==d&&(r.calculatorOtherParams.result=null)},toNextStep:function(){f.sport_kind=y.calculationInterParams.sport_kind.id},getLabelTitle:function(){return f.sport_kind?y.calculationInterParams.sport_kind.title:null},templateUrl:s.pathToModules+"health/calculatorSteps/views/step.sport_kind.html"},year:{name:"year",clearStep:function(){f.car_manufacturing_year=null},toNextStep:function(){f.car_manufacturing_year=y.calculationInterParams.car_manufacturing_year},getLabelTitle:function(){return f.car_manufacturing_year?f.car_manufacturing_year+" г.в.":null},templateUrl:c.templates.car_year||s.pathToModules+"shared/calculatorSteps/views/step.year.html"},car_type:{name:"car_type",clearStep:function(){f.car_type=null},toNextStep:function(){f.car_type=y.calculationInterParams.car_type.id},getLabelTitle:function(){return f.car_type&&y.calculationInterParams.car_type&&y.calculationInterParams.car_type.title},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.car_type.html"},insurance_duration:{name:"insurance_duration",clearStep:function(){f.insurance_duration=null},toNextStep:function(){f.insurance_duration=y.calculationInterParams.insurance_duration.id},getLabelTitle:function(){return f.insurance_duration&&y.calculationInterParams.insurance_duration&&y.calculationInterParams.insurance_duration.title},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.insurance_duration.html"},car_mark:{name:"car_mark",clearStep:function(){f.car_mark=null,b.carMark=null},toNextStep:function(){f.car_mark=y.calculationInterParams.car_mark},getLabelTitle:function(){return b.carMark&&b.carMark.title},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.car_mark.html"},car_model_group:{name:"car_model_group",clearStep:function(){f.car_model_group=null,b.carModelGroup=null},toNextStep:function(){},getLabelTitle:function(){return b.carModelGroup&&b.carModelGroup.title},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.car_model_group.html"},car_model:{name:"car_model",clearStep:function(){f.car_model=null,b.carModel=null},toNextStep:function(){f.car_model=y.calculationInterParams.car_model},getLabelTitle:function(){return b.carModel&&b.carModel.title},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.car_model.html"},engine_power:{name:"engine_power",clearStep:function(){f.engine_power=null},toNextStep:function(){f.engine_power=y.calculationInterParams.engine_power},getLabelTitle:function(){return f.engine_power?f.engine_power+" л.с.":null},templateUrl:c.templates.engine_power||s.pathToModules+"shared/calculatorSteps/views/step.engine_power.html"},engine_power_ranges:{name:"engine_power_ranges",clearStep:function(){f.engine_power=null},toNextStep:function(){f.engine_power=y.calculationInterParams.engine_power},getLabelTitle:function(){return f.engine_power?y.calculationInterParams.engine_power_title+" л.с.":null},templateUrl:c.templates.engine_power_ranges||s.pathToModules+"shared/calculatorSteps/views/step.engine_power_ranges.html"},sms_verification:{name:"sms_verification",clearStep:function(){f.client_name=null,f.client_phone=null},toNextStep:function(){window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_EVENT_SMS_CHECK"),f.client_name=y.calculationInterParams.client_name||f.client_name,f.client_phone=y.calculationInterParams.client_phone||f.client_phone},getLabelTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_SMS"),f.client_name?f.client_name+" ("+f.client_phone+")":null},templateUrl:c.templates.sms_verification||s.pathToModules+"shared/carFilter/views/sms_step_osago.html"},deductible_value:{name:"deductible_value",clearStep:function(){f.deductible_value=null},toNextStep:function(){f.deductible_value=y.calculationInterParams.deductible_value},getLabelTitle:function(){return f.deductible_value?"Франшиза: "+l("priceFormatter")(y.calculationInterParams.deductible_value,0)+" руб.":null},templateUrl:c.templates.deductible_value||s.pathToModules+"shared/calculatorSteps/views/step.deductible_value.html"},exploitation_area:{name:"exploitation_area",clearStep:function(){f.exploitation_area=null},toNextStep:function(){f.exploitation_area=y.calculationInterParams.exploitation_area},getLabelTitle:function(){return f.exploitation_area?this.calculationInterParams.exploitation_area_title:null}.bind(this),templateUrl:c.templates.exploitation_area||s.pathToModules+"shared/calculatorSteps/views/step.exploitation_area.html"},contributory_scheme:{name:"contributory_scheme",clearStep:function(){f.contributory_scheme=null},toNextStep:function(){f.contributory_scheme=y.calculationInterParams.contributory_scheme},getLabelTitle:function(){return f.contributory_scheme?this.calculationInterParams.contributory_scheme:null}.bind(this),templateUrl:c.templates.car_cost||s.pathToModules+"shared/calculatorSteps/views/step.contributory_scheme.html"},car_cost:{name:"car_cost",clearStep:function(){f.car_cost=null},toNextStep:function(){f.car_cost=y.calculationInterParams.car_cost},getLabelTitle:function(){return f.car_cost?l("priceFormatter")(f.car_cost,0)+" руб.":null},templateUrl:c.templates.car_cost||s.pathToModules+"shared/calculatorSteps/views/step.car_cost.html"},mileage:{name:"mileage",clearStep:function(){f.mileage=null},toNextStep:function(){f.mileage=y.calculationInterParams.mileage},getLabelTitle:function(){return f.mileage?l("priceFormatter")(f.mileage,0)+" км.":null},templateUrl:c.templates.mileage||s.pathToModules+"shared/calculatorSteps/views/step.mileage.html"},owner_registration:{name:"owner_registration",clearStep:function(){f.owner_registration=null},toNextStep:function(){f.owner_registration=y.calculationInterParams.owner_registration&&y.calculationInterParams.owner_registration.id},getLabelTitle:function(){return f.owner_registration?y.calculationInterParams.owner_registration_title:null},templateUrl:c.templates.owner_registration||s.pathToModules+"shared/calculatorSteps/views/step.owner_registration.html"},drivers_count:{name:"drivers_count",clearStep:function(){f.drivers_count=null,y.calculationInterParams.drivers_count=null},toNextStep:function(){f.drivers_count=y.calculationInterParams.drivers_count.id},getLabelTitle:function(){return y.calculationInterParams.drivers_count&&y.calculationInterParams.drivers_count.title||null},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.drivers_count.html"},drivers:{name:"drivers",discountParams:function(){var e=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.drivers||1.5;return{maxDiscount:e,getDiscount:function(){return e},getTitle:function(){return i.currentBrand.steps_discount_titles&&i.currentBrand.steps_discount_titles.drivers||"+"+e+"% за выбор параметров водителей."}}}(),getCurrStepTitle:function(){return window.amplitude&&window.amplitude.getInstance().logEvent("KASKObr_STEP_DRIVER_AGE_EXP_GENDER"),i.currentBrand.steps_titles&&i.currentBrand.steps_titles.drivers||"Укажите параметры водителей"},clearStep:function(){f.driver_set=[g()],h.hasDrivers=!1},toNextStep:function(){f.driver_set=y.calculationInterParams.drivers,h.hasDrivers=!0},getLabelTitle:function(){var e=f.driver_set.length;return h.hasDrivers?e?e+" водит":"без огранечений":null},templateUrl:c.templates.drivers||o.drivers_template||s.pathToModules+"shared/calculatorSteps/views/step.drivers.html"},is_multidrive:{name:"is_multidrive",discountParams:function(){return{maxDiscount:1.5,getDiscount:function(){return 1.5},getTitle:function(){return"+1.5% за выбор параметров водителей."}}}(),getCurrStepTitle:function(){return"Укажите параметры водителей"},clearStep:function(){f.is_multidrive=null,f.drivers_minimal_age=null,f.drivers_minimal_experience=null},toNextStep:function(){f.is_multidrive=!0,f.drivers_minimal_age=y.calculationInterParams.drivers_minimal_age,f.drivers_minimal_experience=y.calculationInterParams.drivers_minimal_experience},templateUrl:c.templates.is_multidrive||o.is_multidrive_template||s.pathToModules+"shared/calculatorSteps/views/step.is_multidrive.html"},is_earlier_insurance:{name:"is_earlier_insurance",clearStep:function(){f.is_earlier_insurance=null},toNextStep:function(){f.is_earlier_insurance=y.calculationInterParams.is_earlier_insurance},getLabelTitle:function(){return _.isBoolean(f.is_earlier_insurance)?f.is_earlier_insurance?"Ранее был застрахован":"Ранее не страховался":""},templateUrl:c.templates.is_earlier_insurance||s.pathToModules+"shared/calculatorSteps/views/step.is_earlier_insurance.html"},earlier_company:{name:"earlier_company",clearStep:function(){f.earlier_icompany=null},toNextStep:function(){f.earlier_icompany=y.calculationInterParams.earlier_icompany},getLabelTitle:function(){return y.calculationInterParams.earlier_icompany?y.calculationInterParams.earlier_icompany.title:null},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.earlier_icompany.html"},is_credit:{name:"is_credit",clearStep:function(){f.is_credit=null},toNextStep:function(){f.is_credit=y.calculationInterParams.is_credit},getLabelTitle:function(){return _.isBoolean(f.is_credit)?f.is_credit?"Куплен в кредит":"Без кредита":""},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.is_credit.html"},is_credit_bank:{name:"is_credit_bank",clearStep:function(){f.is_credit=null,f.credit_bank=null},toNextStep:function(){f.is_credit=y.calculationInterParams.is_credit,f.credit_bank=y.calculationInterParams.credit_bank},getLabelTitle:function(){return _.isBoolean(f.is_credit)&&_.isNumber(f.credit_bank)?f.is_credit?"Куплен в кредит":"Без кредита":""},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.is_credit_bank.html"},is_new_car:{name:"is_new_car",clearStep:function(){f.is_new_car=null},toNextStep:function(){f.is_new_car=y.calculationInterParams.is_new_car},getLabelTitle:function(){return _.isBoolean(f.is_new_car)?f.is_new_car?"Новое ТС":"ТС с пробегом":""},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.is_new_car.html"},has_trailer:{name:"has_trailer",clearStep:function(){f.has_trailer=null},toNextStep:function(){f.has_trailer=y.calculationInterParams.has_trailer},getLabelTitle:function(){return _.isBoolean(f.has_trailer)?f.has_trailer?"Есть прицеп":"Без прицепа":""},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.has_trailer.html"},calculation_type:{name:"calculation_type",clearStep:function(){y.calculationInterParams.calculation_type=null},toNextStep:function(){},getLabelTitle:function(){return y.calculationInterParams.calculation_type&&("full"===y.calculationInterParams.calculation_type?"Точный с КБМ":"Примерный")},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.calculation_type.html"},"car_settings.tumen":{name:"car_settings.tumen",clearStep:function(){f.car_cost=null,f.mileage=null,f.engine_power=null,f.engine_displacement=null},toNextStep:function(){f.car_cost=y.calculationInterParams.car_cost,f.mileage=y.calculationInterParams.mileage,f.engine_power=y.calculationInterParams.engine_power,f.engine_displacement=y.calculationInterParams.engine_displacement},getLabelTitle:function(){},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.car_settings.tumen.html"},"policy_settings.tumen":{name:"policy_settings.tumen",clearStep:function(){f.contributory_scheme=null,f.is_under_warranty=null,f.payment_form=null,f.is_new_car=null},toNextStep:function(){f.contributory_scheme=y.calculationInterParams.contributory_scheme,f.is_under_warranty=y.calculationInterParams.is_under_warranty,f.payment_form=[y.calculationInterParams.payment_form],f.is_new_car=y.calculationInterParams.is_new_car},getLabelTitle:function(){},templateUrl:s.pathToModules+"shared/calculatorSteps/views/step.policy_settings.tumen.html"},calc:{name:"calc",clearStep:function(){},toNextStep:function(){}},to_next_step:{name:"to_next_step",clearStep:function(){},toNextStep:function(){}}};e.forEach(a.stepsHacks,function(t,a){S[a]&&(S[a]=e.extend({},S[a],t))}),this.getDefaultDriver=g,this.carAllSelected=b,this.getCurrentCalcType=function(){return this.calculationInterParams.calculation_type}.bind(this);var P={activeState:this.brandSteps.first[0],activeStateSecond:this.brandSteps.second[0],activeBigStep:u.cbs?u.cbs:"first"};this.getActiveStep=function(){return S[P.activeState]},this.getFullDiscount=function(e){var t,a=y.bigSteps.getBigStep().name;"first"===a?t=y.getActiveStep():"second"===a&&(t=y.getActiveStepSecond());var n=!1,r=_.reduce(y.brandSteps.first.concat(y.brandSteps.second),function(a,i){return i="function"==typeof i?i(f):i,!e&&t&&i===t.name&&(n=!0),n||!S[i].discountParams?a:a+(e?S[i].discountParams.maxDiscount:S[i].discountParams.getDiscount())},0);return"usago"===d?r:((e||("third"===a||"fourth"===a)&&y.calculatorOtherParams&&y.calculatorOtherParams.resultsAreVisible)&&i.currentBrand.with_sms&&(r+=i.currentBrand.steps_discount&&i.currentBrand.steps_discount.sms_verification||3),r)},AngularAppConfig.images&&Array.isArray(AngularAppConfig.images)&&i.$watch(function(){return this.getCurrentStep()}.bind(this),function(){setTimeout(function(){var e=AngularAppConfig.images[Math.floor(Math.random()*AngularAppConfig.images.length)],t=jQueryApp.find(".c-ct__progress__wrapper");console.log(t),t.length&&(t[0].style.background='url("'+e+'") no-repeat center center')})}),this.getCurrentStepIndex=function(e){var t,a,i=y.bigSteps.getBigStep().name;if("first"===i)t=y.getActiveStep();else{if("second"!==i)return null;t=y.getActiveStepSecond()}return a=m(),_.findIndex(a,function(a){return y.getStepObjectByItem(a)===(e||t.name)})},this.getIndexByStep=function(e){var t=m();return e=y.getStepObjectByItem(e),_.findIndex(t,function(t){return t===e})},this._getToggledStep=function(e,t){var a,i=this.getCurrentStepIndex(t),n=m();if(-1===i)throw new Error("The brand doesn't contain this step.");return a=n[i+e],this.getStepObjectByItem(a)},this.getCurrentStep=function(){return y._getToggledStep(0)},this.getNextStep=function(){return y._getToggledStep(1)},this._clearByStep=function(e){var t=this.bigSteps.getBigStep().name;_.findLast(a.steps[t],function(t){var a;return t=y.getStepObjectByItem(t),a=t===e,S[t].clearStep(),a})},this.getStepObjectByItem=function(e){return _.isFunction(e)&&e(f)||e},this._toggleSmallStep=function(e,t){var a=this.bigSteps.getBigStep().name;if("oms"===d){if("second"===a&&-1===e)return this.bigSteps.setBigStep("first");if("fourth"===a&&-1===e)return this.bigSteps.setBigStep("second")}var i=this._getToggledStep(e,t);if("to_next_step"===i&&(i=this._getToggledStep(e,i)),i&&"calc"!==i){if("first"===a)return this.setActiveStep(i);if("second"===a)return this.setActiveStepSecond(i)}if(e<0){if("second"===a&&this.bigSteps.setBigStep("first"),"third"===a||"fourth"===a&&"osago"===d)return"usago"===d&&S[_.last(this.brandSteps.second)].clearStep(),this.bigSteps.setBigStep("second");"fourth"===a&&this.bigSteps.setBigStep("third")}e>0&&("first"===a&&this.bigSteps.setBigStep("second"),"second"===a&&this.bigSteps.setBigStep("third"),"third"===a&&this.bigSteps.setBigStep("fourth"))},this.calculationInterParams=e.extend({},{engine_power:f.engine_power||120,withAntitheft:!1,antitheft:null,exploitation_area:f.exploitation_area||_.get(c,"defaults.calculation.exploitation_area",null),calculation_type:null,car_cost:f.car_cost||null,mileage:f.mileage||null,drivers:f.driver_set||[],drivers_count:1,drivers_minimal_age:18,drivers_minimal_experience:0,is_earlier_insurance:null,engine_displacement:1,deductible_value:0,lastDriverIndex:0,currentDriverIndex:0,insurance_sum:0,contributory_scheme:0,payment_form:null,is_under_warranty:null,is_new_car:null,credit_bank:null,params:{transmission:"Автомат",drive_of_car:"Полный"},begin_date:"",end_date:"",date_difference:7,date_difference_default:7},c.calculationInterParamsDefaults),this.toNextSmallStep=this._toggleSmallStep.bind(this,1),this.toPrevSmallStep=this._toggleSmallStep.bind(this,-1),this.setActiveStep=function(e){var t=this.bigSteps.getBigStep().name;this._clearByStep(e),"first"===t&&(P.activeState=e),"second"===t&&(P.activeStateSecond=e)}.bind(this),this.getActiveStepSecond=function(){return S[P.activeStateSecond]},this.getBrandStepsWithParams=function(){var e=[],t=this.getAllSteps();return _.forEach(this.brandSteps.first,function(a){e.push(t[a])}),e}.bind(this),this.getAllSteps=function(){return S},this.setActiveStepSecond=function(e){this._clearByStep(e),P.activeStateSecond=e},this.bigSteps={getBigStep:function(){return k[P.activeBigStep]},setBigStep:function(e){P.activeBigStep=e}},this.driversAreInvalid=function(e){e=e||y.calculationInterParams.drivers;var t,a,i=e.length;for(t=0;t<i;t++)if(a=e[t],!a.expirience&&0!=a.expirience||a.age<18||a.age-a.expirience<18)return!0;return!1},this.parseDriversDates=v}])}(angular,jQueryApp),function(e){e.module("person",[])}(angular),function(e){"use strict";e.module("person").factory("Person",["resources","$q","$http","CONSTS",function(t,a,i,n){function r(e){var t;return t="legal_person"===e._personType?["title"]:["first_name","last_name","patronymic","birth_date","gender"],_.pick(e,t)}var s;return s=function(e){e=e||{},"legal_person"===e.personType?(this._personType="legal_person",this._resourcePrefix=t.legalPerson):(this._personType="natural_person",this._resourcePrefix=t.naturalPerson),this.credential=[],this.contact=[],this.address=[],this.extend(e)},s.prototype.extend=function(t){e.extend(this,t)},s.prototype.get=function(e,t){if(null===(e||this.id||null))throw new Error("id is null!");return i.get(this._resourcePrefix+"/"+e,t).then(function(e){return this.extend(e.data),e.data}.bind(this))},s.prototype.getCredentialList=function(){return this._getList("credential")},s.prototype.getContactList=function(){return this._getList("contact")},s.prototype.getAddressList=function(){return this._getList("address")},s.prototype._getList=function(e){var t;return this.id?i.get(this._resourcePrefix+"/"+this.id+"/"+e).then(function(t){return this[e]=t.data,this[e]}.bind(this)):(t=a.defer(),t.resolve(this[e]),t.promise)},s.prototype.hasRole=function(){return this.isOwner||this.isInsurant},s.prototype.addCredential=function(e){return this._addItem("credential",e)},s.prototype.addContact=function(e){return this._addItem("contact",e)},s.prototype.addAddress=function(e){return this._addItem("address",e)},s.prototype._addItem=function(t,a){if(!e.isArray(this[t]))throw new Error(t+" of person is not array");return this[t].push(a),a},s.prototype.saveCredentialList=function(){return this._saveList("credential")},s.prototype.saveContactList=function(){return this._saveList("contacts")},s.prototype.saveAddressList=function(){return this._saveList("address")},s.prototype._saveList=function(t,n,r){var s=[],l=this;if(this[t])return e.forEach(this[t],function(a){var c,o="post",d=l._resourcePrefix+"/"+l.id+"/"+t;a.id&&(o="put",d+="/"+a.id),c=i[o](d,a),c.then(function(t){return e.extend(a,t.data),t.data}),e.isFunction(n)&&c.then(n),e.isFunction(r)&&c.catch(r),s.push(c)}),a.all(s)},s.prototype.removeContact=function(e){return this._removeItem("contact",e)},s.prototype.removeAddress=function(e){return this._removeItem("address",e)},s.prototype.removeCredential=function(e){return this._removeItem("credential",e)},s.prototype._removeItem=function(e,t){var n=a.defer();return this[e]&&(t.id?i.delete(this._resourcePrefix+"/"+this.id+"/"+e+"/"+t.id).then(function(){this[e]=_.reject(this[e],function(e){return t===e}),n.resolve(this[e])}.bind(this),function(e){n.reject(e)}):(this[e]=_.reject(this[e],function(e){return t===e}),n.resolve(this[e]))),n.promise},s.prototype.save=function(){var e="post",t=this._resourcePrefix;return this.id&&(e="put",t+="/"+this.id),i[e](t,r(this)).then(function(e){return this.extend(e.data),e.data}.bind(this))},s.prototype.remove=function(){var e=a.defer();return this.id?i.delete(this._resourcePrefix+"/"+this.id):(e.reject("Person hasn't id"),e.promise)},s.prototype.saveAll=function(){var e=a.defer();return this.save().then(function(t){var i=[];i.push(this.saveCredentialList()),i.push(this.saveAddressList()),a.all(i).then(function(a){e.resolve({person:t,credential:a[0],address:a[1]})},function(t){e.reject(t)})}.bind(this),function(t){e.reject(t)}),e.promise},s}])}(angular),function(e){"use strict";e.module("person").service("personService",["$http","$q","CONSTS","resources",function(t,a,i,n){return{getNaturalPerson:function(e){return t.get(n.naturalPerson+"/"+e).then(function(e){return e.data})},getNaturalPersonData:function(e){var i={id:e},r=[];return r.push(t.get(n.naturalPerson+"/"+i.id+"/credential").then(function(e){return e.data})),r.push(t.get(n.naturalPerson+"/"+i.id+"/address").then(function(e){return e.data})),r.push(t.get(n.naturalPerson+"/"+i.id+"/contact").then(function(e){return e.data})),a.all(r).then(function(e){var t=e[0],a=e[1],n=e[2];return i.driver_license=_.find(t,function(e){return 3===e.credential_type}),i.passport=_.find(t,function(e){return 1===e.credential_type}),i.address_registration=_.find(a,function(e){return 1===e.address_type}),i.address_residential=_.find(a,function(e){return 2===e.address_type}),i.contactData=function(){return{phone:_.find(n,function(e){return 1===e.contact_type}),email:_.find(n,function(e){return 2===e.contact_type})}}(),i})},saveNaturalPersonFull:function(t){var i={},n=_.pick(t,["first_name","last_name","patronymic","birth_date","gender","id","driving_experience_started"]);return i.person=this.saveNaturalPerson(n),t.driver_license&&(e.extend(t.driver_license,{credential_type:3}),i.driver_license=this.saveNaturalPersonCredential(t.id,t.driver_license)),t.passport&&(e.extend(t.passport,{credential_type:1}),i.passport=this.saveNaturalPersonCredential(t.id,t.passport)),t.contactData&&t.contactData.phone&&t.contactData.phone.data&&(i.phone=this.saveNaturalPersonContact(t.id,e.extend(t.contactData.phone,{contact_type:1}))),t.contactData&&t.contactData.email&&t.contactData.email.data&&(i.email=this.saveNaturalPersonContact(t.id,e.extend(t.contactData.email,{contact_type:2}))),t.address_registration&&(e.extend(t.address_registration,{address_type:1}),i.address_registration=this.saveNaturalPersonAddress(t.id,t.address_registration)),t.address_residential&&(e.extend(t.address_residential,{address_type:1}),i.address_residential=this.saveNaturalPersonAddress(t.id,t.address_residential)),a.all(i).then(function(t){var a=e.extend(t.person,t);return delete a.person,a})},saveNaturalPerson:function(e){var a="post",i=n.naturalPerson;return e.id&&(a="put",i+="/"+e.id),t[a](i,e).then(function(e){return e.data})},saveNaturalPersonCredential:function(e,a){var i="post",r=n.naturalPerson+"/"+e+"/credential";return a.id&&(i="put",r+="/"+a.id),t[i](r,a).then(function(e){return e.data})},saveNaturalPersonAddress:function(e,a){var i="post",r=n.naturalPerson+"/"+e+"/address";return a.id&&(i="put",r+="/"+a.id),t[i](r,a).then(function(e){return e.data})},saveNaturalPersonContact:function(e,a){var i="post",r=n.naturalPerson+"/"+e+"/contact";return a.id&&(i="put",r+="/"+a.id),t[i](r,a).then(function(e){return e.data})}}}])}(angular),function(e){e.module("dropdown",[])}(angular),function(e,t){"use strict";e.module("dropdown").constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(e){var t=null;this.open=function(n){t||(e.bind("click",a),e.bind("keydown",i)),t&&t!==n&&(t.isOpen=!1),t=n},this.close=function(n){t===n&&(t=null,e.unbind("click",a),e.unbind("keydown",i))};var a=function(e){if(t){var a=t.getToggleElement();e&&a&&a[0].contains(e.target)||t.$apply(function(){t.isOpen=!1})}},i=function(e){27===e.which&&(t.focusToggleElement(),a())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(t,a,i,n,r,s){var l,c=this,o=t.$new(),d=n.openClass,u=e.noop,p=a.onToggle?i(a.onToggle):e.noop;this.init=function(e){c.$element=e,a.isOpen&&(l=i(a.isOpen),u=l.assign,t.$watch(l,function(e){o.isOpen=!!e}))},this.toggle=function(e){return o.isOpen=arguments.length?!!e:!o.isOpen,o.isOpen},this.isOpen=function(){return o.isOpen},o.getToggleElement=function(){return c.toggleElement},o.focusToggleElement=function(){c.toggleElement&&c.toggleElement[0].focus()},o.$watch("isOpen",function(a,i){s[a?"addClass":"removeClass"](c.$element,d),a?(o.focusToggleElement(),r.open(o)):r.close(o),u(t,a),e.isDefined(a)&&a!==i&&p(t,{open:!!a})}),t.$on("$locationChangeSuccess",function(){o.isOpen=!1}),t.$on("$destroy",function(){o.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(e,t,a,i){i.init(t)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(e,t,a,i){if(i){i.toggleElement=t;var n=function(n){n.preventDefault(),t.hasClass("disabled")||a.disabled||e.$apply(function(){i.toggle()})};t.bind("click",n),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(i.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.unbind("click",n)})}}}})}(angular),function(e){e.module("UIElements",[])}(angular),function(e,t){"use strict";e.module("UIElements").directive("inputSlider",["$filter",function(a){function i(i,n,r,s){function l(e){p.slider({min:u?0:f,max:u||h,step:v,slide:function(t,a){e?s.$setViewValue(e[a.value].id):s.$setViewValue(Math.floor(a.value/v)*v)},create:function(){o(f,h),s.$viewValue&&c(s.$viewValue)}})}function c(e){b?b.then(function(t){e="null"===e?null:e,_.find(t,function(t,a){if(t.id==e)return p.slider("option","value",a),!0})}):p.slider("option","value",e)}function o(e,t){b||(p.slider("option","min",e),p.slider("option","max",t)),r.isSum&&(e=a("priceFormatter")(e),t=a("priceFormatter")(t)),m.text(e||0),g.text(t),p.removeClass("hidden")}function d(){f&&h?o(f,h):p.addClass("hidden")}var u,p=t(n),m=p.find(".js-slider-min"),g=p.find(".js-slider-max"),v=r.sliderStep?r.sliderStep>>0:1e3,f=r.defaultMin?r.defaultMin>>0:0,h=r.defaultMax?r.defaultMax>>0:1e6,b=r.slideItems?i.$eval(r.slideItems):null;p.addClass("b-input-slider"),_.isPromise(b)?(p.addClass("b-input-slider__range"),b.then(function(e){f=_.head(e).title,h=_.last(e).title,u=e.length-1,v=1,l(e)})):l(),i.$watch(function(){return i.$eval(r.inputSlider)},function(t,a){t&&!e.equals(t,a)&&(p.slider("option","value",t.sum),
t.maxSum&&t.minSum?(p.slider("option","min",t.minSum),p.slider("option","max",t.maxSum),o(t.minSum,t.maxSum)):d())},!0),i.$watch(function(){return s.$viewValue},function(e,t){void 0!==e&&c(e)})}return{restrict:"EA",require:"ngModel",link:i,scope:!1,template:'<div class="b-input-slider_range"><span class="b-input-slider_min js-slider-min"></span><span class="b-input-slider_max js-slider-max"></span></div>'}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semCheckbox",["$compile",function(a){var i=100;return{restrict:"EA",require:"ngModel",replace:!0,scope:!1,template:'<div class="ui checkbox"><input type="checkbox" tabindex="0" class="hidden sem-checkbox"><label></label></div>',compile:function(n,r,s){var l,c=t(n),o=c.find(".sem-checkbox"),d=c.find("label"),u=r.semId,p="sem-id-"+i++;return c.removeAttr("sem-checkbox"),e.forEach(r.$attr,function(e,t){-1===["class","semType","style","ngClick","ngClass","ngShow","ngHide","yaMetrika"].indexOf(t)?(o.attr(e,r[t]),c.removeAttr(e)):r[t]&&-1!==["class","semType"].indexOf(t)&&c.addClass(r[t])}),"radio"===r.semType&&(o.prop("type","radio"),c.addClass("radio")),u?(d.attr("for",u),o.attr("id",u)):(d.attr("for",p),o.attr("id",p)),d.html(r.semLabel),l=a(c),{pre:function(e){l(e)}}}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semDropdown",["$timeout","brandingConfigs","$q",function(a,i,n){return{restrict:"EA",require:"^ngModel",replace:!0,template:'<div><input type="hidden"><i class="dropdown icon"></i><div class="text"><span ng-bind="placeholder"></span></div><div class="menu"></div></div>',scope:{items:"=semDropdownItems",placeholder:"@semDropdownPlaceholder"},link:function(a,r,s,l){function c(t){v.empty(),!a.placeholder||f||h||v.append(u({id:"",title:a.placeholder})),e.forEach(t,function(e){var t={id:e.id,title:e.title,item_type:e.item_type};b&&(t={id:e,title:e}),v.append(u(t))}),t&&t.length||p.addClass("disabled js-was-empty")}function o(e,t){function a(t){var a,i=_.find(t,function(t){return(b?t:t.id)==e});return a=i?b?i:i.id:null,d(a),a}return t?a(t):m.promise.then(a)}function d(t){var a;a=e.isArray(t)?_.map(t,function(e){return e+""}):void 0==t?"":t+"",p.dropdown("set selected",a)}function u(e){return'<div class="'+(e.item_type||"item")+'" data-value="'+e.id+'"><span>'+e.title+"</span></div>"}var p=t(r),m=n.defer(),g=[],v=p.find(".menu"),f=p.hasClass("multiple"),h=p.hasClass("placeholder-is-not-item"),b=!!s.semDropdownSimple;a.items,a.items&&(_.isPromise(a.items)?a.items.then(m.resolve):_.isArray(a.items)?m.resolve(a.items):_.isFunction(a.items)&&a.items().then(function(t){return g=t,m.resolve(g.items),a.$watch(function(){return g.changingCondition()},function(t,a){var i,n;if(!e.equals(t,a)){if(i=g.items,g.action({items:i},t),n=i&&i[0]&&i[0].id,c(i),p.dropdown("refresh"),n&&p.hasClass("js-was-empty")&&(p.removeClass("disabled"),o(l.$viewValue)),"null"!==s.semDropdownDefaultValue&&n)return o(l.$viewValue,i)||d(n);d(null)}},!0),t})),p.hasClass("selection")||p.find(".icon.dropdown").remove(),m.promise.then(function(e){c(e),p.dropdown({selectOnKeydown:!1,fullTextSearch:!0,forceSelection:!1,match:"text",onChange:function(e){var t=e;"false"!==e&&"true"!==e||(t=JSON.parse(e)),l.$setViewValue(t)},message:{addResult:"Добавить <b>{term}</b>",count:"{count} выбрано",maxSelections:"Доступно {maxCount}",noResults:"Совпадений не найдено."},className:{label:"ui "+(i.dropdown_labels_color||"red")+" label"},action:s.semDropdownAction}),d(l.$viewValue)}),a.items&&(e.isFunction(a.items)||e.isFunction(a.items.then))||a.$watch("items",function(e,t){e&&e.length&&(1!==m.promise.$$state.status?m.resolve(e):c(e),p.hasClass("js-was-empty")&&(p.removeClass("disabled"),o(l.$viewValue)))},!0),a.$watch(function(){return l.$viewValue},function(t,a){var i=p.dropdown("get value");t==i&&!_.isBoolean(t)&&!_.isNumber(t)||e.equals(t,i)||(void 0==t||f?d(l.$viewValue):o(t))})}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semErrorLabel",["errorLabelProvider",function(e){function a(a,i,n){var r,s,l=t(i),c=n.labelNamespace;if(!c)throw new Error("Не задана область видимости");r=function(){var e=l.siblings("input"),t="attr";return e.length||(e=l.siblings(".ui.input").find("input").eq(0),e.length||(e=l.siblings(".dropdown"),t="data",e.length||(e=l.siblings(".js-label-target")))),e[t]("name")}(),s=e.getLabel(c,r),function(e){l.text(e.title),e.class&&l.addClass(e.class),l.addClass("sem-error-label")}(s)}return{restrict:"EA",link:a,replace:!0,template:'<div class="ui top pointing basic label"></div>'}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semPopup",[function(){return{restrict:"EA",scope:!1,link:function(e,a,i,n){var r=t(a),s={content:i.semPopupContent,title:i.semPopupTitle,variation:i.semPopupVariation,position:i.semPopupPosition||"top center",onShow:function(){var e=t(this),a=e.find(".content"),n=e.find(".header");n.length||(n=t('<div class="header"></div>'),n.insertBefore(a)),a.html(i.semPopupContent),n.html(i.semPopupTitle)}};r.is("input")&&(s.on="focus"),r.popup(s)}}}])}(angular,jQueryApp),function(e){"use strict";e.module("UIElements").provider("errorLabelProvider",[function(){var e={title:"Поле не заполнено"},t={fps1:{first_name:{title:"Имя не заполнено"},last_name:{title:"Фамилия не заполнена"},citizenship:{title:"Гражданство не выбрано"},person_document_issue_date:{title:"Дата выдачи документа не заполнена"},document:{title:"Тип документа не выбран"},address_registration:{title:"Не все обязательные поля адреса заполнены"},person_phone:{title:"Телефон не заполнен"}}};this.$get=function(){return{getLabel:function(a,i){return i&&t[a][i]||e}}}}])}(angular),function(e){e.module("appMessage",[])}(angular),function(e){e.module("appMessage").directive("messages",["CONSTS",function(e){return{restrict:"EA",replace:!0,templateUrl:e.pathToModules+"shared/appMessage/views/messages_template.html"}}])}(angular),function(e){e.module("appMessage").factory("Messages",["$rootScope","$timeout",function(e,t){function a(a,r,s,l){var c={type:a,msg:r,close:function(){n(i(this))},isList:l};e.aborting||(e.messages.push(c),void 0!==s&&s>0&&t(c.close,s))}function i(t){return e.messages.indexOf(t)}function n(t){e.messages.splice(t,1)}return e.messages=[],{error:a.bind(null,"error"),warning:a.bind(null,"warning"),info:a.bind(null,"info"),success:a.bind(null,"success")}}])}(angular),function(e){"use strict";e.module("priceSlider",[])}(angular),function(e,t){"use strict";e.module("priceSlider").directive("priceSlider",["$timeout",function(e){function a(a,i,n,r){var s=t(i),l=t(a.popoversQuery),c=t(".car_price-bg-line"),o=s.slider({min:a.minCarPrice||0,max:a.maxCarPrice||1e6,step:1e3,slide:function(e,t){r.$setViewValue(1e3*Math.floor(t.value/1e3)),t.handle&&c.css("width",t.handle.style.left)},change:function(t,a){e(function(){a.handle&&c.css("width",a.handle.style.left)},0)},create:function(e,a){t(this).find(".ui-slider-handle").append(l)}});a.$watch(function(){return r.$viewValue},function(e,t){e&&e!==t&&(o.slider("value",e),a.modelCarCost=e)}),a.$watch("minCarPrice",function(e){void 0!==e&&(s.slider("option","min",+(e||0)),o.slider("value",r.$viewValue))}),a.$watch("maxCarPrice",function(e){void 0!==e&&(s.slider("option","max",+(e||0)),o.slider("value",r.$viewValue))}),a.changeModelCarCost=function(){r.$setViewValue(a.modelCarCost)},a.keyupModelCarCost=function(e){13===e.keyCode&&a.changeModelCarCost()},a.$on("$destroy",function(e){s.slider("destroy")})}return{restrict:"EA",require:"ngModel",link:a,scope:{minCarPrice:"=",maxCarPrice:"=",popoversQuery:"="},template:'<div hidden><div class="car_price-popover"><input price-formatter type="text" ng-model="modelCarCost" ng-keyup="keyupModelCarCost($event)" ng-blur="changeModelCarCost()" class="car_price-popover-input"><span class="car_price-popover-triangle"></span></div></div><div class="car_price-bg-line"></div><div class="car_price-min_value">{{(minCarPrice) | priceFormatter}}р.</div><div class="car_price-max_value">{{(maxCarPrice) | priceFormatter}}р.</div>'}}])}(angular,jQueryApp),function(e){"use strict";e.module("dadata",[])}(angular),function(e,t){"use strict";e.module("dadata").directive("dadata",["$timeout","CONSTS",function(e,a){function i(i,n,r){function s(e){o.append(t("<div/>").text(e)),o.show()}var l=r.dadataType,c=t(n),o=c.find(".js-dadata-messages");o.hide(),t(n).find("[dadata-target]").suggestions({serviceUrl:"https://dadata.ru/api/v2",token:a.DADATA_TOKEN,type:"simple"==l?"ADDRESS":l.toUpperCase(),onSelect:function(t){var a=t.data;o.empty(),o.hide(),"simple"===l&&(i.targetObj=a),"address"===l&&(e(function(){i.targetObj.full=t.value},200),i.targetObj.street=a.street_with_type||null,i.targetObj.city=a.region_with_type||null,i.targetObj.kladr=a.kladr_id||null,i.targetObj.house=a.house||null,i.targetObj.housing=a.block||null,i.targetObj.flat=a.flat||null,i.targetObj.postal_index=a.postal_code||null,i.targetObj.house||s("Введите номер дома."),i.targetObj.city||s("Введите название города или области."),i.targetObj.street||s("Введите название улицы."))}})}return{restrict:"A",link:i,scope:{targetObj:"=dadata"}}}])}(angular,jQueryApp),function(e){e.module("mainContent",[])}(angular),function(e){e.module("carFilter",[])}(angular),function(e){"use strict";e.module("carFilter").controller("carFilterCtrl",["$scope","Dictionary","$rootScope","policyOrderingService","calculatorService","calculatorStepsService","CONSTS","Messages","$http","$q","addingDocumentsService","moduleType","smsService","letterService","$timeout","$filter",function(e,t,a,i,n,r,s,l,c,o,d,u,p,m,g,v){function f(){var t=(new Date).getFullYear()-e.calculation.car_manufacturing_year;e.calculationInterParams.mileage=e.calculationInterParams.mileage||2e4*t}function h(t){t&&(e.calculationInterParams.exploitation_area=t.id,e.calculationInterParams.exploitation_area_title=t.title)}function b(t){t&&(e.calculationInterParams.owner_registration=t.id,e.calculationInterParams.owner_registration_title=t.title)}function y(e,t){return _.forEach(e,function(e){e.priority=s.explotationAreaPriority;var a=_.find(t,function(t){return e.id===t.id});a&&a.priority&&(e.priority=a.priority)}),_.sortBy(e,["priority"])}var w=new Date,k=a.currentBrand;e.calculatorParams=n.calculatorOtherParams;var x=["","Если Вы не нашли своего региона, обратитесь по телефону - "+a.currentBrand.support_phone_number||""],S=["Бесплатная доставка в течение 2-х дней","Бесплатная доставка день в день","Платная доставка в течении суток","Доставка в течении 2-х дней"],P=["Оформление в офисе","Оформление в офисе - г. Санкт-Петербург, ул. Белоостровская, 22, офис 507"];e.params={ownerRegistrationSignature:x[a.currentBrand.owner_registration_sign_index||0],deliveryInOfficeTitle:P[a.currentBrand.delivery_in_office_title_index||0],deliveryTypeTitle:S[a.currentBrand.delivery_type_title_index||0]},e.sendLetterBeforeOrder=i.sendLetterBeforeOrder,e.carFilterStep=1,e.selectedCar={},e.calculation=n.calculation,e.carFilterTemplates=r.bigsStepsTepmplates,e.driversAreInvalid=r.driversAreInvalid,e.clientParams={client_name:"",client_phone:"",sms_is_visible:!1,client_params_are_disabled:!1,client_is_agree:!(!a.currentBrand.defaultValues||!a.currentBrand.defaultValues.client_is_agree)&&a.currentBrand.defaultValues.client_is_agree,toggleClientIsAgree:function(){e.clientParams.client_is_agree=!e.clientParams.client_is_agree}},e.dicts={},e.labels={},e.labels.owner_registration="alternativa"===a.currentBrandName?"Выберите регион прописки собственника:":"Выберите регион регистрации собственника:",e.labels.exploitation_area="alternativa"===a.currentBrandName?"Выберите регион прописки собственника:":"Выберите регион эксплуатации автомобиля:";var C={vzrInsurancePeriods:["health"],vzrAgeCategory:["health"],vzrSportType:["health"],vzrSportKind:["health"],countries:["vzr"],adultsCount:["vzr"],childrenCount:["vzr"],yesNo:["vzr"],currencies:["vzr"],insuranceSums:["vzr"],vzrInsuranceDay:["vzr"],driversCountOsagoSimple:["usago"]};_.forEach(C,function(a,i){-1!==a.indexOf(u)&&t.getItems(i).then(function(t){e.dicts[i]=t,"countries"===i&&(e.dicts.countries=_.filter(t,"title"))})}),e.showSMSform=function(){e.clientParams.client_params_are_disabled=!0,e.clientParams.send_sms_text=!0,e.clientParams.sms_is_visible=!0,e.calculation.client_name=e.clientParams.client_name||e.calculation.client_name,e.calculation.client_phone=e.clientParams.client_phone||e.calculation.client_phone,e.clientParams.is_test_phone=e.calculation.client_phone===s.testPhone,e.clientParams.is_test_phone?(e.clientParams.sms_is_visible=!0,e.clientParams.client_params_are_disabled=!1):p.sendCode(e.calculation.client_phone).then(function(t){p.codeSent(t.data)&&(e.clientParams.sms_is_visible=!0),e.clientParams.client_params_are_disabled=!1})},e.showSMSformOsago=function(){e.calculationInterParams.client_params_are_disabled=!0,e.clientParams.send_sms_text=!0,e.calculation.client_name=e.calculationInterParams.client_name||e.calculation.client_name,e.calculation.client_phone=e.calculationInterParams.client_phone||e.calculation.client_phone,p.sendCode(e.calculation.client_phone).then(function(t){p.codeSent(t.data)&&(e.calculationInterParams.sms_is_visible=!0),e.calculationInterParams.client_params_are_disabled=!1})},e.calculateKaskoCarFilter=function(){e.$parent.calculateKasko()},e.confirmCode=function(){e.calculationInterParams.sms_button_is_disabled=!0,e.clientParams.sms_button_is_disabled=!0,e.calculationInterParams.confirm_code_is_incorrect=!1,e.calculatorParams.confirm_code_is_incorrect=!1;var t=e.clientParams.sms_code||e.calculationInterParams.sms_code,a=e.clientParams.client_phone||e.calculation.client_phone;if(e.clientParams.is_test_phone){var i=t===s.testCode&&"test"===s.ENV_TYPE;e.setConfirmation(i)}else p.confirmCode(t,a).then(function(t){var a=p.codeCorrect(t.data);e.setConfirmation(a)})},e.setConfirmation=function(t){t?"usago"===a.currentModuleType?(i.sendLetterUsago(!0),n.calculation.client_name=e.calculation.client_name,n.calculation.client_phone=e.calculation.client_phone,e.toNextStep("usago_sms_verification"),e.calculationInterParams.resultsAreVisible=!0):"osago"===a.currentModuleType?(e.sendLetterBeforeOrder(),e.toNextStep("sms_verification")):"casco"===a.currentModuleType&&(e.calculatorParams.resultsAreVisible=!0,a.currentBrand.sendLetterBeforeOrder&&e.sendLetterBeforeOrder()):(e.calculatorParams.confirm_code_is_incorrect=!0,e.calculationInterParams.confirm_code_is_incorrect=!0),e.clientParams.sms_button_is_disabled=!1,e.calculationInterParams.sms_button_is_disabled=!1},-1!==["laura","kaska24","broker-kapital","sbaru"].indexOf(a.currentBrandName)?t.getItems("driversChanging").then(function(t){e.driversChanging=_.filter(t,function(e){return e.id})}):t.getItems("driversChanging").then(function(t){e.driversChanging=t}),e.bigSteps=r.bigSteps,e.mainRegions=[],e.calculatorParams.cascoParams&&(a.paramsFromUrl&&e.$watch(function(){return r.getActiveStep()},function(i){"casco_year"==i.name&&a.paramsFromUrl.car_manufacturing_year&&(e.calculatorParams.cascoParams.selectYear({id:a.paramsFromUrl.car_manufacturing_year,title:a.paramsFromUrl.car_manufacturing_year}),e.toNextStep("casco_year")),"casco_all"==i.name&&a.paramsFromUrl.city&&t.getItems("exploitationArea").then(function(t){var a=t.find(function(e){return e.title=e});e.carFilterParams.was_clicked=!0,e.calculationInterParams.exploitation_area=+a.id,r.toNextSmallStep("casco_all")})}),e.calculatorParams.cascoParams.selectYear=function(t){e.calculationInterParams.car_manufacturing_year=t,e.calculationInterParams.payment_form="new"===t.type?107:105}),e.calculationInterParams=r.calculationInterParams,e.calculationInterParams.car_type_with_engine_power="petrosyan"===a.currentBrandName;var I=a.currentBrand.default_data?a.currentBrand.default_fields.first_step:{};for(var T in I)e.calculationInterParams["_"+T]=I[T];e.stepsParams={sport_kind:null,setAgeCategory:function(t){e.calculationInterParams.age_category=t,e.toNextStep("age_category")},setInsurancePeriod:function(t){e.calculationInterParams.insurance_period=t,e.toNextStep("insurance_period")},setSportKind:function(){e.calculationInterParams.sport_kind=_.find(e.dicts.vzrSportKind,function(t){return t.id==e.stepsParams.sport_kind}),e.toNextStep("sport_kind")},setSportType:function(t){e.calculationInterParams.sport_type=t,e.toNextStep("sport_type")}},e.carFilterParams={begin_date_max:(new Date).setMonth((new Date).getMonth()+1),brandSteps:r.brandSteps,allSteps:r.getAllSteps(),ownerRegistrationViewIsFull:!1,getCompanyTitle:function(){return n.getSelectedResult().insurance_company.title},selectedResult:function(){return n.getSelectedResult()},was_clicked:!1,setIsEarlierInsurance:function(t){e.calculationInterParams.is_earlier_insurance=!!t,e.toNextStep("is_earlier_insurance")},setIsCredit:function(t){e.calculationInterParams.is_credit=!!t,e.toNextStep("is_credit")},setIsCreditBank:function(t){e.calculationInterParams.is_credit=!!t,e.calculationInterParams.is_credit&&!e.calculationInterParams.credit_bank||e.toNextStep("is_credit_bank"),e.calculationInterParams.is_credit||(e.calculationInterParams.credit_bank=null)},setIsNewCar:function(t){e.calculationInterParams.is_new_car=!!t,e.toNextStep("is_new_car")},setHasTrailer:function(t){e.setActiveStep("has_trailer"),e.calculationInterParams.has_trailer=!!t,e.toNextStep("has_trailer")},hasTrailerIsUndefined:function(){return void 0===e.calculationInterParams.has_trailer},setEnginePower:function(t){e.enginePowerRanges.then(function(a){var i=_.find(a,function(e){return e.id==t});e.calculationInterParams.engine_power=i.value,e.calculationInterParams.engine_power_title=i.title,e.toNextStep("engine_power_ranges")})},setPersonType:function(t){e.personType.then(function(a){e.calculationInterParams.person_type=_.find(a,function(e){return e.id==t}),e.toNextStep("person_type")})},setReceiptRegion:function(t){e.receiptRegion.then(function(a){e.calculationInterParams.receipt_region=_.find(a,function(e){return e.id==t}),e.toNextStep("receipt_region")})},setCarType:function(t){e.carType.then(function(i){e.calculationInterParams.car_type=_.find(i,function(e){return e.id==t}),e.calculationInterParams.car_type_with_engine_power&&1===e.calculationInterParams.car_type&&"petrosyan"===a.currentBrandName&&e.toNextStep("engine_power"),e.toNextStep("car_type")})},toNextStepDeductibleValue:function(){e.calculatorParams.deductible_value=e.calculationInterParams.deductible_value,e.toNextStep("deductible_value")},insuranceDaysChanged:function(){var t=new Date(e.calculationInterParams.begin_date);if(t.setDate(t.getDate()+parseInt(e.calculationInterParams.date_difference)),!t.getTime())return e.calculationInterParams.begin_date;e.calculationInterParams.end_date=t}},e.calcTypes=[{id:"simple",m_id:"m-sample-calculation",title:"Примерный"},{id:"full",m_id:"m-accurate-calculation",title:"Точный (с данными КБМ водителей)"}],e.toManagerAfterSms=function(){e.clientParams.client_phone?e.sendToManager():e.postCalculateParams.third=!0},e.sendToManagerAfterSms=function(){var t=_.compatibleFormData(),a="";e.calculation.client_name,e.calculation.client_phone;a+="КАСКО.\n",t.append("message",a),d.send(t).then(function(){l.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){l.error("Не удалось отправить запрос.",6e3)})},e.onKeypressDecorator=function(e,t){if(13===Number(e.keyCode)&&"function"==typeof t)return t},e.setCalculationType=function(t){e.calculationInterParams.calculation_type=t},e.goNextDriverFull=function(){e.calculation.driver_set=e.calculationInterParams.drivers,e.toNextStep("drivers")},e.goNextDriver=function(t){var a=t+1;if(e.calculationInterParams.driverIsEditing)return e.calculationInterParams.currentDriverIndex=e.calculationInterParams.lastDriverIndex,void(e.calculationInterParams.driverIsEditing=!1);e.calculation.driver_set[t]=e.calculationInterParams.drivers[t],e.calculationInterParams.drivers_count&&e.calculationInterParams.drivers_count.id===a?e.toNextStep("drivers"):(e.calculationInterParams.currentDriverIndex=a,e.calculationInterParams.lastDriverIndex=a)},e.toEditDriver=function(t){var a=e.calculationInterParams.currentDriverIndex;e.calculationInterParams.currentDriverIndex=t,e.calculationInterParams.driverIsEditing=!0,e.calculationInterParams.lastDriverIndex=a},e.getActiveButtonClass=function(e){return e&&"active"||""},e.getCurrentStepObject=function(t){return t=r.getStepObjectByItem(t),e.carFilterParams.allSteps[t]},e.getCurrentStepIndex=r.getCurrentStepIndex,e.getCurrentStep=r.getCurrentStep,e.getIndexByStep=r.getIndexByStep,0===e.calculationInterParams.drivers.length&&e.calculationInterParams.drivers.push(r.getDefaultDriver()),e.changeDriversCount=function(){e.calculation.drivers_count=+e.calculationInterParams.drivers_count,e.calculation.is_multidrive=!e.calculation.drivers_count,e.calculation.driver_set.length=0;var t=e.calculation.drivers_count-e.calculationInterParams.drivers.length;t>0?_.times(t,function(){e.calculationInterParams.drivers.push(r.getDefaultDriver())}):e.calculationInterParams.drivers=_.reverse(_.slice(_.reverse(e.calculationInterParams.drivers),Math.abs(t)))},e.changeDriversCountKasko=function(t){e.calculationInterParams.drivers_count=t,e.calculation.drivers_count=t.id,e.calculationInterParams.drivers.length=0,e.calculation.driver_set.length=0,e.calculation.is_multidrive=!e.calculation.drivers_count,t.id&&(_.times(t.id,function(){e.calculationInterParams.drivers.push(r.getDefaultDriver())}),e.calculationInterParams.currentDriverIndex=0),e.toNextStep(r.getCurrentStep())},e.changeCalculationAtDate=function(t){var a=new Date;a.setDate(a.getDate()+t),e.calculation.calculation_at_date=v("date")(a,"yyyy-MM-dd"),e.toNextStep(r.getCurrentStep())},e.toNextStep=function(t){var i=r.getCurrentStep();e.carFilterParams.allSteps[i].toNextStep();var n=r.getNextStep(),s=e.bigSteps.getBigStep().name;if(!n&&"second"===s&&-1!==["kasko"].indexOf(u)||!n&&"second"===s&&e.calculatorParams.resultsAreVisible&&-1!==["casco"].indexOf(u)||"calc"===n&&(e.calculation.id&&a.currentBrand.with_sms||!a.currentBrand.with_sms))return e.calculateKaskoCarFilter(),r.toNextSmallStep(n);r.toNextSmallStep(t)},e.isEarlierInsuranceNext=function(){e.calculation.is_earlier_insurance=e.calculationInterParams.is_earlier_insurance,e.setActiveStep("is_earlier_insurance")},e.activeStep={},e.getActiveStep=function(){return e.activeStep=r.getActiveStep(),e.activeStep},e.requiringDrivers=n.requiringDrivers,e.getActiveStepSecond=function(){return e.activeStepSecond=r.getActiveStepSecond(),e.activeStepSecond},e._toPrevSmallStep=function(){r.toPrevSmallStep()},e.setActiveStep=r.setActiveStep,e.toggleOwnerRegistrationView=function(){e.carFilterParams.ownerRegistrationViewIsFull=!e.carFilterParams.ownerRegistrationViewIsFull},e.selectExploitationArea=function(t){t=t||e.calculationInterParams.exploitation_area,e.exploitationArea.then(function(a){h(_.find(a,function(e){return e.id==t})),e.toNextStep("exploitation_area")})},e.selectEarlierCompany=function(t){t=t||e.calculationInterParams.earlier_icompany,e.carFilterParams.earlierCompany.then(function(e){_.find(e,function(e){return e.id==t})})},e.carFilterParams.earlierCompany=t.getItems("earlierCompany"),e.selectOwnerRegistration=function(t){e.setActiveStep("owner_registration"),t=t||e.calculationInterParams.owner_registration,e.ownerRegistration.then(function(a){e.calculationInterParams.owner_registration||(e.calculationInterParams.owner_registration=_.find(a,function(e){return e.id==t}),e.calculationInterParams.owner_registration_title=e.calculationInterParams.owner_registration.title),e.toNextStep("owner_registration")})},e.selectIsEarlierInsurance=function(t){e.calculationInterParams.is_earlier_insurance=t,e.isEarlierInsuranceNext()},e.driversDateChanged=function(e){var t=new Date(e.birth_date),a=new Date(e.driving_experience_started),i=(new Date).setFullYear((new Date).getFullYear()-77),n=a<i;t.setDate(t.getDate()+1),e.dateIsInvalid=a-t<5679936e5||n},e.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},e.$root.dicts={},e.ownerRegistration=t.getItems("ownerRegistration").then(function(t){t=t.results?t.results:t;var i;if(e.calculation.owner_registration&&(i=_.find(t,function(t){return t.id==e.calculation.owner_registration}),b(i)),e.mainOwnerRegistrations=_.map(k.owner_registrations,function(e){return _.find(t,function(t){return a.currentBrand.owner_registrations_hack&&a.currentBrand.owner_registrations_hack[t.id]&&(t.title=a.currentBrand.owner_registrations_hack[t.id]),t.id===e})}),a.currentBrand.owner_registrations_expanded&&(e.mainOwnerRegistrations=a.currentBrand.owner_registrations_expanded.concat(e.mainOwnerRegistrations)),e.mainOwnerRegistrations.length)return e.mainOwnerRegistrations;if("ins-city"===a.currentBrandName){var n=_.findIndex(t,function(e){return 104==e.id}),r=_.findIndex(t,function(e){return 29871==e.id}),s=_.pullAt(t,[n,r]);t=s,e.calculationInterParams.exploitation_area=t[0].id,e.calculationInterParams.owner_registration=t[0].id}if("stratonov"===a.currentBrandName){var l=_.findIndex(t,function(e){return 104==e.id}),c=_.findIndex(t,function(e){return 29871==e.id}),o=_.findIndex(t,function(e){return 103==e.id}),d=_.findIndex(t,function(e){return 29870==e.id}),u=_.pullAt(t,[l,c,o,d]);t=u.concat(t)}return a.currentBrand.owner_registrations&&_.filter(t,function(e){return-1!==a.currentBrand.owner_registrations.indexOf(e.id)}),t}),a.cascoAllInit=function(){},e.exploitationArea=t.getItems("exploitationArea").then(function(t){t=t.results?t.results:t;var i=a.currentBrand.exploitation_areas_priority||[];if(i&&i.length&&(t=y(t,i)),"ins-city"===a.currentBrandName){var n=_.findIndex(t,function(e){return 30261==_.get(e,"id")}),r=_.findIndex(t,function(e){return 39154==_.get(e,"id")}),s=_.pullAt(t,[n,r]);t=s}if("stratonov"===a.currentBrandName){var l=_.findIndex(t,function(e){return 30261==_.get(e,"id")}),c=_.findIndex(t,function(e){return 39154==_.get(e,"id")}),o=_.findIndex(t,function(e){return 30291==_.get(e,"id")}),d=_.pullAt(t,[l,c,o]);t=d.concat(t)}var u;return e.calculation.exploitation_area&&(u=_.find(t,function(t){return t.id==e.calculation.exploitation_area}),h(u)),e.mainRegions=_.head(k.exploitation_areas)?_.map(k.exploitation_areas,function(e){return _.isObject(e)?(t.push(e),e):_.find(t,function(t){return a.currentBrand.exploitation_areas_hack&&a.currentBrand.exploitation_areas_hack[t.id]&&(t.title=a.currentBrand.exploitation_areas_hack[t.id]),t.id===e})}):t,a.currentBrand.owner_registrations_expanded&&(e.mainRegions=a.currentBrand.owner_registrations_expanded.concat(e.mainRegions)),"tumen"===a.currentBrandName&&_.forEach(e.mainRegions,function(e){e.id===a.currentBrand.exploitation_areas[0]&&(e.title="Тюменская область")}),window.b2bpolis_exploitation_areas&&"casco"===a.calcType?_.filter(t,function(e){return-1!==window.b2bpolis_exploitation_areas.indexOf(e.id)}):t}),-1!==["casco","kasko","usago"].indexOf(u)&&function(){var t={};t.regions="usago"===u?e.ownerRegistration:e.exploitationArea,t.checkCurrentAreaByIP=c({method:"GET",url:"https://suggestions.dadata.ru/suggestions/api/4_1/rs/detectAddressByIp",headers:{Authorization:"Token 840fc8bdabac6c26db9271f4a37906560d23e690"},timeout:2e3}),o.all(t).then(function(t){try{var i=null;"ins-city"==a.currentBrandName?e.calculationInterParams.exploitation_area="30261":i=_.find(t.regions,function(e){return e.title.toLowerCase()===t.checkCurrentAreaByIP.data.location.data.city.toLowerCase()})}catch(e){i=null}"usago"==u?e.calculationInterParams.owner_registration||(e.calculationInterParams.owner_registration=i?i.id:null):e.calculationInterParams.exploitation_area||(e.calculationInterParams.exploitation_area=i?i.id:null)}).catch(function(){if(!a.currentBrand.exploitation_areas){var t=a.currentBrand.exploitation_areas&&a.currentBrand.exploitation_areas[0];e.calculationInterParams.exploitation_area=t||30291}})}(),e.carType=t.getItems("carType").then(function(e){return a.currentBrand.car_type_ids?_.filter(e,function(e){return _.find(a.currentBrand.car_type_ids,function(t){return e.id===t})}):e}),e.personType=t.getItems("personTypes"),e.creditBank=t.getItems("creditBank"),e.receiptRegion=t.getItems("omsReceiptRegions"),e.enginePowerRanges=t.getItems("enginePower"),e.insuranceDuration=t.getItems("insuranceDuration").then(function(e){return _.map(a.currentBrand.insurance_duration_codes,function(t){return _.find(e,function(e){return e.code==t})})}),t.getItems("transmission").then(function(t){e.carFilterParams.transmission=t}),t.getItems("driveOfCar").then(function(t){e.carFilterParams.driveOfCar=t}),t.getItems("contributoryScheme").then(function(t){t=t.results||t,e.carFilterParams.contributoryScheme=_.map(a.currentBrand.contributory_schemas,function(e){return _.find(t,function(t){return t.id===e})})}),t.getItems("yesNo").then(function(t){e.carFilterParams.yesNo=t}),e.omsParams={client_phone:"",client_email:""},e.sendOmsConsultOrder=function(){m.sendOmsConsultOrder(e.omsParams.client_phone,e.omsParams.client_email).then(function(){l.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)})},e.isInit=!1,e.carSearch={title:""},e.allSelected=r.carAllSelected,e.setCarFilterStep=function(t){e.carFilterStep=t},e.monYears=_.range(w.getFullYear(),w.getFullYear()-55,-1),e.selectMonYear=function(t){_.isNil(t)||(e.calculation.car_manufacturing_year=e.monYears[t]),f(),r.toNextSmallStep("year")},e.$watch("carModel",function(t){t&&(e.monYearAction=e.carModel)},!0)}])}(angular),function(e){"use strict";e.module("carFilter").filter("carFilterYears",[function(){return function(e,t){if(""===t)return e||[];var a=[];e=e||[];for(var i=0,n=e.length;n>i;i++){var r=e[i].start_manufacturing_year,s=e[i].stop_manufacturing_year;t>=r&&t<=s&&a.push(e[i])}return a}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carFilter",["CONSTS",function(e){return{restrict:"EA",require:"ngModel",scope:{modelCarMark:"=cfModelCarMark",modelCarModel:"=cfModelCarModel",modelCarModelGroup:"=cfModelCarModelGroup",modelCarCost:"=cfModelCarCost",isInvalid:"="},controller:"carFilterCtrl",templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.html"}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carGroupModelsList",["CONSTS","Dictionary","carFilter","calculatorStepsService","calculatorService","brandingService","$rootScope",function(e,t,a,i,n,r,s){function l(e,a,r,l){e.carModelGroups=[],e.calculation=n.calculation,e.calculatorParams=n.calculatorOtherParams,e.calculationInterParams=i.calculationInterParams,e.$watch("carMarkId",function(a){a&&(e.carModelGroups=[],t.getItems("carModelGroups",{car_mark:a}).then(function(t){t=t.results?t.results:t,s.paramsFromUrl&&s.paramsFromUrl.car_model_group&&e.$watch(function(){return i.getActiveStep()},function(a){if("casco_car_model_group"==a.name){var i=t.find(function(e){return new RegExp("^"+e.title+"$","i").test(s.paramsFromUrl.car_model_group)});i&&e.selectCarModelGroup(i)}}),e.$parent.modelGroups=t,e.carModelGroups=t}))}),e.selectCarModelGroup=function(t,a){if(t)return l.$setViewValue(t.id),e.$parent.$parent.allSelected.carModelGroup=t,a||e.$parent.toNextStep(r.calcStepName||"car_model_group"),!1},e.$watch(function(){return l.$viewValue},function(a,i){a&&t.getItems("carModelGroups",{car_mark:e.carMarkId}).then(function(t){var i;t=t.results?t.results:t,i=_.find(t,function(e){return e.id===a}),e.selectCarModelGroup(i,!0)})})}var c=a.getDefaults();return{restrict:"EA",require:"ngModel",scope:{orderBy:"@",columns:"@",carMarkId:"=",isInvalid:"=",carManufacturingYear:"="},templateUrl:r.car_model_group_template||e.pathToModules+"shared/carFilter/views/car_filter.car_group_models_list.html",compile:function(e,t){return void 0===t.columns&&(t.columns=c.columns),void 0===t.orderBy&&(t.orderBy=c.orderBy),l}}}])}(angular),function(e){"use strict"
;e.module("carFilter").directive("carManufacturingYears",["CONSTS","carFilter",function(e,t){return{restrict:"EA",require:"ngModel",templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.car_manufacturing_years.html"}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carMarksList",["CONSTS","Dictionary","carFilter","$rootScope","calculatorStepsService",function(e,t,a,i,n){function r(e){return e>18?e<72?2:3:1}function s(e,a,s,c){e.carMarks=[],e.withMarkLogo=!!i.currentBrand.withMarkLogo,e.maxCarMarksLimit=9999,e.columnsCount=s.columnsCount?Number(s.columnsCount):6,e.calculationInterParams=n.calculationInterParams,e.carMarksLimit=e.limit||l.popularCarMarks.length||l.limit,t.getItems("carMarksByPopularity").then(function(t){t=t.results||t;var a=i.currentBrand.popular_car_marks;i.paramsFromUrl&&i.paramsFromUrl.car_mark&&e.$watch(function(){return n.getActiveStep()},function(a){if("casco_car_mark"==a.name){var n=t.find(function(e){return new RegExp("^"+e.title+"$","i").test(i.paramsFromUrl.car_mark)});n&&e.selectCarMark(n)}}),t=_.map(t,function(e,t){return i.currentBrand.popular_car_marks_rewrite?-1!==i.currentBrand.popular_car_marks_rewrite.indexOf(e.id)?e.popularity=1:e.popularity=3:e.popularity=r(t),e.priority=a&&-1!==a.indexOf(e.id)?0:1,e}),t=t.results?t.results:t,i.currentBrand.carsList&&(t=_.filter(t,function(e){return i.currentBrand.carsList.includes(e.id)})),e.carMarks=t,e.maxCarMarksLimit=t.length}),e.toggleAllMarks=function(){e.carMarksLimit=e.carMarksLimit===e.limit?e.maxCarMarksLimit:e.limit},e.selectCarMark=function(t,a){if(t)return c.$setViewValue(t.id),e.$parent.allSelected.carMark=t,a||n.toNextSmallStep(s.calcStepName||"car_mark"),!1},e.$watch(function(){return c.$viewValue},function(a,i){a!=i&&t.findItem("carMarks",a).then(function(t){e.selectCarMark(t,!0)})})}var l=a.getDefaults();return{restrict:"EA",require:"ngModel",scope:{orderBy:"@",limit:"@",columns:"@",carMarkSelected:"=ngModel",selectHandler:"=",isInvalid:"="},templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.car_marks_list.html",compile:function(e,t){return void 0===t.limit&&(t.limit=l.popularCarMarks.length||l.limit),void 0===t.columns&&(t.columns=l.columns),void 0===t.orderBy&&(t.orderBy=l.orderBy),s}}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carModelsList",["CONSTS","Dictionary","carFilter","calculatorStepsService","calculatorService","brandingService","requester","$rootScope",function(e,t,a,i,n,r,s,l){function c(e,a,r,c){function o(e){return _.map(e,function(e){return e.start_manufacturing_year||e.stop_manufacturing_year||(e.start_manufacturing_year=2e3,e.stop_manufacturing_year=2100),e})}function d(e){if(!e||!e.length)return 0;var t=e.slice(0).sort(function(e,t){return e-t}),a=Math.floor(t.length/2);return t.length%2==0?(t[a]+t[a-1])/2:t[a]}e.carModels=[],e.calculation=n.calculation,e.calculatorParams=n.calculatorOtherParams,e.calculationInterParams=i.calculationInterParams,e.selectedModelId={},e.$watch("carModelGroupId",function(a){a&&(e.carModels=[],t.getItems("carModelsByGroup",{car_mark:e.carMarkId,car_model_group:a}).then(function(t){t=o(t.results?t.results:t),e.$parent.carModel=t,e.carModels=t,l.paramsFromUrl&&l.paramsFromUrl.car_model&&e.$watch(function(){return i.getActiveStep()},function(a){if("casco_car_model"==a.name){var i=t.find(function(e){return new RegExp("^"+e.title+"$","i").test(l.paramsFromUrl.car_model)});i&&e.selectCarModel(i,!0)}}),1==t.length&&"car_model"===i.getCurrentStep()&&e.selectCarModel(t[0],!0)}))}),e.selectCarModel=function(t,a){var i;t&&(a&&(i="/rest/default/car_mark/"+e.carMarkId+"/car_model/"+t.id+"/?fields=prices&year="+e.calculation.car_manufacturing_year,e.$parent.toNextStep(r.calcStepName||"car_model"),e.$parent.$parent.isInit=!0,s.get(i).then(function(t){e.calculationInterParams.car_cost=d(t.data.prices)||(Number(t.data.min_price)+Number(t.data.max_price))/2,e.calculationInterParams.car_cost_max=function(){return Math.floor(_.max(t.data.prices)||t.data.max_price)}(),e.calculationInterParams.car_cost_min=function(){return Math.floor(_.min(t.data.prices)||t.data.min_price)}()})),c.$setViewValue(t.id),e.selectedModelId=t.id,e.$parent.$parent.allSelected.carModel=t)},e.$watch(function(){return c.$viewValue},function(a,i){a&&t.getItems("carModelsByGroup",{car_mark:e.carMarkId,car_model_group:e.carModelGroupId}).then(function(t){t=o(t.results?t.results:t);var i;i=_.find(t,function(e){return e.id===a}),e.selectCarModel(i)})})}var o=a.getDefaults();return{restrict:"EA",require:"ngModel",scope:{orderBy:"@",columns:"@",carMarkId:"=",carModelGroupId:"=",isInvalid:"=",carManufacturingYear:"="},templateUrl:r.car_model_template||e.pathToModules+"shared/carFilter/views/car_filter.car_models_list.html",compile:function(e,t){return void 0===t.columns&&(t.columns=o.columns),void 0===t.orderBy&&(t.orderBy=o.orderBy),c}}}])}(angular),function(e){"use strict";e.module("carFilter").provider("carFilter",[function(){var t={popularCarMarks:[4740,291,294,4737,297,303,3763,456,312,315,318,324,40612,330,333,336,339,3908,342,35526,345,348,351,354,357,360,363,366,372,375,3911,585,381,384,390,393,396,399,402,411,414,30590,426,429,432,435,438,441,444,447,450,552,33327,555,564,558],limit:72,columns:6,orderBy:"title"};this.setDefaults=function(a){e.extend(t,a)},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e){"use strict";e.module("carFilter").service("smsService",["$http","CONSTS","$rootScope",function(e,t,a){function i(e){return _.transformRequest(e)}function n(a){return e({url:t.proxyPathC+"smsc/sendcode.php",method:"POST",transformRequest:i,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:{phone_no:a}})}function r(i){return e({url:t.proxyUrl+"/sendcode?phones="+i+"&brand="+a.currentBrandName,method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}function s(a,n){return e({url:t.proxyPathC+"smsc/verify.php",method:"POST",transformRequest:i,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:{code:a,phones:n}})}function l(a,i){return e({url:t.proxyUrl+"/verifycode?phones="+i+"&code="+a,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}this.clientParams={client_name:"",client_phone:"",sms_is_visible:!1,client_params_are_disabled:!1,client_is_agree:!1,toggleClientIsAgree:function(){this.client_is_agree=!this.client_is_agree}},this.sendCode=function(e){return a.currentBrand.sendCodeViaApi?r(e):n(e)},this.confirmCode=function(e,t){return a.currentBrand.sendCodeViaApi?l(e,t):s(e,t)},this.codeCorrect=function(e){return _.isString(e)&&/(Код проверки верный)/.test(e)||/(Код проверки верный)/.test(e.message)||_.isString(e)&&/(784562354224965)/.test(e)},this.codeSent=function(e){return _.isString(e)&&/(отправлен)|your code/.test(e)||_.isString(e)&&/(784562354224965)/.test(e)}}])}(angular),function(e){e.module("preCalculator",[])}(angular),function(e){"use strict";e.module("preCalculator").controller("preCalculatorCtrl",["$scope","$state",function(e,t){e.typesToSelect={first:{title:"Планируете приобрести авто в РОЛЬФ",name:"first"},second:{title:"Планируете приобрести авто у другого Дилера",name:"second"}},e.preCalculatorParams={selectedType:null,is_second_step:!1,currentStep:"first",toNextStep:function(){"first"===e.preCalculatorParams.selectedType?t.go("index.postCalculator"):t.go("index.calculator.kasko")}}}])}(angular),function(e){e.module("postCalculator",[])}(angular),function(e){"use strict";e.module("postCalculator").controller("postCalculatorCtrl",["$scope","addingDocumentsService","Messages","$rootScope",function(e,t,a,i){e.postCalculatorParams={client_name:"",client_phone:"",client_email:"",message:"",carMark:!1},e.setCarMark=function(t){e.postCalculatorParams.carMark=t},e.preSendToManager=function(){var n=_.compatibleFormData(),r="",s=e.postCalculatorParams.client_name,l=e.postCalculatorParams.client_phone,c=e.postCalculatorParams.client_mail,o=e.postCalculatorParams.carMark;r+="Клиент просит ему перезвонить.\n\n",r+="Имя клиента: "+s+"\n",r+="Телефон клиента: "+l+"\n\n",r+="Email клиента: "+c+"\n\n",r+="Марка: "+o+"\n\n",n.append("message",r),n.append("addressType",o),n.append("moduleType",i.currentModuleType),t.send(n).then(function(){e.postCalculatorParams.button_is_disabled=!0,e.postCalculatorParams.is_visible=!0,a.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){e.postCalculatorParams.button_is_disabled=!0,a.error("Не удалось отправить запрос.",6e3)})}}])}(angular),function(e){e.module("calculatorSteps",[])}(angular),function(e){e.module("yaMetrika",[])}(angular),function(e){e.module("yaMetrika").service("yaMetrikaService",["brandingService","CONSTS",function(e,t){var a=e[t.currentBrand];a.ya_metrika_id?this.initYaMetrika=function(){!function(e,t,i){(t[i]=t[i]||[]).push(function(){try{t["yaCounter"+a.ya_metrika_id]=new Ya.Metrika({id:a.ya_metrika_id,clickmap:!1,trackLinks:!1,accurateTrackBounce:!0,webvisor:!1})}catch(e){console.log(e)}});var n=e.getElementsByTagName("script")[0],r=e.createElement("script"),s=function(){n.parentNode.insertBefore(r,n)};r.type="text/javascript",r.async=!0,r.src="https://mc.yandex.ru/metrika/watch.js","[object Opera]"==t.opera?e.addEventListener("DOMContentLoaded",s,!1):s()}(document,window,"yandex_metrika_callbacks")}:this.initYaMetrika=function(){}}])}(angular),function(e){e.module("heapAnalytics",[])}(angular),function(e){e.module("heapAnalytics").service("heapService",["brandingService","CONSTS",function(e,t){var a=e[t.currentBrand];a.heap_appid?this.initHeapAnalytics=function(){window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var a=t.forceSSL||"https:"===document.location.protocol,i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=(a?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n);for(var r=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],s=0;s<r.length;s++)heap[r[s]]=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r[s])},heap.load(a.heap_appid)}:this.initHeapAnalytics=function(){}}])}(angular),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.form.html",'<div ng-include="templates.step_2" ng-if="[\'first\', \'second\'].indexOf(bigSteps.getBigStep().name) !== -1"></div><div ui-view="step_3"></div><div ui-view="step_4" ng-if="getCurrentCalcType() === \'full\'"></div><div ui-view="step_5" ng-if="getCurrentCalcType() === \'simple\'"></div><div ui-view="step_6" ng-show="getCurrentCalcType()"></div><div ng-include="templates.program_list" class="js-kasko-result" ng-show="params.resultsAreVisible && bigSteps.getBigStep().name === \'third\'"></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.program_list.html",'<div ng-include="templates.program_list_manager" class="mt60"></div><div class="c-tac b-content-loading mt40" ng-if="!calculationResult.length"><i class="spinner loading icon big grey" tabindex="0" style="font-size: 40px;"></i></div><div class="ui form b-full-width-bg_white mt70 pos-rel" ng-if="calculationResult.length"><div move-to-step="" move-to-step-type="text"></div><div class="p20"><div class="b-results"><div class="ui grid five column stackable"><div class="b-result-kasko column pb80 pt20" align="center" ng-repeat="result in calculationResult | limitTo:5" ng-class="\'b-result-kasko--index-\' + $index"><div><div class="b-result-kasko_best-price"><span>Лучшая цена!</span></div><div class="b-result-kasko_head" title="{{result.insurance_company.title}}"><div class="b-result-kasko_insurance_company-logo mb5"><img ng-src="{{result.company_logo}}" alt=""></div><div class="b-result-kasko_insurance_company-title mb20 mt15"><h3><span ng-bind="result.insurance_company.title"></span></h3></div></div><div class="b-result-kasko_sum mt10 mb20 nowrap"><h3><span ng-if="result.sum_without_discount"><small class="c-stroke-text"><span ng-bind="result.sum_without_discount | priceFormatter:0:\'\':false"></span>.<small ng-bind="result.sum_without_discount | fractionalFormatter:2"></small> руб.</small><br><span ng-bind="result.program.sum | priceFormatter:0:\'\':false"></span>.<small ng-bind="result.program.sum | fractionalFormatter:2"></small> руб.</span> <span ng-if="!result.sum_without_discount"><span ng-bind="result.program.sum | priceFormatter:0:\'\':false"></span>.<small ng-bind="result.sum_without_discount | fractionalFormatter:2"></small> руб.</span></h3></div><div class="b-result-kasko_option_set"><div ng-repeat="option in result.program.option_set | filter:{\'is_active\': true}"><span ng-bind="option.title"></span></div></div><div class="b-result-kasko_actions" align="center"><button class="ui button green small" title="Перейти к заказу" ng-click="selectResult(result.id)" ya-metrika="m-program-list" type="button">Выбрать</button></div></div></div></div></div></div></div><div class="b-remaining-companies mt30"><div class="b-remaining-companies__item w100p" ng-repeat="item in calculationResult" ng-if="$index > 4"><div class="ui grid stackable doubling"><div class="row middle aligned"><div class="four wide column"><img ng-src="{{item.company_logo}}" class="b-remaining-companies__company-logo" alt="name of company" src="https://enter.b2bpolis.ru/media/logo_main_ins/22.png"></div><div class="four wide column"><h3><span ng-bind="item.insurance_company.title"></span></h3><div class="b-remaining-companies__kasko-sum tac"><h3><span><span ng-bind="item.program.sum | priceFormatter"></span> руб.</span></h3></div></div><div class="four wide column"><div ng-repeat="option in item.program.option_set | filter:{\'is_active\': true}" class="c-tac"><span ng-bind="option.title"></span></div></div><div class="four wide column c-tac"><div class="b-remaining-companies__kasko_actions"><button class="ui button green tiny" title="Перейти к заказу" ng-click="selectResult(item.id)" ng-bind="params.go_to_order_title" type="button"></button></div></div></div></div></div></div><div class="p20 mt30" ng-if="root.messages.length"><div class="ui error message"><ul class="list"><li ng-repeat="message in root.messages"><span ng-bind="message"></span></li></ul><i class="close icon" ng-click="root.messages.length = 0;"></i></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.program_list.remaining.html",'<div class="b-remaining-companies"><div class="b-remaining-companies__item w100p" ng-repeat="item in calculationResult" ng-if="$index > 4"><div class="ui grid stackable doubling"><div class="row middle aligned"><div class="four wide column"><img ng-src="{{item.company_logo}}" class="b-remaining-companies__company-logo" alt="name of company" src="https://enter.b2bpolis.ru/media/logo_main_ins/22.png"></div><div class="four wide column"><h3><span ng-bind="item.insurance_company.title"></span></h3><div class="b-remaining-companies__kasko-sum mb15 tac"><h3><span><span ng-bind="item.program.sum | priceFormatter"></span> руб.</span><br><small class="c-stroke-text" ng-if="item.sum_without_discount"><span ng-bind="item.sum_without_discount | priceFormatter:0:\'\':false"></span> руб.</small></h3></div></div><div class="four wide column"><div ng-repeat="option in item.program.option_set | filter:{\'is_active\': true}" class="c-tac"><span ng-bind="option.title"></span></div></div><div class="four wide column c-tac"><div class="b-remaining-companies__kasko_actions"><button class="ui button green tiny" title="Перейти к заказу" ng-click="selectResult(item.id)" ng-bind="selectResultLabel || \'Выбрать\'" type="button"></button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.step_2.html",'<div class="ui form b-full-width-bg_white css-small-sized-fields"><div class="p20"><div class="ui doubling stackable grid three column bottom aligned"><div class="column"><div class="field" align="left"><label for="id_is_legal_entity">Тип страхователя:</label><div class="ui search selection dropdown" id="id_is_legal_entity" sem-dropdown="" ng-model="calculation.is_legal_entity" sem-dropdown-items="dicts.isLegalEntity"></div></div></div><div class="column"><div class="field"><label>Срок страхования:</label><div class="ui search selection dropdown" id="id_insurance_duration" sem-dropdown="" ng-model="calculation.insurance_duration" sem-dropdown-items="dicts.insuranceDuration"></div></div></div><div class="column"><div class="field"><label for="id_calculation_at_date">Дата начала действия договора:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(-1, 0)}}" jdatepicker-only-future="true" placeholder="__.__.____" id="id_calculation_at_date" required="" ng-model="calculation.calculation_at_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/kasko/calculation.step_3.html",'<div class="css-cars-filter b-full-width-bg m0 mt30" ng-class="\'css-cars-filter--step-\' + bigSteps.getBigStep().name" style="font-size: 15px;" ng-show="!params.resultsAreVisible || bigSteps.getBigStep().name !== \'third\'"><div class="p20"><car-filter cf-model-car-mark="calculation.car_mark" cf-model-car-model="calculation.car_model" cf-model-car-model-group="calculation.car_model_group" cf-model-car-cost="calculation.car_cost"></car-filter></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/kasko/calculation.step_6.html",'<div class="ui form b-full-width-bg_white"><div class="p20"><div class="ui grid stackable four column bottom aligned"><div class="row"><div class="twelve wide column">&nbsp;</div><div class="column" align="right"><div class="field"><button class="button ui green" style="margin-right: 0;" ng-click="calculateKasko()" ng-class="{loading: params.isCalculationProgress}" ng-disabled="calculation_form.$invalid || disabledSubmitButton()" type="button">Рассчитать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorStepsC/views/second_big_step.html",'<div><div class="ui large labels" ng-class="$root.currentBrand.steps_buttons_color"><div class="ui label basic mb10" ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).getLabelTitle()"><span ng-bind="getCurrentStepObject(item).getLabelTitle()"></span> <i class="icon delete" ng-click="setActiveStep(getCurrentStepObject(item).name)" ng-keydown="$event.keyCode == 13 && setActiveStep(getCurrentStepObject(item).name)" tabindex="0"></i></div></div><div class="p20" ng-show="getActiveStepSecond().name !== carFilterParams.brandSteps.second[0]"><div class="ui divider" style="border-top-style: dashed;"></div></div><div ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).name === getActiveStepSecond().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/calculation.form.html",'<div ui-view="step_2" ng-show="bigSteps.getBigStep().name === \'first\'"></div><div ui-view="step_3"></div><div ng-show="bigSteps.getBigStep().name === \'first\'"><div ng-include="templates.step_4" ng-if="getCurrentCalcType() === \'full\'"></div><div ng-include="templates.calculation_step_5" ng-if="getCurrentCalcType() === \'simple\'"></div><div ui-view="step_6" ng-show="getCurrentCalcType()"></div><div class="js-kasko-result" ng-include="templates.program_list" ng-show="getCurrentCalcType()"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/calculation.program_list.html",'<div ng-if="params.resultsAreCreated && !calculationResult.length"><h2 class="b-content_title c-tac mb40">К сожалению, мы не можем оформить ОСАГО на данный автомобиль</h2></div><div class="ui form b-full-width-bg_white" ng-if="calculationResult.length"><div class="p20" ng-if="!params.isCalculationProgress"><div><table class="b-kasko-result ui very basic table"><tr><td><h4 ng-show="getResultWithKbm().variables.KBM.length || getResultWithKbm().variables.kbm">КБМ:</h4></td><td class="c-tar"></td></tr><tr><td><h3 class="b-content_title mt5" ng-repeat="kbm in getResultWithKbm().variables.KBM track by $index"><span ng-bind="cachedDrivers[$index].last_name"></span> <span ng-bind="cachedDrivers[$index].first_name"></span> <span ng-bind="cachedDrivers[$index].patronymic"></span> <span ng-if="cachedDrivers[$index].last_name">—</span> <span ng-bind="kbm"></span></h3><div ng-if="!cachedDrivers.length"><span ng-bind="getResultWithKbm().variables.kbm"></span></div></td><td></td></tr></table><div class="ui message small teal" ng-if="!getResultWithKbm().variables.KBM.length && !getResultWithKbm().variables.kbm && params.drivers_count != 0">В настоящий момент база РСА недоступна, расчет произведен без учета накопленных скидок. Пожалуйста, повторите расчет позднее</div></div><div class="css-divider-tilde ui divider horizontal header" ng-focus="focus=true">~</div><div ng-if="$root.currentBrand.old_module && $root.currentBrand.only_one"><h2 class="b-content_title c-tac">Стоимость ОСАГО для Вашего Авто - <span class="b-result_sum c-tac mt5" ng-init="result = calculationResult[0]; selectResult(result.id)"><span ng-bind="setSumWithOtherKbm(result) | priceFormatter:0:\'\':false"></span>. <small ng-bind="setSumWithOtherKbm(result) | fractionalFormatter:2"></small> руб.</span> <button class="m0 ui button" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.download_documents_button || $root.currentBrand.main_buttons_color)]" ya-metrika="m-upload-documents" ng-click="bigSteps.setBigStep(\'second\');scrollToAppElement()" type="button">Оформить</button></h2></div><div ng-if="!$root.currentBrand.old_module || !$root.currentBrand.only_one"><h1 class="b-content_title c-tac">Выберите компанию для оформления договора:</h1><div class="ui grid three column bottom aligned mt30"><div class="b-result column" align="center" tabindex="0" ya-metrika="m-insurance-company" ng-repeat="result in calculationResult" ng-if="result.program.sum && result.program.sum != 0" ng-mousedown="selectResult(result.id)" ng-keypress="$event.keyCode == 13 && selectResult(result.id)" ng-class="{\'b-result--selected\': result.id === root.selectedResult.id}"><div><img ng-src="{{result.company_logo}}" alt=""><div class="b-result_select"><i class="icon checkmark"></i></div><div class="b-result_sum c-tac mt5">{{result.program.sum | priceFormatter:0:\'\':false}}.{{result.program.sum | fractionalFormatter:2}} руб.</div></div></div></div><div class="mt55 c-tac"><button class="m0 ui button" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.download_documents_button || $root.currentBrand.main_buttons_color)]" ng-disabled="disabledFormationPolicyButton() || calculation_form.$invalid || !calculationResult.length || !root.selectedResult" ya-metrika="m-upload-documents" ng-click="bigSteps.setBigStep(\'second\');scrollToAppElement()" type="button"><span></span> <strong>Продолжить</strong></button></div></div></div></div><div class="p20 mt30" ng-if="root.messages.length"><div class="ui error message"><ul class="list"><li ng-repeat="message in root.messages"><span ng-bind="message"></span></li></ul><i class="close icon" ng-click="root.messages.length = 0;"></i></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_2.html",'<div class="ui form b-full-width-bg_white css-small-sized-fields"><div class="p20"><div class="ui stackable grid three column bottom aligned"><div class="column"><div class="field" align="left"><label for="id_is_legal_entity">Тип собственника:</label><div class="ui search selection dropdown" id="id_is_legal_entity" sem-dropdown="" ng-change="fieldChanged(\'is_legal_entity\')" ng-model="calculation.is_legal_entity" sem-dropdown-items="dicts.isLegalEntity"></div></div></div><div class="column"><div class="field"><label>Период использования ТС:</label><div class="ui search selection dropdown" id="id_insurance_duration" sem-dropdown="" ng-model="calculation.insurance_duration" sem-dropdown-items="dynamicDicts.insuranceDuration"></div></div></div><div class="column"><div class="field"><label for="id_calculation_at_date">Дата начала действия договора:</label><div class="ui right pointing label" ng-show="calculation.calculation_at_date && calculation_date_form.calculation_at_date.$invalid" style="width: 190px;text-align: left;position: absolute;z-index: 4;right: 95%;top: 35px;">Застраховаться можно только с завтрашнего дня</div><div class="ui icon input" ng-form="calculation_date_form"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(-1, 0)}}" jdatepicker-only-future="true" placeholder="__.__.____" name="calculation_at_date" id="id_calculation_at_date" required="" ng-model="calculation.calculation_at_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_3.html",'<div class="css-cars-filter b-full-width-bg m0 mt30" style="font-size: 15px;"><div class="p20"><car-filter cf-model-car-mark="calculation.car_mark" cf-model-car-model="calculation.car_model" cf-model-car-model-group="calculation.car_model_group" cf-model-car-cost="calculation.car_cost"></car-filter></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_4.html",'<div class="ui form b-full-width-bg pt55 m0 mt10"><div class="p20"><div class="mb70" ng-include="templates.tech_inspection" ng-if="$root.currentBrand.has_checking_tech_inspection"></div><div class="nowrap css-show-errors ui grid stackable relaxed"><div class="row"><div class="four wide column"><div class="field mt15" align="left"><label for="id_drivers_count">Количество водителей:</label><div class="ui search selection dropdown" id="id_drivers_count" sem-dropdown="" ng-model="params.drivers_count_full" ng-class="{disabled: calculation.is_legal_entity}" ng-change="driversCountChanged()" sem-dropdown-items="dicts.driversCountOsagoFull"></div></div></div><div class="twelve wide column b-drivers_osago"><h3 class="b-drivers_osago_person-type b-content_title" ng-if="drivers.length"><i class="icon" ng-class="\'user\' + (drivers.length > 1 ? \'s\' : \'\')"></i> Водители:</h3><div ng-repeat="driver in drivers" ng-form="driver_form" ng-model="driver" class="is-form"><div class="ui grid three column stackable"><div class="row"><div class="column"><div class="field"><label for="id_driver_osago_last_name_{{$index}}">Фамилия:</label> <input type="text" class="ui input" required="" ng-pattern="params.name_pattern" id="id_driver_osago_last_name_{{$index}}" ng-model="driver.last_name" ng-change="$root.clientDataForMail.drivers[$index].last_name = driver.last_name"></div></div><div class="column"><div class="field"><label for="id_driver_osago_first_name_{{$index}}">Имя:</label> <input type="text" class="ui input" required="" ng-pattern="params.name_pattern" id="id_driver_osago_first_name_{{$index}}" ng-model="driver.first_name" ng-change="$root.clientDataForMail.drivers[$index].first_name = driver.first_name"></div></div><div class="column"><div class="field"><label for="id_driver_osago_patronymic_{{$index}}">Отчество:</label> <input type="text" class="ui input" ng-pattern="params.name_pattern" id="id_driver_osago_patronymic_{{$index}}" ng-model="driver.patronymic" ng-change="$root.clientDataForMail.drivers[$index].patronymic = driver.patronymic"></div></div></div><div class="row"><div class="column"><div class="field"><label for="id_driver_license_series">Водительское<br>удостоверение:</label><div class="ui fields"><div class="seven wide field"><input type="text" class="ui input" required="" maxlength="4" minlength="4" placeholder="Серия" id="id_driver_license_series" ng-model="driver.driver_license.series" ng-change="$root.clientDataForMail.drivers[$index].license.series = driver.driver_license.series"></div><div class="nine wide field"><input type="text" class="ui input" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" id="id_driver_license_number" ng-model="driver.driver_license.number" ng-change="$root.clientDataForMail.drivers[$index].license.number = driver.driver_license.number"></div></div></div></div><div class="column"><div class="field" ng-class="{error: driver.dateIsInvalid}"><label for="id_driving_experience_started_{{$index}}"><br>Дата начала стажа:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(0, 73) }}" jdatepicker-only-past="true" ng-change="driversDateChanged(driver)" placeholder="__.__.____" id="id_driving_experience_started_{{$index}}" required="" ng-model="driver.driving_experience_started"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field" ng-class="{error: driver.dateIsInvalid}"><label for="id_driver_birth_date_{{$index}}"><br>Дата рождения:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(18, 91) }}" jdatepicker-only-past="true" ng-change="driversDateChanged(driver);" placeholder="__.__.____" id="id_driver_birth_date_{{$index}}" required="" ng-model="driver.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div><div class="ui divider mt30 mb15" ng-if="drivers.length > 1 && (drivers.length - 1) !== $index"></div></div><div ng-repeat="person in persons" ng-form="person_form" ng-model="person" class="is-form"><div class="ui loader"></div><h3 class="b-drivers_osago_person-type b-content_title">Собственник:</h3><div class="ui grid four column stackable" ng-if="!calculation.is_legal_entity"><div class="row"><div class="column"><div class="field"><label for="id_person_osago_last_name_{{$index}}">Фамилия:</label> <input type="text" required="" ng-pattern="params.name_pattern" id="id_person_osago_last_name_{{$index}}" ng-model="person.last_name"></div></div><div class="column"><div class="field"><label for="id_person_osago_first_name_{{$index}}">Имя:</label> <input type="text" required="" ng-pattern="params.name_pattern" id="id_person_osago_first_name_{{$index}}" ng-model="person.first_name"></div></div><div class="column"><div class="field"><label for="id_person_osago_patronymic_{{$index}}">Отчество:</label> <input type="text" ng-pattern="params.name_pattern" id="id_person_osago_patronymic_{{$index}}" ng-model="person.patronymic"></div></div><div class="column"><div class="field"><label for="id_person_birth_date_{{$index}}">Дата рождения:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 90)}}" placeholder="__.__.____" id="id_person_birth_date_{{$index}}" required="" ng-model="person.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div><div class="row"><div class="six wide column"><div class="field"><label for="id_person_passport">Паспорт:</label><div class="ui fields"><div class="seven wide field"><input type="text" required="" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_passport" ng-model="person.passport.series"></div><div class="nine wide field"><input type="text" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" ng-model="person.passport.number"></div></div></div></div><div class="four wide column"><div class="field"><label for="id_person_passport_issue_date_{{$index}}">Дата выдачи:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 26)}}" placeholder="__.__.____" id="id_person_passport_issue_date_{{$index}}" required="" ng-model="person.passport.issue_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="six wide column" ng-if="isVisible(\'vin_number\')"><div class="field"><label for="id_vin_number_np">VIN:</label> <input type="text" ng-model="osagoParams.vin_number" minlength="17" maxlength="17" required="" id="id_vin_number_np"><div class="ui label pointing basic top grey c-vin-error-label css-can-wrap" ng-show="osagoParams.vin_number.length === 17">Не совпадает контрольная сумма VIN</div></div></div></div></div><div class="ui grid three column stackable" ng-if="calculation.is_legal_entity"><div class="row"><div class="column" ng-if="isVisible(\'vin_number\')"><div class="field"><label for="id_vin_number">VIN:</label> <input type="text" ng-model="osagoParams.vin_number" input-vin-number="" minlength="17" maxlength="17" required="" id="id_vin_number"><div class="ui label pointing basic top grey c-vin-error-label css-can-wrap" ng-show="osagoParams.vin_number.length === 17">Не совпадает контрольная сумма VIN</div></div></div><div class="column"><div class="field"><label for="id_legal_person_inn">ИНН:</label> <input type="text" required="" input-integer="" id="id_legal_person_inn" ng-model="osagoParams.legal_person.inn"></div></div><div class="column"><div class="field"><label for="id_legal_person_title">Наименование юр. лица:</label> <input type="text" required="" id="id_legal_person_title" ng-model="osagoParams.legal_person.title"></div></div></div></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_5.html",'<div class="ui form b-full-width-bg pt55 m0 mt10"><div class="p20"><div class="mb70" ng-include="templates.tech_inspection" ng-if="$root.currentBrand.has_checking_tech_inspection"></div><div class="nowrap css-show-errors ui grid stackable relaxed"><div class="four wide column"><div class="field"><label>Количество водителей:</label><div class="ui search selection dropdown" sem-dropdown="" ng-click="params.field_was_clicked = true;" ng-focus="params.field_was_clicked = true;" ng-class="{disabled: calculation.is_legal_entity}" ng-change="params.field_was_clicked && driversCountChangedSimple()" ng-model="params.drivers_count" sem-dropdown-items="dicts.driversCountOsagoSimple"></div></div></div><div class="five wide column"><div class="field" ng-repeat="driver in calculation.driver_set"><label>Возраст и стаж водителя:</label><div class="ui fields"><div class="eight wide field" ng-class="{\'error\': driver.age < 18 || driver.age > 87}"><input type="text" class="ui input" ng-model="driver.age" input-integer="" required=""></div><div class="eight wide field" ng-class="{\'error\': driver.age - driver.expirience < 18}"><input type="text" class="ui input" ng-model="driver.expirience" input-integer="" required=""></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_6.html",'<div class="ui form b-full-width-bg_white"><div class="p20"><div class="ui grid stackable four column bottom aligned"><div class="row"><div class="twelve wide column">&nbsp;</div><div class="column" align="right"><div class="field"><button class="ui button" ng-click="calculateOsago()" ya-metrika="m-calulate-osago" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.perform_the_calculation_button || $root.currentBrand.main_buttons_color)]" ng-disabled="calculation_form.$invalid || disabledSubmitButton()" type="button"><span></span> Рассчитать</button></div></div></div></div></div><div ng-if="params.showSMSbeforeCalcForm && !calculationInterParams.sms_verification_passed"><div ng-include="templates.sms_step_osago"></div></div><h3 ng-if="params.isCalculationProgress" style="font-weight: 300; text-align: center;"><p>Подождите. Мы подбираем все возможные варианты.</p><i class="spinner loading icon big grey" tabindex="0" style="font-size: 40px;"></i></h3></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.tech_inspection.html",'<div class="ui buttons"><button class="ui button blue" ng-class="{basic: params.tech_inspection !== \'need_tech_inspection\'}" ng-click="params.tech_inspection = \'need_tech_inspection\'" type="button">Мне нужен техосмотр (для ТС от 2013 г.в.)</button> <button class="ui button blue" ng-class="{basic: params.tech_inspection !== \'has_tech_inspection\'}" ng-click="params.tech_inspection = \'has_tech_inspection\'" type="button">Есть действующий техосмотр</button></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.address_registration.html",'<div dadata="person.address_registration" dadata-type="address"><div class="fields"><div class="ten field wide"><label for="id_address_registration_postal_full">Введите полный адрес:</label><div class="ui transparent input"><input type="text" required="" dadata-target="" ng-blur="fieldBlurred()" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_registration)}" id="id_address_registration_postal_full" ng-model="person.address_registration.full" name="address_registration_postal_full"></div></div><div class="three field wide"><label>Корпус:</label><div class="ui transparent input"><input type="text" title="Корпус" ng-blur="fieldBlurred()" ng-model="person.address_registration.housing" name="address_registration_housing"></div></div><div class="three field wide"><label>Кв./офис:</label><div class="ui transparent input"><input type="text" title="Квартира" ng-blur="fieldBlurred()" ng-model="person.address_registration.flat" name="address_registration_flat"></div></div></div><div class="js-dadata-messages ui pointing red basic label"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.address_residential.html",'<div dadata="person.address_residential" dadata-type="address"><div class="fields"><div class="ten field wide"><label for="id_address_residential_postal_full">Введите полный адрес:</label><div class="ui transparent input"><input type="text" required="" dadata-target="" ng-change="addressIsValid(person.address_residential)" ng-blur="fieldBlurred()" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_residential)}" id="id_address_residential_postal_full" ng-model="person.address_residential.full" name="address_residential_postal_full"></div></div><div class="three field wide"><label>Корпус:</label><div class="ui transparent input"><input type="text" title="Корпус" ng-change="addressIsValid(person.address_residential)" ng-blur="fieldBlurred()" ng-model="person.address_residential.housing" name="address_residential_housing"></div></div><div class="three field wide"><label>Кв./офис:</label><div class="ui transparent input"><input type="text" title="Квартира" ng-change="addressIsValid(person.address_residential)" ng-blur="fieldBlurred()" ng-model="person.address_residential.flat" name="address_residential_flat"></div></div></div><div class="js-dadata-messages ui pointing red basic label"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.addresses_block.html",'<div class="b-addresses"><div class="b-address ui stackable grid"><div class="row"><div class="b-address_line column"><div class="p20"><div class="field" ng-class="{disabled: isDisabledForm}"><div class="b-addresses_checkboxes mb15"><strong>Адрес регистрации:</strong><sem-checkbox sem-label="Совпадает с фактическим" ng-model="person.is_same_address"></sem-checkbox></div><div ng-include="templates.address_registration"></div></div><div class="field" ng-class="{disabled: isDisabledForm}" style="padding-top: 10px;" ng-if="!person.is_same_address"><label class="mb15">Адрес проживания:</label><div ng-include="templates.address_residential"></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.car.html",'<div class="ui form b-car-form"><div class="p20"><h3 class="ui horizontal divider header"><i class="icon car"></i><span></span></h3><div class="ui grid stackable four column b-full-width-bg is-form" ng-form="car_form" check-in-rsa="params" check-in-rsa-send="{{car_form.$valid}}" ng-model="car"><div class="ui loader" ng-class="{active: rsaParams.is_sending}"></div><div class="row"><div class="sixteen wide column"><h2 class="b-content_title m0 mb15">Автомобиль <strong ng-if="params.car_mark" class="vam"><span ng-bind="params.car_mark"></span> — <span ng-bind="params.car_model_group"></span> — <span ng-bind="params.car_model"></span> \'<span ng-repeat="char in calculation.car_manufacturing_year | limitTo: -2 track by $index" ng-bind="char"></span></strong></h2></div></div><div class="row bottom aligned" ng-if="$root.currentBrand.car_selection_on_second_step"><div class="column"><div class="field"><div class="ui form"><div class="field"><label>Выберите год выпуска:</label><div sem-dropdown-items="monYears" class="ui selection dropdown" sem-dropdown="" required="required" sem-dropdown-placeholder="Не выбран" ng-class="$root.currentBrand.year_of_the_car_color" sem-dropdown-simple="true" ng-model="car.car_manufacturing_year"></div></div></div></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Укажите марку:</label><div class="ui selection search dropdown" ng-model="car.car_mark" ng-change="carMarksChanged()" required="required" sem-dropdown="" sem-dropdown-items="carMarks" sem-dropdown-placeholder="Не выбрана"></div></div></div><div class="column"><div class="field" ng-class="{disabled: !car.car_mark || isDisabledForm}"><label>Укажите модель:</label><div class="ui selection search dropdown" ng-model="car.car_model_group" ng-change="carModelGroupChanged()" required="required" sem-dropdown="" sem-dropdown-items="carModelGroups" sem-dropdown-placeholder="Не выбрана"></div></div></div><div class="column"><div class="field" ng-class="{disabled: !car.car_model_group || isDisabledForm}"><label>Укажите модификацию:</label><div class="ui selection search dropdown" ng-model="car.car_model" ng-change="carModelChanged()" required="required" sem-dropdown="" sem-dropdown-items="carModels" sem-dropdown-placeholder="Не выбрана"></div></div></div></div><div class="row top aligned"><div class="column" style="padding-right: 0"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Тип номера:</label><div class="ui selection search dropdown" ng-model="params.number_type" sem-dropdown="" sem-dropdown-items="numberType" sem-dropdown-placeholder=""></div></div></div><div class="column" style="padding-right: 0"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_number_plate">Номер:</label><div class="ui input" ng-if="params.number_type === \'vin_number\'"><input type="text" required="" maxlength="17" ng-minlength="17" ng-blur="fieldBlurred()" placeholder="Введите VIN-номер автомобиля" id="id_vin_number" name="vin_number" ng-model="car.vin_number"></div><div class="ui label pointing basic top grey c-vin-error-label" ng-show="car.vin_number.length === 17 && params.number_type === \'vin_number\'">Не совпадает контрольная сумма VIN</div><div class="ui input" ng-if="params.number_type === \'car_body_number\'"><input type="text" required="" ng-blur="fieldBlurred()" name="car_body_number" placeholder="Введите номер кузова автомобиля" ng-model="car.car_body_number"></div><div class="ui input" ng-if="params.number_type === \'chassis_number\'"><input type="text" required="" name="chassis_number" ng-blur="fieldBlurred()" placeholder="Введите номер шасси автомобиля" ng-model="car.chassis_number"></div></div></div><div class="column" style="padding-right: 0"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_number_plate">Гос. рег. знак:</label> <input type="text" class="ui input" input-capitalize="" ng-blur="fieldBlurred()" maxlength="10" id="id_number_plate" name="number_plate" ng-model="car.number_plate"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_engine_power_loshad">Мощность, л.с.:</label> <input type="text" class="ui input" input-float="" ng-max="735" max-precision="2" maxlength="6" id="id_engine_power_loshad" name="engine_power_loshad" ng-blur="fieldBlurred()" ng-model="car.engine_power_loshad"></div></div></div><div class="row"><div class="column" style="padding-right: 0"><div class="field" ng-class="{disabled: isDisabledForm}"><label><sem-checkbox ng-model="params.car_document_type" sem-label="ПТС" sem-type="radio" name="car_document_type" value="vehicle_registration"></sem-checkbox><sem-checkbox ng-model="params.car_document_type" sem-label="СТС" sem-type="radio" class="ml10" name="car_document_type" value="vehicle_certificate"></sem-checkbox></label><div class="ui fields" ng-if="params.car_document_type === \'vehicle_registration\'"><div class="seven field wide mb10"><input type="text" class="ui input" name="vehicle_registration_series" required="" input-only="[А-Яа-я0-9]+" maxlength="4" ng-minlength="4" ng-blur="fieldBlurred()" placeholder="Серия" id="id_vehicle_registration_series" ng-model="car.vehicle_registration.series"></div><div class="nine field wide"><input type="text" class="ui input" name="vehicle_registration_number" placeholder="Номер" required="" input-integer="" ng-blur="fieldBlurred()" maxlength="6" ng-model="car.vehicle_registration.number"></div></div><div class="ui fields" ng-if="params.car_document_type === \'vehicle_certificate\'"><div class="seven field wide mb10"><input type="text" class="ui input" name="vehicle_certificate_series" required="" input-only="[А-Яа-я0-9]+" ng-blur="fieldBlurred()" maxlength="4" ng-minlength="4" placeholder="Серия" id="id_vehicle_certificate_series" ng-model="car.vehicle_certificate.series"></div><div class="nine field wide"><input type="text" class="ui input" name="vehicle_certificate_number" placeholder="Номер" required="" ng-blur="fieldBlurred()" input-integer="" maxlength="6" ng-model="car.vehicle_certificate.number"></div></div></div></div><div class="column" style="padding-right: 0"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_document_issue_date">Дата получения:</label><div class="ui icon input"><input type="text" class="ui input" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 20)}}" jdatepicker-only-past="true" name="document_issue_date" ng-change="fieldBlurred()" placeholder="__.__.____" id="id_document_issue_date" required="" ng-model="car.document_issue_date"> <i class="icon calendar circular blue inverted"></i></div></div></div><div class="column" style="padding-right: 0"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_mileage">Пробег, км:</label> <input type="text" class="ui input" maxlength="8" input-integer="" input-float="" id="id_mileage" ng-blur="fieldBlurred()" name="mileage" ng-model="car.mileage"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_engine_displacement">Объем двигателя, л:</label> <input type="text" class="ui input" input-float="" ng-blur="fieldBlurred()" ng-max="100" id="id_engine_displacement" name="engine_displacement" ng-model="car.engine_displacement"></div></div></div><div class="row" ng-if="calculatorParams.tech_inspection === \'need_tech_inspection\'"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_tire_mark">Марка шин:</label> <input type="text" class="ui input" id="id_tire_mark" name="tire_mark" ng-model="car.tire_mark"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Тип топлива:</label><div class="ui selection search dropdown" ng-model="fuel_type" sem-dropdown="" sem-dropdown-items="fuelType" sem-dropdown-placeholder="Не выбрано"></div></div></div></div><div class="js-check-in-rsa_message ui message" ng-class="rsaParams.message_type" ng-bind="rsaParams.message"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.person_block.html",'<div class="ui form"><div class="p20"><div ng-include="templates.person_roles"></div><div ng-if="!person.isDriver && person.personType === \'natural_person\' || person.showFioFields"><div class="ui grid stackable four column"><div class="row"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Фамилия</label> <input type="text" class="ui input" required="" name="last_name" ng-blur="fieldBlurred()" ng-pattern="params.name_pattern" placeholder="Петров" ng-model="person.last_name"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Имя</label> <input type="text" class="ui input" placeholder="Иван" required="" ng-blur="fieldBlurred()" name="first_name" ng-pattern="params.name_pattern" ng-model="person.first_name"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Отчество</label> <input type="text" class="ui input" name="patronymic" ng-blur="fieldBlurred()" ng-pattern="params.name_pattern" placeholder="Александрович" ng-model="person.patronymic"></div></div><div class="column" ng-if="person.hasRole()"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_person_birth_date_{{$index}}">Дата рождения</label><div class="ui icon input"><input type="text" class="ui input" jdatepicker="" ng-blur="fieldBlurred()" jdatepicker-year-range="{{person.birthDateRange.yearRange}}" jdatepicker-max-date="{{person.birthDateRange.max}}" jdatepicker-min-date="{{person.birthDateRange.min}}" name="birth_date" placeholder="__.__.____" id="id_person_birth_date_{{$index}}" required="" ng-model="person.birth_date"> <i class="icon calendar circular blue inverted"></i></div></div></div></div></div></div><div ng-if="person.hasRole()"><div class="ui grid stackable four column"><div class="row"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_person_passport_series_{{$index}}">Серия и номер<br>паспорта</label><div class="ui fields"><div class="seven field wide mb10"><input type="text" class="ui input" name="person_passport_series" required="" ng-blur="fieldBlurred()" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_passport_series_{{$index}}" ng-model="person.passport.series"></div><div class="nine field wide"><input type="text" class="ui input" name="person_passport_number" placeholder="Номер" ng-blur="fieldBlurred()" required="" input-integer="" maxlength="6" minlength="6" ng-model="person.passport.number"></div></div></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_person_passport_issue_date_{{$index}}"><br>Дата выдачи</label><div class="ui icon input"><input type="text" class="ui input" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 20)}}" jdatepicker-only-past="true" name="passport_issue_date" placeholder="__.__.____" ng-change="fieldBlurred()" id="id_person_passport_issue_date_{{$index}}" required="" ng-model="person.passport.issue_date"> <i class="icon calendar circular blue inverted"></i></div></div></div><div class="eight wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_passport_issue_point"><br>Кем выдан</label> <input type="text" class="ui input" name="passport_issue_point" required="" ng-blur="fieldBlurred()" id="id_passport_issue_point" placeholder="Отделением УФМС по Санкт-Петербургу" ng-model="person.passport.issue_point"></div></div></div></div><div class="row-margin"><div ng-include="templates.addresses_block" ng-if="person.hasRole() || person.isDriver"></div></div></div><div class="js-check-in-rsa_message ui message" ng-class="rsaParams.message_type" ng-bind="rsaParams.message"></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.person_block_legal.html",'<div class="ui form"><div class="p20"><div ng-include="templates.person_roles"></div><div class="ui grid stackable"><div class="row"><div class="four wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_title_{{$index}}">Название:</label> <input type="text" required="" id="id_title_{{$index}}" name="legal_person_title" ng-model="person.title"></div></div><div class="four wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_inn_{{$index}}">ИНН:</label> <input type="text" required="" id="id_inn_{{$index}}" input-integer="" minlength="10" maxlength="10" name="legal_person_inn" ng-model="person.inn"></div></div><div class="four wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_ogrn_{{$index}}">ОГРН:</label> <input type="text" id="id_ogrn_{{$index}}" name="legal_person_ogrn" input-integer="" minlength="13" maxlength="13" ng-model="person.ogrn"></div></div></div></div></div><div class="b-addresses" ng-if="person.hasRole()"><div class="b-address ui stackable grid"><div class="row"><div class="b-address_line column"><div class="p20"><div class="field" ng-class="{disabled: isDisabledForm}"><label class="mb15">Юридический адрес:</label><div ng-include="templates.address_registration"></div></div></div></div></div></div></div><div align="right" class="mt15" ng-if="person.hasRole() && currentUser.is_legal_person"><a href="" user-to-person="" ng-model="person">Заполнить данными из профиля</a></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.person_roles.html",'<div class="ui grid stackable"><div class="row"><div class="eleven wide column"></div><div class="five wide column"><div class="field without-dropdown-placeholder" style="min-width: 140px;" ng-class="{disabled: isDisabledForm}"><div ng-if="!$index"><div class="ui floating blue dropdown button small" ng-model="params.person_type" sem-dropdown="" ng-class="{disabled: isDisabledForm}" ng-change="addPerson({}, params.person_type)" sem-dropdown-action="select" sem-dropdown-items="insurantTypes" sem-dropdown-placeholder="Добавить участника договора"></div></div><h3 ng-if="$index" style="float:right;"><i ng-class="{disabled: isDisabledForm}" class="icon remove red" ng-click="removePerson(person)"></i></h3></div></div></div><div class="row"><div class="seven wide column"><h2 class="b-content_title"><strong ng-if="person.isDriver && !person.showFioFields" ng-bind="person | fioFormatter:\'full\'"></strong> <strong ng-if="person.showFioFields">Водитель</strong> <strong ng-if="!person.isDriver">Участник договора (<span ng-bind="person.personType === \'legal_person\' ? \'Юр. лицо\' : \'Физ. лицо\'"></span>)</strong></h2></div><div class="nine wide column"><div class="three fields"><div class="field"><sem-checkbox ng-model="person.isDriver" disabled="disabled" sem-label="Водитель"></sem-checkbox></div><div class="field" ng-class="{disabled: isDisabledForm, error: !personCheckUsed().isOwner}"><sem-checkbox ng-model="person.isOwner" sem-label="Собственник" ng-change="setPersonType(person, \'isOwner\')" name="person_is_owner"></sem-checkbox></div><div class="field" ng-class="{disabled: isDisabledForm, error: !personCheckUsed().isInsurant}"><sem-checkbox ng-model="person.isInsurant" sem-label="Страхователь" ng-change="setPersonType(person, \'isInsurant\')" name="person_is_insurant"></sem-checkbox></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.persons.html",'<div class="b-full-width-bg_white b-f-policy_person ui form is-form" ng-repeat="person in persons" ng-form="person_form" ng-model="person"><div class="ui loader"></div><div ng-if="person.personType === \'natural_person\'" ng-include="templates.person_block"></div><div ng-if="person.personType === \'legal_person\'" ng-include="templates.person_block_legal"></div><div class="p20"><h3 ng-if="persons.length > 1 && (persons.length - 1) !== $index" class="ui horizontal divider header"><i class="icon users"></i><span></span></h3></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.html",'<div ng-include="templates.persons"></div><div ng-include="templates.car"></div><div class="mt40 c-tar"><button class="ui button" ya-metrika="m-save-docs-data" ng-disabled="f_policy_step_3_form.$invalid" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.save_the_data_button || $root.currentBrand.main_buttons_color)]" type="button" ng-click="savePersonalData()" ng-bind="labels.save_data"></button></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.osago/calculatorStepsO/views/payment_big_step.html",'<h1 class="b-content_title">Выбор типа отплаты</h1><div ng-controller="paymentCtrl"><div class="b-full-width-bg"><div class="p20"><h2 class="b-content_title m0">Стоимость страхового полиса составит <strong><span ng-bind="calculatorParams.result.sum | priceFormatter:0"></span>.<small ng-bind="calculatorParams.result.sum | fractionalFormatter:2"></small></strong> рублей<br>Выберите удобный вам способ оплаты:</h2><div class="mt20 b-ptypes"><div class="ui grid stackable three column no-user-select"><div class="row"><div class="column" ng-repeat="item in paymentTypes"><div class="b-ptype" ng-click="params.paymentFields.paymentType = item.id;" ng-class="{\'b-ptype--selected\': params.paymentFields.paymentType === item.id}"><div class="b-ptype_image-holder"><div class="b-ptype_image"><img ng-src="/img/payment_types/{{item.img_name}}" alt=""></div></div><div class="b-ptype_content-holder"><div class="b-ptype_content"><span ng-bind="item.title"></span></div></div></div></div></div></div></div></div></div><div><form name="payment_online" action="https://demomoney.yandex.ru/eshop.xml" method="post"><input ng-repeat="(name, value) in params.paymentFields track by name" name="{{name}}" value="{{value}}" type="hidden"><div class="p20 mt40" align="right"><button class="ui button green" type="submit">Оплатить</button></div></form></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorStepsO/views/second_big_step.html",'<div ng-controller="AddingDocumentsCtrl"><div class="p20 mb40 c-tac" ng-show="$root.currentBrand.show_personal_data" ng-if="!$root.browser.isIE && !$root.currentBrand.installation_via_api"><div class="ui basic buttons"><button class="ui button" tabindex="0" ng-click="addingDocumentsTemplates.selectTemplate(\'uploader\')" ng-class="{active: addingDocumentsTemplates.currentTemplate === \'uploader\'}" type="button">Загрузить фото документов</button> <button class="ui button" tabindex="0" ng-click="addingDocumentsTemplates.selectTemplate(\'form\')" ng-class="{active: addingDocumentsTemplates.currentTemplate === \'form\'}" type="button">Заполнить личные данные</button></div></div><div ng-form="f_policy_step_3_form" class="f_policy_step_3-form is-form css-hide-errors"><div ng-if="addingDocumentsTemplates.currentTemplate === \'uploader\'" ng-include="addingDocumentsTemplates.uploader"></div><div ng-if="addingDocumentsTemplates.currentTemplate === \'form\'"><div ng-controller="personalDataCtrl" ng-include="addingDocumentsTemplates.form" class="css-show-errors"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/AddingDocumentsS/views/adding_documents.uploader.html",'<div class="p20 mt10"><div class="row"><div class="column"><div class="ten wide field nowrap mb30"><label>Укажите категорию, к которой относитесь:</label><div class="ui search selection dropdown" sem-dropdown="" ng-class="{loading: !omsCategories.$$state.value.length}" ng-change="selectCategory(omsParams.oms_category_id)" sem-dropdown-placeholder="Не выбрана" ng-model="omsParams.oms_category_id" sem-dropdown-items="omsCategories"></div></div></div></div><div ng-class="{\'b-disabled-block\': isNotUpload}"><div class="ui grid stackable"><div class="row"><div class="six wide column"><ul class="uploader-queue" nv-file-drop="" nv-file-over="" uploader="uploader" over-class="uploader-queue_over"><li ng-if="!uploader.queue.length">Для оформления полиса нужно загрузить файлы.</li><li ng-repeat="item in uploader.queue" class="list-item animation-fade"><div ng-if="item._file.type.indexOf(\'image/\') !== -1"><div ng-thumb="{ file: item._file, height: 70 }"></div></div><div ng-if="item._file.type === \'application/pdf\'"><a href="{{item.file_url}}" target="_blank"><img ng-src="./img/pdf.png" alt="{{item.description}}" height="70"></a></div><div ng-if="item._file.type === \'application/msword\' || isDocument(item._file.type)"><a href="{{item.file_url}}" target="_blank"><img ng-src="./img/doc_icon.png" alt="{{item.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="item.remove()" class="button button-wrong">Удалить</button></div></li></ul><div class="control-row mt15"><input type="file" nv-file-select="" class="ui button" name="file" style="width: 100% !important;" uploader="uploader" multiple=""><h4>Выбрано: {{uploader.queue.length}}</h4></div></div><div class="ten wide column"><div class="b-full-width-bg" style="padding: 15px 0;margin-left: -15px;"><div class="p20">Для заполнения полиса добавьте сканы или фотографии ваших документов. Мы внесем эти данные и проверим их самостоятельно.</div></div><h3 ng-if="omsParams.oms_documents.length">Подтверждаю загрузку документов</h3><div class="b-uploader_confirmation-list" ng-repeat="document in omsParams.oms_documents track by $index"><div class="list-item mb5"><sem-checkbox ng-model="document.model" sem-label="{{document.title}}" required="required" sem-id="{{\'id_is_\' + $index}}" name="{{\'is_\' + $index}}"></sem-checkbox></div></div></div></div></div></div><div class="mt20 c-tar"><div move-to-step="button"></div><a href="" ng-click="bigSteps.setBigStep(\'fourth\')" ng-class="[isSaveDataProgress && \'loading\' || \'\', (f_policy_step_3_form.$invalid || !uploader.queue.length) && \'disabled\' || \'\', $root.currentBrand.next_step_buttons_color]" class="ui button">Далее</a></div><div class="mt40" ng-if="errors.length"><div class="ui error message"><ul class="list"><li ng-repeat="error in errors" ng-if="errors.length > 0"><span ng-bind="error"></span></li></ul><i class="close icon" ng-click="errors.length = 0;"></i></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorS/views/calculation.form.html",'<div class="c-ct"><div ng-include="templates.step_3"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorS/views/calculation.program_list.html",'<div class="mt20"></div><div ng-if="currentBrand.without_steps_history" move-to-step="arrow" move-to-step-type="text" ng-show="getActiveStep().name !== brandSteps.first[0]"></div><div class="c-tac b-content-loading mt40" ng-if="!calculationResult.length"><i class="spinner loading icon big grey" tabindex="0" style="font-size: 40px;"></i></div><div class="b-remaining-companies"><div class="w100p" ng-repeat="item in calculationResult" ng-if="($index < 5 || params.show_all) && !currentBrand.with_custom_program"><div class="b-remaining-companies__item"><div class="ui grid stackable doubling"><div class="row middle aligned b-remaining-companies__item-content"><div class="four wide column"><img ng-src="{{item.company_logo}}" class="b-remaining-companies__company-logo" alt="name of company" src="https://enter.b2bpolis.ru/media/logo_main_ins/22.png"></div><div class="four wide column"><h3><span ng-bind="item.insurance_company.title"></span></h3><div class="b-remaining-companies__kasko-sum tac"><h3 ng-class="{\'kasko-sum--with-discount\': !currentBrand.disable_discount }"><span><span ng-bind="item.program.sum | priceFormatter"></span> руб.</span></h3><h3 ng-if="!currentBrand.disable_discount"><span><span ng-bind="item.program.sum_with_discount | priceFormatter"></span> руб.</span></h3></div></div><div class="four wide column"><div ng-if="!currentBrand.with_bottom_programs"><div ng-repeat="option in item.program.option_set | filter:{\'is_active\': true}" class="c-tac"><span ng-bind="option.title"></span></div></div></div><div class="four wide column c-tac"><div class="b-remaining-companies__kasko_actions"><button class="ui button teal" ya-metrika="m-change-rate" title="Перейти к заказу" ng-click="selectResult(item.id)" ng-bind="params.go_to_order_title || \'Выбрать\'" type="button"></button></div></div><div ng-if="currentBrand.with_bottom_programs" class="b-remaining-companies__bottom-optionset row top aligned ui grid w100p"><div class="three wide column mt10 c-tac"><div ng-if="programOptions.length > 2"><span ng-click="item.optionsIsOpened = !item.optionsIsOpened" class="b-remaining-companies__bottom-optionset-toggle"><span ng-if="!item.optionsIsOpened">Еще <span ng-bind="programOptions.length -2"></span></span> <span ng-if="item.optionsIsOpened">Свернуть</span> <i class="chevron down icon" ng-class="{\'closed\' : item.optionsIsOpened}"></i></span></div></div><div class="thirteen wide column"><ul class="ui list mt10" ng-class="item.optionsIsOpened ? \'b-remaining-companies__bottom-optionset-list\' : \'b-remaining-companies__bottom-optionset-list__closed\'"><li class="item" ng-repeat="option in item.program.option_set | filter:{\'is_active\': true} as programOptions" ng-show="item.optionsIsOpened || (!item.optionsIsOpened && $index < 2)"><i class="check circle icon"></i> {{option.title}}</li></ul></div></div></div></div></div></div><div class="p20 b-remaining-companies__show" ng-if="calculationResult.length > 5 && !params.show_all"><button class="ui button small green" ng-click="params.show_all = true">Показать все</button></div></div><div class="p20 mt30" ng-if="root.messages.length"><div class="ui error message"><ul class="list"><li ng-repeat="message in root.messages"><span ng-bind="message"></span></li></ul><i class="close icon" ng-click="root.messages.length = 0;"></i></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorS/views/calculation.step_6.html",'<div class="ui form b-full-width-bg_white"><div class="p20"><div class="ui grid stackable four column bottom aligned"><div class="row"><div class="twelve wide column">&nbsp;</div><div class="column" align="right"><div class="field"><button class="button ui green" style="margin-right: 0;" ng-click="calculateKasko()" ng-class="{loading: params.isCalculationProgress}" ng-disabled="calculation_form.$invalid || disabledSubmitButton()" type="button">Рассчитать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/formationPolicyS/views/navigation.html","")}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/first_big_step.html",'<div><div ng-repeat="item in carFilterParams.brandSteps.first" ng-show="getCurrentStepObject(item).name === getActiveStep().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/second_big_step.html",'<div><div ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).name === getActiveStepSecond().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_all.html",'<div ng-init="$root.cascoAllInit()"><div class="c-ct__promo"><div class="c-ct__h2 c-tac mb50">Узнайте стоимость страхового полиса КАСКО онлайн <span ng-if="!$root.currentBrand.without_casco_discount">и получите скидку</span></div><div class="ui grid three column"><div class="row c-ct__promo-items"><div class="column"><div class="c-ct__promo-item"><div class="c-ct__promo-img c-promo-times m0a"></div><div class="c-ct__promo-description">Мы гарантируем точные цены на полис и актуальность предоставленной информации.</div></div></div><div class="column"><div class="c-ct__promo-item"><div class="c-ct__promo-img c-promo-cup m0a"></div><div class="c-ct__promo-description">Сравнение цен сразу у <span ng-bind="$root.currentBrand.insurance_company_count || 24"></span><span ng-if="!$root.currentBrand.insurance_company_count">-х</span> лидирующих компаний в Российской Федерации.</div></div></div><div class="column"><div class="c-ct__promo-item"><div class="c-ct__promo-img c-promo-rating m0a"></div><div class="c-ct__promo-description">Мы учитываем рейтинг и оценки страховых компаний и предлагаем вам только лучшие варианты.</div></div></div></div><div class="row"><div class="sixteen wide column"><div class="c-ct__promo-actions c-tac"><div class="m0a"><div class="field"><div class="ui search selection dropdown large c-vam" id="id_exploitation_area" style="width: 210px;" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" ya-metrika="m-car-region" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.exploitation_area" sem-dropdown-items="exploitationArea"></div><button class="ui button green large" ng-click="toNextStep(\'casco_all\')" ng-disabled="!calculationInterParams.exploitation_area" type="button">Рассчитать</button></div></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_car_mark.html",'<div class="calculator-caption-model mb15"><div class="c-ct__car-filter"><div class="c-tac"><div class="ui icon input large"><input type="text" placeholder="Найти автомобиль" ng-model="carSearch.title"> <i class="icon search"></i></div></div></div><div car-marks-list="" style="clear: both;" ng-model="calculation.car_mark" calc-step-name="casco_car_mark" columns-count="5" limit="55"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_car_model.html",'<div class="c-ct__car-details c-ct__car-details-model"><div class="c-ct__car-info mt20"><div class="c-ct__car-details-title">Уточните модель:</div><div car-models-list="" style="clear: both;" ng-model="calculation.car_model" car-mark-id="modelCarMark" car-manufacturing-year="calculation.car_manufacturing_year" calc-step-name="casco_car_model" car-model-group-id="calculation.car_model_group"></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_car_model_group.html",'<div class="c-ct__car-details c-ct__car-details-model-group"><div class="c-ct__car-info mt20" ng-if="calculationInterParams.car_manufacturing_year.id"><div ng-if="!calculation.car_model_group"><div class="c-ct__car-details-title">Модель:</div><div car-group-models-list="" style="clear: both;" ng-model="calculation.car_model_group" car-manufacturing-year="calculation.car_manufacturing_year" calc-step-name="casco_car_model_group" car-mark-id="modelCarMark"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_car_other.html",'<div class="c-ct__content c-ct__car-details-price is-form" ng-form="car_other_form"><div class="ui grid two column stackable relaxed mtb0"><div class="row bottom aligned"><div class="column"><div class="field"><div class="c-ct__content-title">Стоимость автомобиля, руб:</div><div class="ui input large"><input type="text" placeholder="500 000" ng-model="calculationInterParams.car_cost" price-formatter="2" class="input-has-slider c-tac" required="" no-empty=""></div><div input-slider="{maxSum: calculationInterParams.car_cost_max, minSum: calculationInterParams.car_cost_min}" is-sum="true" default-min="{{calculationInterParams.car_cost_min || 100000}}" default-max="{{calculationInterParams.car_cost_max || 3000000}}" slider-step="10000" ng-model="calculationInterParams.car_cost"></div></div></div><div class="column" ng-hide="calculationInterParams.car_manufacturing_year.type === \'new\'"><div class="field"><div class="c-ct__content-title">Текущий пробег автомобиля, км:</div><div class="ui input large"><input type="text" placeholder="20 000" ng-model="calculationInterParams.mileage" price-formatter="2" class="input-has-slider c-tac"></div><div input-slider="" is-sum="true" default-min="0" slider-step="100" default-max="300000" ng-model="calculationInterParams.mileage"></div></div></div><div class="column mt25"><div class="field"><div class="c-ct__content-title">Мощность двигателя, л.с.:</div><div class="ui input large"><input type="text" placeholder="120" ng-model="calculationInterParams.engine_power" price-formatter="2" class="input-has-slider c-tac" required="" no-empty=""></div><div input-slider="" is-sum="true" default-min="10" slider-step="10" default-max="600" ng-model="calculationInterParams.engine_power"></div></div></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ya-metrika="m-confirm-car-params" ng-click="toNextStep(\'casco_car_other\')" ng-disabled="car_other_form.$invalid" type="button">Далее</button></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_insurance_params.html",'<div class="c-ct__content c-ct__content-insurance_params is-form" ng-form="insurance_params_form"><div class="c-tac mt40"><div class="c-ct__content-title m0 mb10">Когда вам нужна страховка?</div><div><div class="c-ct__button c-ct__button--large pl25 pr25 ml5" ng-click="changeCalculationAtDate(1)" type="button">Завтра</div><div class="c-ct__button c-ct__button--large pl25 pr25 ml5" ng-click="changeCalculationAtDate(7)" type="button">На этой неделе</div><div class="c-ct__button c-ct__button--large pl25 pr25 ml5" ng-click="changeCalculationAtDate(31)" type="button">В этом месяце</div></div></div><div class="w100p"><div class="c-ct__content-insurance_day"><div class="ui centered grid"><div class="six wide computer six wide tablet twelve wide mobile column"><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(-1, 0)}}" jdatepicker-only-future="true" placeholder="__.__.____" id="id_calculation_at_date" name="calculation_at_date" required="" ng-model="calculation.calculation_at_date"> <i class="icon calendar circular branded inverted"></i></div><div class="ui right pointing label" ng-show="calculation.calculation_at_date && insurance_params_form.calculation_at_date.$invalid">Застраховаться можно только с завтрашнего дня</div><button class="ui button teal big" ng-if="calculation.calculation_at_date && !insurance_params_form.calculation_at_date.$invalid" ng-disabled="insurance_params_form.$invalid" ng-click="toNextStep(calculatorStepsService.getCurrentStep())" type="button">Далее</button></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.casco_year.html",'<div class="c-ct__car-details c-ct__car-details-year"><div class="c-ct__years clearfix"><div class="c-ct__years-block c-ct__years-block--orange c-ct__years-block--one"><div class="c-ct__car-details-title">Новый автомобиль:</div><div class="c-ct__years-items c-ct__row--two"><div class="c-ct__years-item c-ct__column" ng-repeat="item in calculatorParams.cascoParams.years.newCar" ng-click="calculatorParams.cascoParams.selectYear(item);toNextStep(\'casco_year\')"><div class="c-ct__button c-ct__button--orange" ng-class="{\'c-ct__button--active\': calculationInterParams.car_manufacturing_year.type === \'new\' && item.id === calculationInterParams.car_manufacturing_year.id}" ng-bind="item.title"></div></div></div></div><div class="c-ct__years-block c-ct__years-block--blue c-ct__years-block--two"><div class="c-ct__car-details-title">Автомобиль с пробегом:</div><div class="c-ct__years-items c-ct__row--four"><div class="c-ct__years-item c-ct__column" ng-repeat="item in calculatorParams.cascoParams.years.oldCar" ng-click="calculatorParams.cascoParams.selectYear(item);toNextStep(\'casco_year\')"><div class="c-ct__button" ng-class="{\'c-ct__button--active\': calculationInterParams.car_manufacturing_year.type === \'old\' && item.id === calculationInterParams.car_manufacturing_year.id}" ng-bind="item.title"></div></div></div></div><div class="c-ct__years-note">*Автомобиль, который не страховался ранее</div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.drivers.html",'<div class="c-ct__content-drivers"><div class="ui selection search dropdown large" ng-model="calculationInterParams.drivers_count" sem-dropdown="" ng-change="changeDriversCount()" sem-dropdown-items="driversChanging" style="width: 210px;"></div><div ng-form="all_drivers_form" ng-if="calculationInterParams.drivers_count !== \'0\'" class="css-bigger-labels css-bigger-slider is-form"><div class="c-ct__content"><div ng-repeat="item in calculationInterParams.drivers track by $index" class="mb20" ng-form="driver_kasko_form"><span class="b-content_title"><span ng-bind="$index + 1"></span>-й водитель:</span><div class="ui grid doubling stackable"><div class="row"><div class="five wide column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><div class="c-ct__content-title">Возраст:</div><div class="ui input large"><input type="text" id="id_driver_age_{{$index}}" class="input-has-slider" price-formatter="" name="age" required="" ng-model="item.age"></div><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="item.age"></div></div></div><div class="five wide column"><div class="field" ng-class="{\'error\': item.age - item.expirience < 18}"><div class="c-ct__content-title">Стаж вождения:</div><div class="ui input large"><input type="text" id="id_driver_expirience_{{$index}}" required="" class="input-has-slider" name="expirience" price-formatter="" ng-model="item.expirience"></div><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="item.expirience"></div></div></div><div class="six wide column"><div class="field"><div class="c-ct__content-title">Пол:</div><div class="ui basic two buttons"><button class="ui button large" ng-click="item.gender = \'M\'" ng-class="getActiveButtonClass(item.gender === \'M\')" type="button">Мужской</button> <button class="ui button large" ng-click="item.gender = \'F\'" ng-class="getActiveButtonClass(item.gender === \'F\')" type="button"><span class="h-button-expander"></span> Женский</button></div></div></div></div><div class="row" ng-if="!$root.currentBrand.without_children"><div class="right floated three wide column"><sem-checkbox ng-model="item.is_married" sem-label="В браке" sem-id="{{\'id_is_married\' + $index}}" name="{{\'is_married\' + $index}}"></sem-checkbox></div><div class="three wide column"><sem-checkbox ng-model="item.has_children" sem-label="Есть дети" sem-id="{{\'id_has_children_\' + $index}}" name="{{\'has_children_\' + $index}}"></sem-checkbox></div></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ng-class="$root.currentBrand.next_step_buttons_color" ng-disabled="driver_kasko_form.$invalid || driversAreInvalid()" ng-click="goNextDriverFull()" ya-metrika="m-drivers" type="button">Далее</button></div></div><div class="is-form" ng-form="multidrive_form" ng-if="calculationInterParams.drivers_count === \'0\'"><div class="c-ct__content"><div class="ui grid two column stackable"><div class="row"><div class="column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><div class="c-ct__content-title">Минимальный возраст:</div><input type="text" id="id_drivers_minimal_age" class="input-has-slider" price-formatter="" name="drivers_minimal_age" required="" ng-model="calculationInterParams.drivers_minimal_age"><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="calculationInterParams.drivers_minimal_age"></div></div></div><div class="column"><div class="field" ng-class="{\'error\': calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18}"><div class="c-ct__content-title">Минимальный стаж:</div><input type="text" id="id_drivers_minimal_experience" required="" class="input-has-slider" name="drivers_minimal_experience" price-formatter="" ng-model="calculationInterParams.drivers_minimal_experience"><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="calculationInterParams.drivers_minimal_experience"></div></div></div></div></div></div><div class="c-tac"><button class="ui button teal big" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="multidrive_form.$invalid || calculationInterParams.drivers_minimal_age > 90 || calculationInterParams.drivers_minimal_age < 18 || calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18" ng-click="goNextDriverFull()" ya-metrika="m-drivers" type="button">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/calculatorStepsS/views/step.is_multidrive.html",'<div class="pt100"><div class="is-form" ng-form="multidrive_form"><div class="c-ct__content"><div class="ui grid two column mt20 doubling stackable mtb0"><div class="row"><div class="column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><div class="c-ct__content-title m0 mb5">Минимальный возраст:</div><input type="text" id="id_drivers_minimal_age" class="input-has-slider" price-formatter="" name="drivers_minimal_age" required="" ng-model="calculationInterParams.drivers_minimal_age"><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="calculationInterParams.drivers_minimal_age"></div></div></div><div class="column"><div class="field" ng-class="{\'error\': calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18}"><div class="c-ct__content-title m0 mb5">Минимальный стаж:</div><input type="text" id="id_drivers_minimal_experience" required="" class="input-has-slider" name="drivers_minimal_experience" price-formatter="" ng-model="calculationInterParams.drivers_minimal_experience"><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="calculationInterParams.drivers_minimal_experience"></div></div></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ng-class="$root.currentBrand.next_step_buttons_color" ng-disabled="multidrive_form.$invalid || calculationInterParams.drivers_minimal_age > 90 || calculationInterParams.drivers_minimal_age < 18 || calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18" ng-click="toNextStep(\'is_multidrive\')" ya-metrika="m-drivers" type="button">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/carFilterS/views/car_filter.car_group_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModelGroups || !carModelGroups.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="c-ct__button c-ct__button--large c-ct__button--green" ng-repeat="item in carModelGroups | carFilterYears:calculationInterParams.car_manufacturing_year.id | orderBy:\'rank\':reverse" title="{{item.title}}" ng-click="selectCarModelGroup(item)" ya-metrika="m-group-of-the-car" ng-keypress="$event.keyCode == 13 && selectCarModelGroup(item)"><span ng-bind="item.title"></span></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/carFilterS/views/car_filter.car_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModels || !carModels.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="c-ct__button c-ct__button--large c-ct__button--green" ng-repeat="item in carModels | carFilterYears:calculationInterParams.car_manufacturing_year.id | orderBy:\'rank\':reverse" title="{{item.title}}" ng-click="selectCarModel(item, true)" ya-metrika="m-group-of-the-car" ng-keypress="$event.keyCode == 13 && selectCarModel(item, true)"><span ng-bind="item.title"></span></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.casco/carFilterS/views/program_list.manager.html",'<div class="c-ct__recalculation" ng-if="!$root.currentBrand.without_recalculation_block"><div class="c-ct__recalculation-block"><div class="c-ct__recalculation-block-content"><div class="c-ct__recalculation-calc-info"><span dictionary-id="calculation.exploitation_area" dictionary-prop="title" dictionary="exploitationArea">Санкт-Петербург</span>; <span ng-bind="carAllSelected.carMark.title"></span> <span ng-bind="carAllSelected.carModel.title"></span>; <span ng-bind="calculation.car_manufacturing_year"></span> года; <span ng-repeat="item in calculation.driver_set">Пол: <span ng-bind="item.gender === \'M\' ? \'муж.\' : \'жен.\'"></span>, лет: <span ng-bind="item.age"></span>, стаж: <span ng-bind="item.expirience"></span>;<br></span><div class="c-tac mt15"><a href="" ng-click="bigSteps.setBigStep(\'first\')">Изменить</a></div></div></div><div class="ui divider"></div><div class="ui grid centered"><div class="five wide column"><div class="field"><div class="c-ct__content-title m0 mb5 c-tal">Франшиза (руб):</div><div class="ui input w100p"><input type="text" id="id_deductible_value" class="input-has-slider" name="deductible_value" ng-model="params.deductible_value" ng-change="calculateKaskoDebounced();"></div><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="50000" ng-model="params.deductible_value"></div></div></div><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Сумма страхования:</div><div class="ui input w100p"><input type="text" placeholder="500 000" ng-model="calculation.car_cost" price-formatter="2" class="input-has-slider" ng-change="calculateKaskoDebounced();" required="" no-empty=""></div><div input-slider="{maxSum: calculationInterParams.car_cost_max, minSum: calculationInterParams.car_cost_min}" is-sum="true" default-min="{{calculationInterParams.car_cost_min || 100000}}" default-max="{{calculationInterParams.car_cost_max || 3000000}}" slider-step="10000" ng-model="calculation.car_cost"></div></div></div><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Спутниковая система:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Не выбрана" ng-model="calculationInterParams.antitheft" sem-dropdown-items="antiThefts"></div></div></div></div><div class="ui c-ct__addit-parameters" ng-class="{\'c-ct__addit-parameters--active\': postCalculateParams.opened}"><div class="ui grid centered"><div class="fiveteen wide column"><button class="ui button c-ct__addit-parameters--toggle" ng-click="postCalculateParams.opened = !postCalculateParams.opened" type="button">Дополнительные параметры <i class="chevron down icon"></i></button> <button class="ui right floated button small green" ng-click="calculateKasko()">Пересчитать</button></div></div></div><div class="ui grid c-ct__parametrs-block" ng-if="postCalculateParams.opened"><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Приобретен в кредит:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Нет" ng-model="params.credit_bank" sem-dropdown-items="creditBank"></div></div></div><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Были страховые случаи:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Нет" ng-model="params.count_years_break_even_insurance" sem-dropdown-items="yesNo"></div></div></div><div class="six wide column"><div class="field"><div class="c-ct__content-title c-tal">Ремонт:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Официальный дилер" ng-model="calculationInterParams.payment_form" sem-dropdown-items="paymentForm"></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.casco/carFilterS/views/third_big_step.html",'<div class="c-ct__content c-ct__content-sms_verification"><div class="ui grid two column doubling stackable css-bigger-labels mtb0"><div class="row one column"><div class="column"><div class="c-ct__sms-title"><div ng-if="$root.currentBrand.customLabels.smsTitle" ng-bind="$root.currentBrand.customLabels.smsTitle"></div><div ng-if="!$root.currentBrand.customLabels.smsTitle">Для получения расчетов стоимости КАСКО, пройдите бесплатную<br>SMS-верификацию и введите полученный код подтверждения.</div></div></div></div><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title">Как Вас зовут?</div><div class="ui input large"><input type="text" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" ng-model="clientParams.client_name" ng-change="$root.clientDataForMail.name = clientParams.client_name" placeholder="Имя" id="id_client_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title">Номер телефона:</div><div class="ui input large"><input type="text" ui-mask="+7 (999) 999-9999" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" placeholder="+7 (___) ___-____" model-view-value="true" ng-change="$root.clientDataForMail.phone = clientParams.client_phone" ng-model="clientParams.client_phone" id="id_client_phone"></div></div></div></div><div class="row" ng-if="!clientParams.sms_is_visible"><div class="sixteen wide column"><sem-checkbox class="mt5" ng-model="clientParams.client_is_agree"></sem-checkbox><h4 class="m0 b-app__agreement-on-sms" ng-click="clientParams.client_is_agree = !clientParams.client_is_agree;"><strong>Я даю согласие на обработку персональных данных</strong><br><small>Обработка персональных данных осуществляется согласно ФЗ РФ №152-ФЗ</small></h4></div></div><div class="row bottom aligned" ng-if="clientParams.sms_is_visible"><div class="column"><div class="field" ng-class="{error: !clientParams.sms_code}"><div class="c-ct__content-title">Код из СМС:</div><input type="text" ng-model="clientParams.sms_code" placeholder="XXXX" maxlength="4" input-integer="" id="id_sms_code"></div></div><div class="column"><div class="field"><div class="pos-rel"><button class="ui button green large fluid" ng-disabled="!clientParams.sms_code || clientParams.sms_button_is_disabled" ng-click="confirmCode()" ya-metrika="m-confirm-code" type="button">Показать тарифы</button><div class="c-ct__link"><a href="" class="css-bottom-dashed" ng-click="clientParams.sms_is_visible = false;">Изменить номер</a></div></div></div></div></div><div class="row" ng-show="calculatorParams.confirm_code_is_incorrect"><div class="sixteen wide column"><div class="ui message error visible">Код СМС не совпал с отправленным.</div></div></div></div></div><div class="c-tac mt15" ng-show="!clientParams.sms_is_visible"><button class="ui button teal big mr20" ng-disabled="!clientParams.client_phone || !clientParams.client_name || clientParams.client_params_are_disabled || !clientParams.client_is_agree" ng-click="showSMSform();calculateKaskoCarFilter()" ya-metrika="m-send-sms-code" type="button">Отправить</button></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/AddingDocumentsU/views/adding_documents.uploader.html",'<div class="p20 mt10"><div class="row"><div class="column"><div class="ten wide field nowrap mb30"><label>Укажите категорию, к которой относитесь:</label><div class="ui search selection dropdown" sem-dropdown="" ng-class="{loading: !omsCategories.$$state.value.length}" ng-change="selectCategory(omsParams.oms_category_id)" sem-dropdown-placeholder="Не выбрана" ng-model="omsParams.oms_category_id" sem-dropdown-items="omsCategories"></div></div></div></div><div ng-class="{\'b-disabled-block\': isNotUpload}"><div class="ui grid stackable"><div class="row"><div class="six wide column"><ul class="uploader-queue" nv-file-drop="" nv-file-over="" uploader="uploader" over-class="uploader-queue_over"><li ng-if="!uploader.queue.length">Для оформления полиса нужно загрузить файлы.</li><li ng-repeat="item in uploader.queue" class="list-item animation-fade"><div ng-if="item._file.type.indexOf(\'image/\') !== -1"><div ng-thumb="{ file: item._file, height: 70 }"></div></div><div ng-if="item._file.type === \'application/pdf\'"><a href="{{item.file_url}}" target="_blank"><img ng-src="./img/pdf.png" alt="{{item.description}}" height="70"></a></div><div ng-if="item._file.type === \'application/msword\' || isDocument(item._file.type)"><a href="{{item.file_url}}" target="_blank"><img ng-src="./img/doc_icon.png" alt="{{item.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="item.remove()" class="button button-wrong">Удалить</button></div></li></ul><div class="control-row mt15"><input type="file" nv-file-select="" class="ui button" name="file" style="width: 100% !important;" uploader="uploader" multiple=""><h4>Выбрано: {{uploader.queue.length}}</h4></div></div><div class="ten wide column"><div class="b-full-width-bg" style="padding: 15px 0;margin-left: -15px;"><div class="p20">Для заполнения полиса добавьте сканы или фотографии ваших документов. Мы внесем эти данные и проверим их самостоятельно.</div></div><h3 ng-if="omsParams.oms_documents.length">Подтверждаю загрузку документов</h3><div class="b-uploader_confirmation-list" ng-repeat="document in omsParams.oms_documents track by $index"><div class="list-item mb5"><sem-checkbox ng-model="document.model" sem-label="{{document.title}}" required="required" sem-id="{{\'id_is_\' + $index}}" name="{{\'is_\' + $index}}"></sem-checkbox></div></div></div></div></div></div><div class="mt20 c-tar"><div move-to-step="button"></div><a href="" ng-click="bigSteps.setBigStep(\'fourth\')" ng-class="[isSaveDataProgress && \'loading\' || \'\', (f_policy_step_3_form.$invalid || !uploader.queue.length) && \'disabled\' || \'\', $root.currentBrand.big_step_buttons_color]" class="ui button">Далее</a></div><div class="mt40" ng-if="errors.length"><div class="ui error message"><ul class="list"><li ng-repeat="error in errors" ng-if="errors.length > 0"><span ng-bind="error"></span></li></ul><i class="close icon" ng-click="errors.length = 0;"></i></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorU/views/calculation.form.html",'<div class="c-ct"><div ng-include="templates.step_3"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorU/views/calculation.program_list.html",'<div class="mt20"></div><div move-to-step="arrow" move-to-step-type="text" ng-show="getActiveStep().name !== brandSteps.first[0]"></div><div class="c-tac b-content-loading mt40" ng-if="!calculationResult.length"><i class="spinner loading icon big grey" tabindex="0" style="font-size: 40px;"></i></div><div class="b-remaining-companies"><div class="w100p" ng-repeat="item in calculationResult" ng-if="$index < 5 || params.show_all"><div class="b-remaining-companies__item"><div class="ui grid stackable doubling"><div class="ml20 program__label__top" ng-if="currentBrand.with_programs"><div class="nine wide column"><span>Базовый тариф без установленной ПУС</span></div></div><div class="row middle aligned"><div class="four wide column"><img ng-src="{{item.company_logo}}" class="b-remaining-companies__company-logo" alt="name of company" src="https://enter.b2bpolis.ru/media/logo_main_ins/22.png"></div><div class="four wide column"><h3><span ng-bind="item.insurance_company.title"></span></h3><div class="b-remaining-companies__kasko-sum mb15 tac"><h3><span><span ng-bind="item.program.sum | priceFormatter"></span> руб.</span></h3></div></div><div class="four wide column"><div ng-repeat="option in item.program.option_set | filter:{\'is_active\': true}" class="c-tac"><span ng-bind="option.title"></span></div></div><div class="four wide column c-tac"><div class="b-remaining-companies__kasko_actions"><button class="ui button teal" ya-metrika="m-change-rate" title="Перейти к заказу" ng-click="selectResult(item.id)" ng-bind="params.go_to_order_title || \'Выбрать\'" type="button"></button></div></div></div><div class="ml20 program__label" ng-if="item.availablePrograms"><div class="nine wide column"><span>Стоимость полиса с установкой охранной системы</span></div></div></div></div><div class="ui grid row program-item" ng-repeat="program in item.availablePrograms"><div class="row middle aligned centered" ng-if="program.program.sum"><div class="three wide column program-item__field"><label>Название:</label> <span ng-bind="program.PUS_title"></span></div><div class="five wide column program-item__field"><label>Стоимость оборудования:</label> <span><span ng-bind="program.PUS_cost | priceFormatter"></span> руб.</span></div><div class="four wide column program-item__field"><label>Стоимость полиса:</label> <span><span ng-bind="program.program.sum | priceFormatter"></span> руб.</span></div><div class="four wide right floated column c-tac"><div class="b-remaining-companies__kasko_actions"><button class="ui button teal" title="Перейти к заказу" ng-click="selectResult(item.id, false, program.id)" ng-bind="params.go_to_order_title || \'Выбрать\'" type="button"></button></div></div></div></div><div class="ui grid row program-item" ng-if="item.availablePrograms.length ===0"><div class="row middle aligned centered"><div class="three wide column program-item__field"><label>Название:</label> <span>Backspace Pro</span></div><div class="five wide column program-item__field"><label>Стоимость оборудования:</label> <span><span>16500</span> руб.</span></div><div class="four wide column program-item__field"><label>Стоимость полиса:</label> <span><span ng-bind="item.program.sum * 0.83 | priceFormatter"></span> руб.</span></div><div class="four wide right floated column c-tac"><div class="b-remaining-companies__kasko_actions"><button class="ui button teal" title="Перейти к заказу" ng-click="selectResult(item.id, true)" ng-bind="params.go_to_order_title || \'Выбрать\'" type="button"></button></div></div></div></div></div><div class="p20 b-remaining-companies__show" ng-if="calculationResult.length > 5 && !params.show_all"><button class="ui button small green" ng-click="params.show_all = true">Показать все</button></div></div><div class="p20 mt30" ng-if="root.messages.length"><div class="ui error message"><ul class="list"><li ng-repeat="message in root.messages"><span ng-bind="message"></span></li></ul><i class="close icon" ng-click="root.messages.length = 0;"></i></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorU/views/calculation.step_3.html",'<div class="css-cars-filter b-full-width-bg m0 mt30" ng-class="\'css-cars-filter--step-\' + bigSteps.getBigStep().name" style="font-size: 15px;"><div class="p20"><div ng-class="{\'c-ct__progress__wrapper\': getActiveStep().name !== \'usago_all\'}"><div class="c-ct__progress" ng-show="(getActiveStep().name !== \'usago_all\' && bigSteps.getBigStep().name !== \'fourth\') || (getActiveStep().name !== \'usago_all\' && currentBrand.disable_discount)"><div class="c-ct__progress-line" ng-style="{\'width\': (getFullDiscount()/sumOfDiscounts * 100) + \'%\'}"></div><div class="c-ct__progress-title"><strong>{{getCurrentStepTitle()}}</strong></div><div class="c-ct__progress-discount" ng-if="!currentBrand.disable_discount"><span ng-bind="getCurrentDiscountTitle()"></span></div></div><div class="ui labels mt50" ng-init="params.displayStepsHistory = $root.currentBrand.alwaysShowHistory" ng-if="!$root.currentBrand.without_steps_history"><div ng-mouseover="params.displayStepsHistory = true" ng-mouseleave="params.displayStepsHistory = $root.currentBrand.alwaysShowHistory"><span ng-repeat-start="(stepName, steps) in brandSteps" ng-init="$parentIndex = $index" class="c-ct__steps-history"><div class="ui label basic mr5" ng-if="$parentIndex == 0 && getActiveStep().name !== \'usago_all\'" ng-click="getPrevStep()"><i class="caret left icon"></i> Назад</div></span><div class="ui label basic c-ct__steps-history__wrapper" ng-repeat-end="" ng-repeat="step in steps" ng-init="stepObj = getStepObjectByName(step)" ng-show="stepObj.getLabelTitle() && params.displayStepsHistory" ng-if="params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) >= $parentIndex"><span ng-if="bigSteps.getBigStep().name == stepName" ng-click="setActiveStep(step);" ng-bind="stepObj.getLabelTitle()"></span> <span ng-if="bigSteps.getBigStep().name != stepName" ng-click="bigSteps.setBigStep(stepName);setActiveStep(step);" ng-bind="stepObj.getLabelTitle()"></span></div></div></div></div><div class="clearfix pos-rel"><div class="c-ct__steps-wrapper" ng-class="{\'c-ct__steps-wrapper--usago_all\': getActiveStep().name !== \'usago_all\'}"><div ng-if="!params.resultsAreVisible || bigSteps.getBigStep().name !== \'fourth\'" style="min-height: 300px"><car-filter cf-model-car-mark="calculation.car_mark" cf-model-car-model="calculation.car_model" cf-model-car-model-group="calculation.car_model_group" cf-model-car-cost="calculation.car_cost"></car-filter></div></div><div class="w15p c-fl" ng-class="{\'c-ct__steps-wrapper--usago_all\': getActiveStep().name !== \'usago_all\'}" ng-show="getActiveStep().name !== \'usago_all\'"><div class="c-ct__steps"><div class="c-ct__steps-item" ng-repeat="item in params.cascoParams.cascoBigSteps" data-tooltip="{{item.title}}" data-position="bottom center"><div class="ui huge icon button circular" ng-class="{ green: params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) >= $index, active: params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) === $index, disabled: params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) < $index }" ng-click="bigSteps.setBigStep(item.name)"><i class="icon" ng-class="item.icon"></i></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorU/views/calculation.step_6.html",'<div class="ui form b-full-width-bg_white"><div class="p20"><div class="ui grid stackable four column bottom aligned"><div class="row"><div class="twelve wide column">&nbsp;</div><div class="column" align="right"><div class="field"><button class="button ui green" style="margin-right: 0;" ng-click="calculateKasko()" ng-class="{loading: params.isCalculationProgress}" ng-disabled="calculation_form.$invalid || disabledSubmitButton()" type="button">Рассчитать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/formationPolicyU/views/navigation.html","")}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/personalDataU/views/personal_data.html",'<div class="mt40 c-tar"><button class="ui button" ng-if="$root.currentBrand.max_persons > 1 || !$root.currentBrand.max_persons" type="button" ng-click="personalDataActions.addPerson()"><i class="icon add user"></i> Добавить участника договора</button></div><div ng-form="" class="is-form" name="personal_data_persons_form"><div class="ui segment" ng-repeat="person in persons"><h3 class="ui horizontal divider header"><i class="icon child"></i></h3><div class="ui grid stackable three column"><div class="row"><div class="column"><div class="field" ng-class=""><label>Фамилия</label> <input type="text" required="" name="last_name" ng-pattern="params.name_pattern" placeholder="Иван" ng-model="person.last_name"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Имя</label> <input type="text" placeholder="Иванов" required="" name="first_name" ng-pattern="params.name_pattern" ng-model="person.first_name"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Отчество</label> <input type="text" name="patronymic" ng-pattern="params.name_pattern" ng-change="personalDataActions.patronymicChange(person)" placeholder="Иванович" ng-model="person.patronymic"></div></div></div></div><div class="ui grid stackable three column"><div class="column"><div class="field"><label>Дата рождения:</label><div class="ui icon input"><input type="text" placeholder="__.__.____" jdatepicker-year-range="{{getYearRange(0, 80)}}" jdatepicker="" required="" ng-model="person.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field"><label>Пол:</label><div class="ui buttons w100p"><button class="ui button" ng-click="person.gender = \'M\'" ng-class="person.gender == \'M\' && $root.currentBrand.steps_buttons_color || \'\'" type="button"><span>Мужской</span></button> <button class="ui button" ng-click="person.gender = \'F\'" ng-class="person.gender == \'F\' && $root.currentBrand.steps_buttons_color || \'\'" type="button"><span>Женский</span></button></div></div></div></div><div class="ui grid stackable three column"><div class="row"><div class="column"><div class="field"><label for="id_person_document">Документ:</label><div class="ui search selection dropdown" sem-dropdown-placeholder="Не выбран" sem-dropdown="" id="id_person_document" sem-dropdown-items="dicts.document_types" ng-model="person.document_type"></div></div></div><div class="column"><div class="field"><div class="ui fields"><div class="seven wide field"><label for="id_person_series">Серия:</label> <input type="text" required="" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_series" ng-model="person.document.series"></div><div class="nine wide field"><label for="id_person_number">Номер:</label> <input type="text" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" id="id_person_number" ng-model="person.document.number"></div></div></div></div><div class="column"><div class="field"><label>Дата выдачи:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 26)}}" placeholder="__.__.____" required="" ng-model="person.document.issue_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div><div class="row two column"><div class="column"><div class="field"><label for="id_issue_point">Кем выдан:</label> <input type="text" placeholder="ОУФМС РФ по г.Москва" id="id_issue_point" ng-model="person.document.issue_point"></div></div><div class="column"><div class="field"><label for="id_issue_point">Номер СНИЛС:</label> <input type="text" ui-mask="999-999-999 99" placeholder="___-___-___ __" id="id_snils_number" ng-model="person.snils_number"></div></div></div></div><h3 class="ui horizontal divider header"><i class="icon circle info"></i><span></span></h3><div class="b-addresses"><div class="b-address ui stackable grid"><div class="row"><div class="b-address_line column"><div class="p20"><div class="field" ng-class="{disabled: isDisabledForm}"><div class="b-addresses_checkboxes mb15"><strong>Адрес регистрации:</strong><sem-checkbox sem-label="Место пребывания совпадает с адресом регистрации" sem-id="id_is_same_adrress_{{$index}}" ng-model="person.is_same_address"></sem-checkbox></div><div dadata="person.address_registration" dadata-type="address"><div class="ui transparent input">Введите адрес: <input type="text" required="" dadata-target="" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_registration)}" id="id_address_registration_full" ng-model="person.address_registration.full" name="address_registration_full"></div></div></div></div></div></div></div></div><br><br></div><div class="fifteen wide field c-tar"><div move-to-step="button"></div><button class="ui button" ng-disabled="personal_data_persons_form.$invalid" ng-class="$root.currentBrand.big_step_buttons_color" type="button" ng-click="personalDataActions.savePersonalData()">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/first_big_step.html",'<div><div ng-repeat="item in carFilterParams.brandSteps.first" ng-show="getCurrentStepObject(item).name === getActiveStep().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/second_big_step.html",'<div><div ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).name === getActiveStepSecond().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.drivers.html",'<div class="pt100"><div ng-form="all_drivers_form" class="css-bigger-labels css-bigger-slider is-form"><div class="c-ct__content"><div ng-repeat="item in calculationInterParams.drivers track by $index" class="mb20" ng-form="driver_kasko_form"><span class="b-content_title"><span ng-bind="$index + 1"></span>-й водитель:</span><div class="ui grid doubling stackable mtb0"><div class="row"><div class="five wide column mtb0"><div class="field mtb0" ng-class="{\'error\': item.age < 18 || item.age > 90}"><div class="c-ct__content-title m0 mb5">Возраст:</div><div class="ui input large mtb0"><input type="text" id="id_driver_age_{{$index}}" class="input-has-slider mtb0" price-formatter="" name="age" required="" ng-model="item.age"></div><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="item.age" class="mtb0"></div></div></div><div class="five wide column mtb0"><div class="field mtb0" ng-class="{\'error\': item.age - item.expirience < 18}"><div class="c-ct__content-title m0-20 mb5">Стаж вождения:</div><div class="ui input large mtb0"><input type="text" id="id_driver_expirience_{{$index}}" required="" class="input-has-slider mtb0" name="expirience" price-formatter="" ng-model="item.expirience"></div><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="item.expirience" class="mtb0"></div></div></div><div class="six wide column mtb0"><div class="field mtb0"><div class="c-ct__content-title m0 mb5">Пол:</div><div class="ui basic two buttons mtb0"><button class="ui button large mtb0" ng-click="item.gender = \'M\'" ng-class="getActiveButtonClass(item.gender === \'M\')" type="button">Мужской</button> <button class="ui button large mtb0" ng-click="item.gender = \'F\'" ng-class="getActiveButtonClass(item.gender === \'F\')" type="button"><span class="h-button-expander"></span> Женский</button></div></div></div></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="driver_kasko_form.$invalid || driversAreInvalid()" ng-click="goNextDriverFull()" ya-metrika="m-drivers" type="button">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_all.html",'<div><div class="c-ct__promo"><div class="c-ct__h2 c-tac mb50">Узнайте стоимость страхового полиса ОСАГО онлайн</div><div class="ui grid three column"><div class="row c-ct__promo-items"><div class="column"><div class="c-ct__promo-item"><div class="c-ct__promo-img c-promo-times m0a"></div><div class="c-ct__promo-description">Мы гарантируем точные цены на полис и актуальность предоставленной информации.</div></div></div><div class="column"><div class="c-ct__promo-item"><div class="c-ct__promo-img c-promo-cup m0a"></div><div class="c-ct__promo-description">Сравнение цен сразу у 24-х лидирующих компаний в Российской Федерации.</div></div></div><div class="column"><div class="c-ct__promo-item"><div class="c-ct__promo-img c-promo-rating m0a"></div><div class="c-ct__promo-description">Мы учитываем рейтинг и оценки страховых компаний и предлагаем вам только лучшие варианты.</div></div></div></div><div class="row"><div class="sixteen wide column"><div class="c-ct__promo-actions c-tac"><div ng-if="!calculatorParams.cascoParams.calculationTypeIsSelected"><button class="ui button green big" disabled="" type="button">Рассчитать ОСАГО</button><div class="c-vertical-divider"></div><button class="ui button teal big" type="button" ng-click="calculatorParams.cascoParams.selectCalcType()">Рассчитать ОСАГО</button></div><div ng-if="calculatorParams.cascoParams.calculationTypeIsSelected" class="m0a"><div class="field"><div class="ui search selection dropdown large c-vam" id="id_exploitation_area" style="width: 210px;" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" ng-class="{loading: !ownerRegistration.$$state.value.length}" ya-metrika="m-car-region" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.owner_registration" sem-dropdown-items="ownerRegistration"></div><button class="ui button green large" ng-click="toNextStep(\'usago_all\')" ng-disabled="!calculationInterParams.owner_registration" type="button">Рассчитать</button></div></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_calculation.html",'<div full-calculation="" ng-if="getActiveStepSecond().name === \'usago_calculation\'"><div class="c-tac b-content-loading pt40" ng-if="!resultsFull.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div ng-if="resultsFull.length" class="pt40"><div class="b-post-calculate_fields"><div ng-if="calculation.insured_object"><h3 class="c-tac">Расчет с КБМ произведен!</h3><p>Вы можете оформить полис ОСАГО онлайн! Для этого просто нажмите "Оформить" для выбранного вами тарифа, заполните данные водителей и транспортного средства, после чего с вами свяжется менеджер и подтвердит оформление полиса!</p></div><div ng-if="!calculation"><h3 class="c-tac">Ваше ОСАГО может быть дешевле!</h3><p>Расчет стоимости полиса ОСАГО произведен без КБМ (Коэффициент Бонус-Малус). Нажмите "Рассчитать с КБМ" для получения точных данных о стоимости страхового полиса.</p><div class="c-tac"><button class="ui button teal" type="button">Рассчитать с КБМ</button></div></div></div><div ng-if="$root.driversToKBM && calculation.insured_object" class="b-content_title" style="position: relative; top: 40px; left: 20px; color: #959595" ng-repeat="driver in $root.driversToKBM"><h2>{{driver.first_name}} {{driver.last_name}} КБМ {{$root.driversKBM[$index]}}</h2></div><div class="ui form b-full-width-bg_white"><div class="p20"><div class="css-divider-tilde ui divider horizontal header">~</div><h2 class="b-content_title c-tac mt30">Найдено: <span ng-bind="resultsFull.length"></span> вариантов</h2><div class="ui grid three column stackable bottom aligned mt30"><div class="b-result column" align="center" tabindex="0" ya-metrika="m-insurance-company" ng-repeat="result in resultsFull" ng-if="result.program.sum && result.program.sum != 0" ng-mousedown="selectResult(result)" ng-keypress="$event.keyCode == 13 && selectResult(result)" ng-class="{\'b-result--selected\': result.id === selectedResult.id}"><div class="b-result__content"><img ng-src="{{result.company_logo}}" alt=""><div class="b-result_sum c-tac mt10"><button class="ui button teal m0" type="button">Купить за <span ng-bind="result.program.sum | priceFormatter:0:\'\':false"></span>.<small ng-bind="result.program.sum | fractionalFormatter:2"></small> руб.</button></div></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.usago/calculatorStepsU/views/step.usago_car.html",'<div class="c-ct__content-usago__car" car-inline=""><div class="ui grid three column stackable"><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Марка автомобиля:</div><div class="ui selection search dropdown large" ng-model="car.car_mark" ng-change="carMarksChanged()" required="required" sem-dropdown="" sem-dropdown-items="carMarks" sem-dropdown-placeholder="Не выбрана"></div></div></div><div class="column"><div class="field" ng-class="{disabled: !car.car_mark}"><div class="c-ct__content-title c-tal">Год выпуска:</div><div sem-dropdown-items="monYears" class="ui selection dropdown large" sem-dropdown="" ng-required="car.car_mark" ng-change="carManufacturingYearChanged()" sem-dropdown-placeholder="Не выбран" ng-class="$root.currentBrand.year_of_the_car_color" sem-dropdown-simple="true" ng-model="calculation.car_manufacturing_year"></div></div></div><div class="column"><div class="field" ng-class="{disabled: !calculation.car_manufacturing_year}"><div class="c-ct__content-title c-tal">Модель:</div><div class="ui selection search dropdown large" ng-model="car.car_model_group" ng-change="carModelGroupChanged()" ng-required="calculation.car_manufacturing_year" sem-dropdown="" sem-dropdown-items="carModelGroups" sem-dropdown-placeholder="Не выбрана"></div></div></div></div><div class="row"><div class="column"><div class="field" ng-class="{disabled: !car.car_model_group}"><div class="c-ct__content-title c-tal">Модификация:</div><div class="ui selection search dropdown large" ng-model="car.car_model" ng-change="carModelChanged()" ng-required="car.car_model_group" sem-dropdown="" sem-dropdown-items="carModels" sem-dropdown-placeholder="Не выбрана"></div></div></div></div></div><div class="c-tac mt35"><button class="ui button teal big" ng-disabled="!car.car_model" ng-click="toNextStep(\'usago_car\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_drivers_full.html",'<div class="c-ct__content-usago__drivers_full" drivers-full=""><div class="ui three column stackable centered grid mb20"><div class="row"><div class="left floated column"><div class="field mt15"><div class="c-ct__content-title c-tal">Количество водителей:</div><div class="ui search selection dropdown large" id="id_drivers_count" sem-dropdown="" ng-model="calculatorParams.drivers_count_full" ng-class="{disabled: calculation.is_legal_entity}" ng-change="driversCountChanged()" sem-dropdown-items="driversCountOsagoFull"></div></div></div></div></div><div class="b-drivers_osago is-form" ng-form="drivers_form"><div ng-repeat="driver in drivers" ng-form="driver_form" class="is-form"><div class="ui grid three column stackable"><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Фамилия:</div><div class="ui input large"><input type="text" required="" ng-pattern="calculatorParams.name_pattern" id="id_driver_osago_last_name_{{$index}}" ng-model="driver.last_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Имя:</div><div class="ui input large"><input type="text" class="ui input" required="" ng-pattern="calculatorParams.name_pattern" id="id_driver_osago_first_name_{{$index}}" ng-model="driver.first_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Отчество:</div><div class="ui input large"><input type="text" class="ui input" ng-pattern="calculatorParams.name_pattern" id="id_driver_osago_patronymic_{{$index}}" ng-model="driver.patronymic"></div></div></div></div><div class="row bottom aligned ui grid"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Вод. удостоверение:</div><div class="ui grid"><div class="seven wide column"><div class="field"><div class="ui input large"><input type="text" class="ui input" required="" maxlength="4" minlength="4" placeholder="Серия" id="id_driver_license_series" ng-model="driver.driver_license.series"></div></div></div><div class="nine wide column"><div class="field"><div class="ui input large"><input type="text" class="ui input" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" id="id_driver_license_number" ng-model="driver.driver_license.number"></div></div></div></div></div></div><div class="column"><div class="field" ng-class="{error: driver.dateIsInvalid}"><div class="c-ct__content-title c-tal">Дата начала стажа:</div><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(0, 73) }}" jdatepicker-only-past="true" ng-change="driversDateChanged(driver)" placeholder="__.__.____" id="id_driving_experience_started_{{$index}}" required="" ng-model="driver.driving_experience_started"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field" ng-class="{error: driver.dateIsInvalid}"><div class="c-ct__content-title c-tal">Дата рождения:</div><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(18, 91) }}" jdatepicker-only-past="true" ng-change="driversDateChanged(driver);" placeholder="__.__.____" id="id_driver_birth_date_{{$index}}" required="" ng-model="driver.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div><div class="ui divider mt30 mb15" ng-if="drivers.length > 1 && (drivers.length - 1) !== $index"></div></div><div ng-repeat="person in persons" ng-form="person_form" ng-model="person" class="is-form"><div class="ui loader"></div><div class="ui grid four column stackable"><div class="row"><div class="column"><div class="field"><label for="id_person_osago_last_name_{{$index}}">Фамилия:</label> <input type="text" required="" ng-pattern="calculatorParams.name_pattern" id="id_person_osago_last_name_{{$index}}" ng-model="person.last_name"></div></div><div class="column"><div class="field"><label for="id_person_osago_first_name_{{$index}}">Имя:</label> <input type="text" required="" ng-pattern="calculatorParams.name_pattern" id="id_person_osago_first_name_{{$index}}" ng-model="person.first_name"></div></div><div class="column"><div class="field"><label for="id_person_osago_patronymic_{{$index}}">Отчество:</label> <input type="text" ng-pattern="calculatorParams.name_pattern" id="id_person_osago_patronymic_{{$index}}" ng-model="person.patronymic"></div></div><div class="column"><div class="field"><label for="id_person_birth_date_{{$index}}">Дата рождения:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(18, 91) }}" jdatepicker-only-past="true" placeholder="__.__.____" id="id_person_birth_date_{{$index}}" required="" ng-model="person.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div><div class="row ui grid"><div class="six wide column"><div class="field"><label for="id_person_passport">Паспорт:</label><div class="ui grid"><div class="seven wide column"><div class="field"><input type="text" required="" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_passport" ng-model="person.passport.series"></div></div><div class="nine wide column"><div class="field"><input type="text" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" ng-model="person.passport.number"></div></div></div></div></div><div class="four wide column"><div class="field"><label for="id_person_passport_issue_date_{{$index}}">Дата выдачи:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 26)}}" placeholder="__.__.____" id="id_person_passport_issue_date_{{$index}}" required="" ng-model="person.passport.issue_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div></div></div><div class="c-tac mt35"><button class="ui button teal big" ng-disabled="drivers_form.$invalid" ng-click="toNextStep(\'usago_drivers_full\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_drivers_simple.html",'<div class="c-ct__content-usago__drivers"><div class="c-ct__content"><div class="nowrap css-show-errors ui grid stackable relaxed"><div class="six wide column ui grid"><div class="field"><div class="c-ct__content-title c-tal">Количество водителей:</div><div class="wide column"><div class="ui search selection dropdown large w100p" sem-dropdown="" ng-click="calculatorParams.field_was_clicked = true;" ng-focus="calculatorParams.field_was_clicked = true;" ng-class="{disabled: calculation.is_legal_entity}" ng-change="calculatorParams.field_was_clicked && calculatorParams.driversCountChangedSimple()" ng-model="calculatorParams.drivers_count" sem-dropdown-items="dicts.driversCountOsagoSimple"></div></div></div></div><div class="eight wide column m0 ui grid"><div class="field" ng-repeat="driver in calculation.driver_set"><div class="c-ct__content-title c-tal">Возраст и стаж водителя:</div><div class="ui grid"><div class="eight wide column"><div class="field" ng-class="{\'error\': driver.age < 18 || driver.age > 87}"><div class="ui input large"><input type="text" ng-model="driver.age" input-integer="" required=""></div></div></div><div class="eight wide column"><div class="field" ng-class="{\'error\': driver.age - driver.expirience < 18}"><div class="ui input large"><input type="text" ng-model="driver.expirience" input-integer="" required=""></div></div></div></div></div></div></div></div><div class="c-tac mt35"><button class="ui button teal big" ng-click="toNextStep(\'usago_drivers_simple\')" ng-disabled="driversAreInvalid(calculation.driver_set)" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_drivers_simple_full.html",'<div class="is-form pr50 pt70" drivers-full="" ng-form="drivers_simple_full"><div class="w70p m0a"><div class="ui grid two column mb20"><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal m0 mb5">Регион регистрации собственника:</div><div class="ui search selection dropdown large" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" ng-class="{loading: !ownerRegistration.$$state.value.length}" ya-metrika="m-car-region" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.owner_registration" sem-dropdown-items="ownerRegistration"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal m0 mb5"><br>Мощность двигателя, л.с.:</div><div><div class="ui input large"><input type="text" placeholder="120" ng-model="calculationInterParams.engine_power" price-formatter="2" class="input-has-slider" required="" no-empty=""></div><div input-slider="" is-sum="true" default-min="10" slider-step="10" default-max="600" ng-model="calculationInterParams.engine_power"></div></div></div></div></div><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal m0 mb5">Количество водителей:</div><div class="ui search selection dropdown large" sem-dropdown="" ng-click="calculatorParams.field_was_clicked = true;" ng-focus="calculatorParams.field_was_clicked = true;" ng-class="{disabled: calculation.is_legal_entity}" ng-change="calculatorParams.field_was_clicked && driversCountChanged()" ng-model="calculatorParams.drivers_count_full" sem-dropdown-items="dicts.driversCountOsagoSimple"></div></div></div><div class="column"><div ng-repeat="driver in drivers"><div class="ui fields"><div class="ten wide field"><div class="c-ct__content-title c-tal m0 mb5">Дата рождения:</div><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(18, 91) }}" jdatepicker-only-past="true" placeholder="__.__.____" required="" ng-model="driver.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div><div class="six wide field" ng-class="{\'error\': !driver.expirience && driver.expirience != 0}"><div class="c-ct__content-title c-tal m0 mb5">Стаж:</div><div class="ui input large"><input type="text" ng-change="driversFullExperienceChanged(driver)" ng-model="driver.expirience" input-integer="" required=""></div></div></div></div></div></div></div><div class="css-divider-tilde ui divider horizontal header">~</div><h3 class="c-tac mb25">При заполнении личных данных водителей будет произведен расчет с учетом <a href="http://www.autoins.ru/ru/help/bonusmalus.wbp" target="_blank">КБМ</a>.</h3></div><div class="b-drivers_osago is-form pl40 pr40" ng-form="drivers_form"><div ng-repeat="driver in drivers" ng-form="driver_form" class="is-form"><div class="ui grid three column stackable"><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Фамилия:</div><div class="ui input large"><input type="text" ng-required="requiringDrivers(driver)" ng-pattern="calculatorParams.name_pattern" ng-model="driver.last_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Имя:</div><div class="ui input large"><input type="text" class="ui input" ng-required="requiringDrivers(driver)" ng-pattern="calculatorParams.name_pattern" ng-model="driver.first_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Отчество:</div><div class="ui input large"><input type="text" class="ui input" ng-required="requiringDrivers(driver)" ng-pattern="calculatorParams.name_pattern" ng-model="driver.patronymic"></div></div></div></div><div class="row bottom aligned"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Вод. удостоверение:</div><div class="ui fields mb0"><div class="seven wide field"><div class="ui input large"><input type="text" class="ui input" maxlength="4" minlength="4" ng-required="requiringDrivers(driver)" placeholder="Серия" ng-model="driver.driver_license.series"></div></div><div class="nine wide field"><div class="ui input large"><input type="text" class="ui input" input-integer="" maxlength="6" minlength="6" placeholder="Номер" ng-required="requiringDrivers(driver)" ng-model="driver.driver_license.number"></div></div></div></div></div></div></div><div class="ui divider mt30 mb15" ng-if="drivers.length > 1 && (drivers.length - 1) !== $index"></div></div></div><div class="c-tac mt35"><button class="ui button red big" ng-disabled="drivers_simple_full.$invalid" ng-click="toNextStep(\'usago_drivers_simple_full\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_engine_power.html",'<div class="c-ct__content-usago__engine-power"><div class="c-ct__content"><div class="m0a"><div class="inline field c-tac"><div class="c-ct__content-title m0 mb10">Мощность двигателя, л.с.:</div><div class="css-dib"><div class="ui input large"><input type="text" placeholder="120" ng-model="calculationInterParams.engine_power" price-formatter="2" class="input-has-slider c-tac" required="" no-empty=""></div><div input-slider="" is-sum="true" default-min="10" slider-step="10" default-max="600" ng-model="calculationInterParams.engine_power"></div></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ng-disabled="!calculationInterParams.engine_power || (calculationInterParams.engine_power == 0)" ng-click="toNextStep(\'usago_engine_power\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_ordering_full.html",'<div class="c-ct__content-usago__ordering_full" ng-if="getActiveStepSecond().name === \'usago_ordering_full\'"><div ng-controller="policyOrderingCtrl" policy-ordering-full="" ng-form="ordering_form" class="is-form"><div class="p30"><h3 class="b-content_title m0">Автомобиль:</h3><h3 class="b-content_title p20 mt10"><strong><span ng-bind="carInfo.carMark.title"></span> <span ng-bind="carInfo.carModelGroup.title"></span> <span ng-bind="carInfo.carModel.title"></span> — <span ng-bind="calculation.car_manufacturing_year"></span> г. выпуска, <span ng-bind="calculation.engine_power"></span> л.с.</strong></h3><h3 class="b-content_title mt30">Водители:</h3><h3 class="b-content_title p20 mt10" ng-show="!calculation.is_multidrive"><div ng-repeat="driver in calculation.driver_set"><strong>Возраст - <span ng-bind="driver.age"></span>, стаж - <span ng-bind="driver.expirience"></span></strong></div></h3><h3 class="b-content_title p20 mt10" ng-show="calculation.is_multidrive"><div><strong>Минимальный возраст - <span ng-bind="calculation.drivers_minimal_age"></span>, минимальный стаж - <span ng-bind="calculation.drivers_minimal_experience"></span></strong></div></h3><h3 class="b-content_title mt30">Страховой продукт:</h3><h3 class="b-content_title m0 mt10"><div><strong>Компания: <span ng-bind="carFilterParams.getCompanyTitle()"></span></strong></div><div><strong>Тариф: <span ng-init="result = carFilterParams.selectedResult()"><span ng-bind="(result.sumWithKBM || carFilterParams.selectedResult().program.sum) | priceFormatter:0:\'\':false"></span>.<small ng-bind="(result.sumWithKBM || carFilterParams.selectedResult().program.sum) | fractionalFormatter:2"></small> р.</span></strong></div></h3></div></div><div class="mt40"><div policy-ordering=""></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_personal_data_car.html",'<div class="c-ct__content-usago__personal_data_car is-form" ng-form="personal_data_car_form" ng-if="getActiveStepSecond().name === \'usago_personal_data_car\'" personal-data-car=""><div class="c-ct__content"><div class="ui grid two column stackable"><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">VIN-номер:</div><div class="ui input large"><input type="text" required="" ng-model="car.vin_number"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Гос. регистрационный знак:</div><div class="ui input large"><input type="text" required="" ng-model="car.number_plate"></div></div></div></div><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">СТС/ПТС:</div><div class="ui grid mb0"><div class="seven wide column"><div class="ui input large"><input type="text" class="ui input" required="" maxlength="4" minlength="4" placeholder="Серия" ng-model="car.document_series"></div></div><div class="nine wide column"><div class="ui input large"><input type="text" class="ui input" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" ng-model="car.document_number"></div></div></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Дата получения:</div><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(0, 73) }}" jdatepicker-only-past="true" placeholder="__.__.____" id="id_driving_experience_started_{{$index}}" required="" ng-model="car.document_issue_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div></div><div class="c-tac mt35"><button class="ui button teal big" ng-disabled="personal_data_car_form.$invalid" ng-click="toNextStep(\'usago_personal_data_car\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_personal_data_persons.html",'<div personal-data-persons="" class="c-ct__content-usago__personal_data_persons" ng-if="getActiveStepSecond().name === \'usago_personal_data_persons\'"><form name="personForm"><div class="b-full-width-bg_white b-f-policy_person ui form is-form" ng-repeat="person in persons"><div class="ui loader"></div><div class="ui form"><div class="ui grid stackable"><div class="row"><div class="eleven wide column"></div><div class="five wide column"><div class="field without-dropdown-placeholder" style="min-width: 140px;"><div ng-if="!$index"><div class="ui floating blue dropdown button small" ng-model="params.person_type" sem-dropdown="" ng-change="addPerson({}, params.person_type)" sem-dropdown-action="select" sem-dropdown-items="insurantTypes" sem-dropdown-placeholder="Добавить участника договора"></div></div><h3 style="float:right;" ng-if="persons.length > 1"><i class="icon remove red" ng-click="removePerson(person)"></i></h3></div></div></div><div class="row"><div class="seven wide column"><h2 class="b-content_title"><strong>Участник договора (<span ng-bind="person.personType === \'legal_person\' ? \'Юр. лицо\' : \'Физ. лицо\'"></span>)</strong></h2></div><div class="nine wide column"><div class="three fields"><div class="field"><sem-checkbox ng-model="person.isDriver" disabled="disabled" sem-label="Водитель"></sem-checkbox></div><div class="field" ng-class="{error: !personCheckUsed().isOwner}"><sem-checkbox ng-model="person.isOwner" sem-label="Собственник" sem-id="id_is_owner_{{$index}}" ng-change="setPersonType(person, \'isOwner\')" name="person_is_owner"></sem-checkbox></div><div class="field" ng-class="{error: !personCheckUsed().isInsurant}"><sem-checkbox ng-model="person.isInsurant" sem-label="Страхователь" sem-id="id_is_insurant_{{$index}}" ng-change="setPersonType(person, \'isInsurant\')" name="person_is_insurant"></sem-checkbox></div></div></div></div></div><div class="ui grid stackable four column"><div class="row"><div class="column"><div class="field"><label>Фамилия</label> <input type="text" class="ui input" required="" name="last_name" ng-pattern="params.name_pattern" placeholder="Иван" ng-model="person.last_name"></div></div><div class="column"><div class="field"><label>Имя</label> <input type="text" class="ui input" placeholder="Петров" required="" name="first_name" ng-pattern="params.name_pattern" ng-model="person.first_name"></div></div><div class="column"><div class="field"><label>Отчество</label> <input type="text" class="ui input" name="patronymic" ng-pattern="params.name_pattern" placeholder="Александрович" ng-model="person.patronymic"></div></div><div class="column"><div class="field"><label for="id_person_birth_date_{{$index}}">Дата рождения</label><div class="ui icon input"><input type="text" class="ui input" jdatepicker="" jdatepicker-year-range="{{getYearRange(18, 91)}}" name="birth_date" placeholder="__.__.____" id="id_person_birth_date_{{$index}}" required="" ng-model="person.birth_date"> <i class="icon calendar circular blue inverted"></i></div></div></div></div></div><div><div class="ui grid stackable four column"><div class="row"><div class="column"><div class="field"><label for="id_person_passport_series_{{$index}}">Серия и номер паспорта</label><div class="ui fields"><div class="seven field wide mb10"><input type="text" class="ui input" name="person_passport_series" required="" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_passport_series_{{$index}}" ng-model="person.passport.series"></div><div class="nine field wide"><input type="text" class="ui input" name="person_passport_number" placeholder="Номер" required="" input-integer="" maxlength="6" minlength="6" ng-model="person.passport.number"></div></div></div></div><div class="column"><div class="field"><label for="id_person_passport_issue_date_{{$index}}">Дата выдачи</label><div class="ui icon input"><input type="text" class="ui input" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 20)}}" jdatepicker-only-past="true" name="passport_issue_date" placeholder="__.__.____" id="id_person_passport_issue_date_{{$index}}" required="" ng-model="person.passport.issue_date"> <i class="icon calendar circular blue inverted"></i></div></div></div><div class="eight wide column"><div class="field"><label for="id_passport_issue_point">Кем выдан</label> <input type="text" class="ui input" name="passport_issue_point" required="" id="id_passport_issue_point" placeholder="Отделением УФМС по Санкт-Петербургу" ng-model="person.passport.issue_point"></div></div></div></div><div class="row-margin"><div class="b-addresses"><div class="b-address ui stackable grid"><div class="row"><div class="b-address_line column"><div class="p20"><div class="field"><div class="b-addresses_checkboxes mb15"><strong>Адрес регистрации:</strong><sem-checkbox sem-label="Совпадает с фактическим" ng-model="person.is_same_address"></sem-checkbox></div><div dadata="person.address_registration" dadata-type="address"><div class="fields"><div class="ten field wide"><label for="id_address_registration_postal_full">Введите полный адрес:</label><div class="ui transparent input"><input type="text" required="" dadata-target="" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_registration)}" id="id_address_registration_postal_full" ng-model="person.address_registration.full" name="address_registration_postal_full"></div></div><div class="three field wide"><label>Корпус:</label><div class="ui transparent input"><input type="text" title="Корпус" ng-model="person.address_registration.housing" name="address_registration_housing"></div></div><div class="three field wide"><label>Кв./офис:</label><div class="ui transparent input"><input type="text" title="Квартира" ng-model="person.address_registration.flat" name="address_registration_flat"></div></div></div><div class="js-dadata-messages ui pointing red basic label"></div></div></div><div class="field pt10" ng-if="!person.is_same_address"><label class="mb15">Адрес проживания:</label><div dadata="person.address_residential" dadata-type="address"><div class="fields"><div class="ten field wide"><label for="id_address_residential_postal_full">Введите полный адрес:</label><div class="ui transparent input"><input type="text" required="" dadata-target="" ng-change="addressIsValid(person.address_residential)" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_residential)}" id="id_address_residential_postal_full" ng-model="person.address_residential.full" name="address_residential_postal_full"></div></div><div class="three field wide"><label>Корпус:</label><div class="ui transparent input"><input type="text" title="Корпус" ng-change="addressIsValid(person.address_residential)" ng-model="person.address_residential.housing" name="address_residential_housing"></div></div><div class="three field wide"><label>Кв./офис:</label><div class="ui transparent input"><input type="text" title="Квартира" ng-change="addressIsValid(person.address_residential)" ng-model="person.address_residential.flat" name="address_residential_flat"></div></div></div><div class="js-dadata-messages ui pointing red basic label"></div></div></div></div></div></div></div></div></div></div></div><div class="p20"><h3 ng-if="persons.length > 1 && (persons.length - 1) !== $index" class="ui horizontal divider header"><i class="icon users"></i><span></span></h3></div></div><div class="c-tac mt35"><button class="ui button teal big" ng-disabled="personForm.$invalid" ng-click="toNextStep(\'usago_personal_data_persons\')" type="button">Далее</button></div></form></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_precalculation.html",'<div pre-calculation="" ng-if="getCurrentStep() === \'usago_precalculation\'"><div class="c-tac b-content-loading pt40" ng-if="!results.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div ng-if="results.length" class="pt40"><div class="b-post-calculate_fields"><h3 class="c-tac">Ваше ОСАГО может быть дешевле!</h3><p>Расчет стоимости полиса ОСАГО произведен без КБМ (<a href="http://www.autoins.ru/ru/help/bonusmalus.wbp" target="_blank">Коэффициент Бонус­Малус</a>). Нажмите "Рассчитать с КБМ" для получения точных данных о стоимости страхового полиса.</p><div class="c-tac mt25"><button class="ui button teal large" ng-click="toNextStep(\'usago_precalculation\')" type="button">Рассчитать с КБМ</button></div></div><div class="ui form b-full-width-bg_white"><div class="b-post-calculate__items-wrapper"><div class="css-divider-tilde ui divider horizontal header">~</div><h2 class="b-content_title c-tac mt30">Найдено: <span ng-bind="results.length"></span> вариантов</h2><div class="ui grid three column stackable bottom aligned mt30"><div class="b-result column" align="center" tabindex="0" ya-metrika="m-insurance-company" ng-repeat="result in results" ng-if="result.program.sum && result.program.sum != 0" ng-mousedown="selectResult(result)" ng-keypress="$event.keyCode == 13 && selectResult(result)" ng-class="{\'b-result--selected\': result.id === selectedResult.id}"><div class="b-result__content"><img ng-src="{{result.company_logo}}" alt=""><div class="b-result_sum c-tac mt10"><button class="ui button teal m0" type="button">Купить за <span ng-bind="result.program.sum | priceFormatter:0:\'\':false"></span>.<small ng-bind="result.program.sum | fractionalFormatter:2"></small> руб.</button></div></div></div></div><div class="c-ct__ordering--modal" ng-if="selectedResult.id && isSelectedOnPreCalculation"><div class="c-ct__ordering-bg" ng-click="selectResult(null)"></div><div policy-ordering=""></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.usago/calculatorStepsU/views/step.usago_sms_verification.html",'<div class="c-ct__content-usago__sms_verification"><div class="c-ct__content"><div class="ui grid two column doubling stackable css-bigger-labels mtb0"><div class="row one column"><div class="column"><div class="c-tac mb20 c-ct__sms-title">Для получения расчетов стоимости ОСАГО, пройдите бесплатную<br>SMS-верификацию и введите полученный код подтверждения.</div></div></div><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title">Как Вас зовут?</div><div class="ui input large"><input type="text" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" ng-model="clientParams.client_name" placeholder="Имя" id="id_client_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title">Номер телефона:</div><div class="ui input large"><input type="text" ui-mask="+7 (999) 999-9999" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" placeholder="+7 (___) ___-____" model-view-value="true" ng-model="clientParams.client_phone" id="id_client_phone"></div></div></div></div><div class="row" ng-if="!clientParams.sms_is_visible"><div class="sixteen wide column"><sem-checkbox class="mt5" ng-model="clientParams.client_is_agree"></sem-checkbox><h4 class="m0 b-app__agreement-on-sms" ng-click="clientParams.client_is_agree = !clientParams.client_is_agree;"><strong>Я даю согласие на обработку персональных данных</strong><br><small>Обработка персональных данных осуществляется согласно ФЗ РФ №152-ФЗ</small></h4></div></div><div class="row top aligned" ng-if="clientParams.sms_is_visible"><div class="column"><div class="field" ng-class="{error: !clientParams.sms_code}"><div class="c-ct__content-title">Код из СМС:</div><input type="text" ng-model="clientParams.sms_code" placeholder="XXXX" autofocus="autofocus" maxlength="4" input-integer="" id="id_sms_code"></div></div><div class="column"><div class="field c-tac"><div class="c-ct__content-title">&nbsp;</div><button class="ui button green large fluid" ng-disabled="!clientParams.sms_code || clientParams.sms_button_is_disabled || calculationInterParams.sms_button_is_disabled" ng-click="confirmCode()" ng-class="{loading: calculationInterParams.sms_button_is_disabled}" ya-metrika="m-confirm-code" type="button">Проверить</button> <a href="" class="css-bottom-dashed pt5" style="font-size: 15px;" ng-click="clientParams.sms_is_visible = false;">Изменить номер</a></div></div></div><div class="row" ng-show="calculationInterParams.confirm_code_is_incorrect"><div class="sixteen wide column"><div class="ui message error visible">Код СМС не совпал с отправленным.</div></div></div></div></div><div class="c-tac mt15" ng-show="!clientParams.sms_is_visible"><button class="ui button teal big mr20" ng-disabled="!clientParams.client_phone || !clientParams.client_name || clientParams.client_params_are_disabled || !clientParams.client_is_agree" ng-click="showSMSform()" ya-metrika="m-send-sms-code" type="button">Отправить</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_start_date.html",'<div class="c-ct__content-usago__params"><div class="c-ct__content is-form" ng-form="insurance_params_form"><div class="m0a"><div class="inline field c-tac"><div class="c-ct__content-title m0 mb5">Дата начала действия договора:</div></div><div class="c-ct__content-insurance_day"><div class="ui centered grid"><div class="six wide computer six wide tablet twelve wide mobile column"><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(-1, 0)}}" jdatepicker-only-future="true" placeholder="__.__.____" id="id_calculation_at_date" name="calculation_at_date" required="" ng-model="calculation.calculation_at_date"> <i class="icon calendar circular branded inverted"></i></div><div class="ui right pointing label" ng-show="calculation.calculation_at_date && insurance_params_form.calculation_at_date.$invalid">Застраховаться можно только с завтрашнего дня</div></div></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ng-disabled="insurance_params_form.$invalid" ng-click="toNextStep(\'usago_start_date\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/calculatorStepsU/views/step.usago_year.html",'<div class="pt100"><div class="c-ct__content"><div class="m0a" style="max-width: 400px;"><div class="field" ng-init="years = calculatorParams.getYRange(\'now\', 1900)"><div class="c-ct__content-title m0 mb10">Выберите год выпуска автомобиля:</div><div class="ui search selection dropdown large fluid" sem-dropdown="" ng-model="calculation.car_manufacturing_year" sem-dropdown-placeholder="Год автомобиля" sem-dropdown-items="years"></div></div></div></div><div class="c-tac mt15"><button class="ui button teal big" ng-disabled="!calculation.car_manufacturing_year" ng-click="toNextStep(\'usago_year\')" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/carFilterU/views/car_filter.car_group_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModelGroups || !carModelGroups.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="c-ct__button c-ct__button--large c-ct__button--green" ng-repeat="item in carModelGroups | carFilterYears:calculationInterParams.car_manufacturing_year.id | orderBy:\'rank\':reverse" title="{{item.title}}" ng-click="selectCarModelGroup(item)" ya-metrika="m-group-of-the-car" ng-keypress="$event.keyCode == 13 && selectCarModelGroup(item)"><span ng-bind="item.title"></span></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/carFilterU/views/car_filter.car_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModels || !carModels.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="c-ct__button c-ct__button--large c-ct__button--green" ng-repeat="item in carModels | carFilterYears:calculationInterParams.car_manufacturing_year.id | orderBy:\'rank\':reverse" title="{{item.title}}" ng-click="selectCarModel(item, true)" ya-metrika="m-group-of-the-car" ng-keypress="$event.keyCode == 13 && selectCarModel(item, true)"><span ng-bind="item.title"></span></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/carFilterU/views/program_list.manager.html",'<div class="c-ct__recalculation"><div class="c-ct__recalculation-block"><div class="c-ct__recalculation-block-content"><div class="c-ct__recalculation-calc-info"><span dictionary-id="calculation.exploitation_area" dictionary-prop="title" dictionary="exploitationArea">Санкт-Петербург</span>; <span ng-bind="carAllSelected.carMark.title"></span> <span ng-bind="carAllSelected.carModel.title"></span>; <span ng-bind="calculation.car_manufacturing_year"></span> года; <span ng-repeat="item in calculation.driver_set">Пол: <span ng-bind="item.gender === \'M\' ? \'муж.\' : \'жен.\'"></span>, лет: <span ng-bind="item.age"></span>, стаж: <span ng-bind="item.expirience"></span>;<br></span><div class="c-tac mt15"><a href="" ng-click="bigSteps.setBigStep(\'first\')">Изменить</a></div></div></div><div class="ui divider"></div><div class="ui grid centered"><div class="five wide column"><div class="field"><div class="c-ct__content-title m0 mb5 c-tal">Франшиза (руб):</div><div class="ui input w100p"><input type="text" id="id_deductible_value" class="input-has-slider" name="deductible_value" ng-model="params.deductible_value" ng-change="calculateKaskoDebounced()"></div><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="50000" ng-model="params.deductible_value"></div></div></div><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Сумма страхования:</div><div class="ui input w100p"><input type="text" placeholder="500 000" ng-model="calculation.car_cost" price-formatter="2" class="input-has-slider" ng-change="calculateKaskoDebounced()" required="" no-empty=""></div><div input-slider="{maxSum: calculationInterParams.car_cost_max, minSum: calculationInterParams.car_cost_min}" is-sum="true" default-min="{{calculationInterParams.car_cost_min || 100000}}" default-max="{{calculationInterParams.car_cost_max || 3000000}}" slider-step="10000" ng-model="calculation.car_cost"></div></div></div><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Спутниковая система:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Не выбрана" ng-model="calculationInterParams.antitheft" sem-dropdown-items="antiThefts"></div></div></div></div><div class="ui c-ct__addit-parameters" ng-class="{\'c-ct__addit-parameters--active\': postCalculateParams.opened}"><div class="ui grid centered"><div class="fiveteen wide column"><button class="ui button c-ct__addit-parameters--toggle" ng-click="postCalculateParams.opened = !postCalculateParams.opened" type="button">Дополнительные параметры <i class="chevron down icon"></i></button> <button class="ui right floated button small green" ng-click="calculateKasko()">Пересчитать</button></div></div></div><div class="ui grid c-ct__parametrs-block" ng-if="postCalculateParams.opened"><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Куплен в кредит:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Да" ng-model="calculation.is_credit" sem-dropdown-items="yesNo"></div></div></div><div class="five wide column"><div class="field"><div class="c-ct__content-title c-tal">Были страховые случаи:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Нет" ng-model="calculation.count_years_break_even_insurance" sem-dropdown-items="yesNo"></div></div></div><div class="six wide column"><div class="field"><div class="c-ct__content-title c-tal">Ремонт:</div><div class="ui search selection dropdown w100p" sem-dropdown="" sem-dropdown-placeholder="Официальный дилер" ng-model="calculation.with_repair" sem-dropdown-items="paymentForm"></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.usago/carFilterU/views/third_big_step.html",'<div class="c-ct__content-usago__third_big_step" ng-if="bigSteps.getBigStep().name === \'third\'"><div ng-controller="policyOrderingCtrl" policy-ordering-full="" ng-form="ordering_form" class="is-form"><div class="p30"><h3 class="b-content_title m0">Автомобиль:</h3><h3 class="b-content_title p20 mt10"><strong><span ng-bind="carInfo.carMark.title"></span> <span ng-bind="carInfo.carModelGroup.title"></span> <span ng-bind="carInfo.carModel.title"></span> — <span ng-bind="calculation.car_manufacturing_year"></span> г. выпуска, <span ng-bind="calculation.engine_power"></span> л.с.</strong></h3><h3 class="b-content_title mt30">Водители:</h3><h3 class="b-content_title p20 mt10" ng-show="!calculation.is_multidrive"><div ng-repeat="driver in calculation.driver_set"><strong>Возраст - <span ng-bind="driver.age"></span>, стаж - <span ng-bind="driver.expirience"></span></strong></div></h3><h3 class="b-content_title p20 mt10" ng-show="calculation.is_multidrive"><div><strong>Минимальный возраст - <span ng-bind="calculation.drivers_minimal_age"></span>, минимальный стаж - <span ng-bind="calculation.drivers_minimal_experience"></span></strong></div></h3><h3 class="b-content_title mt30">Страховой продукт:</h3><h3 class="b-content_title m0 mt10"><div><strong>Компания: <span ng-bind="carFilterParams.getCompanyTitle()"></span></strong></div><div><strong>Тариф: <span ng-init="result = carFilterParams.selectedResult()"><span ng-bind="(result.sumWithKBM || carFilterParams.selectedResult().program.sum) | priceFormatter:0:\'\':false"></span>.<small ng-bind="(result.sumWithKBM || carFilterParams.selectedResult().program.sum) | fractionalFormatter:2"></small> р.</span></strong></div></h3></div></div><div class="mt40"><div policy-ordering=""></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/policyOrdering/views/policy_ordering.fast.html",'<div class="c-ct__ordering" ng-init="client_is_agree"><div class="is-form" ng-form="policy_ordering_form"><i class="close icon" ng-click="selectResult(null)"></i><h3>Введите контактные данные для оформления:</h3><div class="ui grid two column stackable css-bigger-labels mt20"><div class="row"><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Как Вас зовут?</div><div class="ui input large"><input type="text" ng-init="calculation.client_name = \'\'" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" ng-model="calculation.client_name" placeholder="Имя" required="" id="id_client_name"></div></div></div><div class="column"><div class="field"><div class="c-ct__content-title c-tal">Номер телефона:</div><div class="ui input large"><input type="text" ui-mask="+7 (999) 999-9999" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" placeholder="+7 (___) ___-____" model-view-value="true" required="" ng-model="calculation.client_phone" id="id_client_phone"></div></div></div></div><agreement-checkbox ng-if="!$root.currentBrand.with_sms" checked="clientParams.client_is_agree" changed="clientParams.client_is_agree = $value"></agreement-checkbox></div><div class="mt20"><div><sem-checkbox ng-model="poParams.receipt_type" sem-label="{{params.deliveryTypeTitle}}" sem-type="radio" class="mr25" name="receipt_type" value="delivery"></sem-checkbox><sem-checkbox ng-model="poParams.receipt_type" sem-label="{{params.deliveryInOfficeTitle}}" sem-type="radio" name="receipt_type" value="office"></sem-checkbox></div><div class="mt15" ng-if="poParams.receipt_type === \'delivery\'"><div class="field"><div class="c-ct__content-title c-tal">Адрес доставки:</div><div class="ui input large"><input type="text" ng-model="poParams.delivery_address"></div></div></div><div class="mt15" ng-if="poParams.receipt_type === \'office\'"><div class="two wide fields"><div class="field" ng-class="{error: formFields.arrival_date && ordering_form.arrival_date.$invalid}"><div class="c-ct__content-title c-tal">Дата оформления:</div><div class="ui icon input large"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="true" name="arrival_date" placeholder="__.__.____" required="" ng-model="poParams.arrival_date"> <i class="icon calendar circular branded inverted"></i></div></div><div class="field" ng-if="!$root.currentBrand.arrival_time_is_hidden"><div class="c-ct__content-title c-tal">Время оформления:</div><div class="ui input large"><input type="text" required="" ui-mask="99:99" ng-pattern="/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/" placeholder="__:__" ng-model="poParams.arrival_time"></div></div></div></div><div class="mt15 c-tac"><button class="ui button teal large" ng-disabled="policy_ordering_form.$invalid" ng-click="sendLetter()" type="button">Оформить</button></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/calculator.html",'<div ng-include="templates.navigation"></div><div class="calculator-block main-content-body template-{{$root.calcType}}"><div ng-form="calculation_form" autocomplete="off" ng-class="{\'calculation-form_error\': params.show_empty_fields}" class="calculation-form"><div ui-view=""></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/document_uploader.html",'<ul class="uploader-queue" nv-file-drop="" nv-file-over="" uploader="uploader" over-class="uploader-queue_over"><li ng-if="!uploadedFiles.length && !uploader.queue.length">Загрузка файлов</li><li ng-repeat="file in uploadedFiles" class="list-item animation-fade"><div ng-if="file.mime_type.indexOf(\'image/\') !== -1"><a ng-href="{{file.file_url}}" target="_blank"><img ng-src="{{file.file_url}}" alt="{{file.description}}" height="70"></a></div><div ng-if="file.mime_type === \'application/pdf\'"><a ng-href="{{file.file_url}}" target="_blank"><img ng-src="{{params.images_path}}pdf.png" alt="{{file.description}}" height="70"></a></div><div ng-if="file.mime_type === \'application/msword\' || isDocument(file.mime_type)"><a ng-href="{{file.file_url}}" target="_blank"><img ng-src="{{params.images_path}}doc_icon.png" alt="{{file.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="removeUploadedImage(file)" class="ui button red mini">Удалить</button></div></li><li ng-repeat="item in uploader.queue" class="list-item animation-fade"><div ng-if="item._file.type.indexOf(\'image/\') !== -1"><div ng-thumb="{ file: item._file, height: 70 }"></div></div><div ng-if="item._file.type === \'application/pdf\'"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}pdf.png" alt="{{item.description}}" height="70"></a></div><div ng-if="item._file.type === \'application/msword\' || isDocument(item._file.type)"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}doc_icon.png" alt="{{item.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="item.remove()" class="ui button red mini">Удалить</button></div></li></ul>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/go_back_btn.html",'<button type="button" ng-class="$root.currentBrand.united_buttons_color" class="ui button small">Назад</button>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/move_to_step.html",'<div class="c-change-step"></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/navigation.html",'<div class="b-steps"><div class="ui steps" ng-controller="calculatorNavigationCtrl"><div class="step" ng-repeat="navItem in navigation track by $index" ng-click="navItem.onClick()" ng-if="!navItem.isHidden()" ng-class="{ active: navItem.active(), disabled: navItem.condition_disabled() }"><i class="icon" ng-class="navItem.icon"></i><div class="content"><div class="title" ng-bind-html="navItem.title"></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/person/views/person.html",'<h1 class="main-content-header">Данные профиля</h1><div class="main-content-body"><form name="person_form" class="person_edit-form" ng-submit="savePerson()"><div class="control-row"><div class="f_policy-driver-last_name-block"><label for="id_last_name" class="fp-label">Фамилия:</label> <input type="text" ng-model="person.last_name" class="input-text input-sub_medium" id="id_last_name" name="last_name" required=""></div><div class="f_policy-driver-first_name-block"><label for="id_first_name" class="fp-label">Имя:</label> <input type="text" ng-model="person.first_name" class="input-text input-sub_medium" id="id_first_name" name="first_name" required=""></div><div class="f_policy-driver-patronymic-block"><label for="id_patronymic" class="fp-label">Отчество:</label> <input type="text" ng-model="person.patronymic" class="input-text input-sub_medium" id="id_patronymic" name="patronymic"></div></div><div class="control-row"><div class="f_policy-driver-driver_license-block"><label for="id_driver_license_series" class="fp-label">Водительское<br>удостоверение:</label> <input type="text" ng-model="person.driver_license.series" class="input-text input-nano" maxlength="4" id="id_driver_license_series" name="driver_license_series" required=""> <input type="text" ng-model="person.driver_license.number" class="input-text input-small" maxlength="6" id="id_driver_license_number" name="driver_license_number" required=""></div><div class="f_policy-driver-driver_license_date-block"><label for="id_driver_license_date_{{$index}}" class="fp-label"><br>Дата получения прав:</label> <span class="input-date-wrap"><input type="text" jdatepicker="" jdatepicker-year-count="90" ng-model="person.driver_license.issue_date" class="input-date input-mini" id="id_driver_license_date_{{$index}}" name="driver_license_date" required=""> <i class="icon-calendar"></i></span></div><div class="f_policy-driver-birth_date-block"><label for="id_birth_date_{{$index}}" class="fp-label"><br>Дата рождения:</label> <span class="input-date-wrap"><input type="text" jdatepicker="" jdatepicker-year-count="90" ng-model="person.birth_date" class="input-date input-mini" id="id_birth_date_{{$index}}" name="birth_date" required=""> <i class="icon-calendar"></i></span></div></div><div class="control-row"><div class="f_policy-driver-passport-block"><label for="id_passport_series" class="fp-label">Серия, номер паспорта:</label> <input type="text" input-integer="" ng-model="person.passport.series" class="input-text input-nano" maxlength="4" id="id_passport_series" name="passport_series" required=""> <input type="text" input-integer="" ng-model="person.passport.number" class="input-text input-small" maxlength="6" id="id_passport_number" name="passport_number" required=""></div><div class="f_policy-driver-passport_point-block"><label for="id_passport_point" class="fp-label">Кем выдан:</label> <input type="text" ng-model="person.passport.issue_point" class="input-text input-big" id="id_passport_point" name="passport_point"></div><div class="f_policy-driver-passport_date-block"><label for="id_passport_date_{{$index}}" class="fp-label">Дата выдачи:</label> <span class="input-date-wrap"><input type="text" jdatepicker="" jdatepicker-year-count="90" ng-model="person.passport.issue_date" class="input-date input-mini" id="id_passport_date_{{$index}}" name="passport_date" required=""> <i class="icon-calendar"></i></span></div></div><div class="control-row"><div class="f_policy-driver-address-block"><div class="f_policy-driver-address_registration-block"><label for="id_address_registration_postal_index" class="fp-label">Адрес регистрации:</label><div class="input-wrapper"><input type="text" ng-model="person.address_registration.postal_index" class="input-text input-mini" placeholder="индекс" maxlength="6" id="id_address_registration_postal_index" name="address_registration_postal_index"> <input type="text" ng-model="person.address_registration.city" class="input-text input-mini" placeholder="город" id="id_address_registration_city" name="address_registration_city"> <input type="text" ng-model="person.address_registration.street" class="input-text input-mini" placeholder="улица" id="id_address_registration_street" name="address_registration_street"> <input type="text" ng-model="person.address_registration.house" class="input-text input-nano" placeholder="дом" id="id_address_registration_house" name="address_registration_house"> <input type="text" ng-model="person.address_registration.housing" class="input-text input-nano" placeholder="корп." id="id_address_registration_housing" name="address_registration_housing"> <input type="text" ng-model="person.address_registration.flat" class="input-text input-nano" placeholder="кв." id="id_address_registration_flat" name="address_registration_flat"></div></div><div class="f_policy-driver-address_residential-block" ng-if="!person.is_same_address"><label for="id_address_residential_postal_index" class="fp-label">Адрес проживания:</label><div class="input-wrapper"><input type="text" ng-model="person.address_residential.postal_index" class="input-text input-mini" placeholder="индекс" maxlength="6" id="id_address_residential_postal_index" name="address_residential_postal_index"> <input type="text" ng-model="person.address_residential.city" class="input-text input-mini" placeholder="город" id="id_address_residential_city" name="address_residential_city"> <input type="text" ng-model="person.address_residential.street" class="input-text input-mini" placeholder="улица" id="id_address_residential_street" name="address_residential_street"> <input type="text" ng-model="person.address_residential.house" class="input-text input-nano" placeholder="дом" id="id_address_residential_house" name="address_residential_house"> <input type="text" ng-model="person.address_residential.housing" class="input-text input-nano" placeholder="корп." id="id_address_residential_housing" name="address_residential_housing"> <input type="text" ng-model="person.address_residential.flat" class="input-text input-nano" placeholder="кв." id="id_address_residential_flat" name="address_residential_flat"></div></div></div><div class="f_policy-driver-is_same_address-block"><div class="sub-block"><input type="checkbox" ng-model="person.is_same_address" class="checkbox" id="id_is_same_address" name="is_same_address"> <label for="id_is_same_address">Совпадает с фактическим</label></div></div></div><div class="form-actions"><button type="submit" ng-disabled="isSavePersonProgress" class="button person-submit">Сохранить <i class="icon-done"></i></button><div loading-spinner="isSavePersonProgress" class="calc-loading"></div></div></form></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/person/views/person.save_message.success.html",'<form name="person_message_success" class="formation_policy_message-form ngdialog-form" ng-submit="closeThisDialog()"><div class="ngdialog-message">Персона сохранена</div><div class="form-actions"><button type="submit" class="button person_message_success-submit-button">Ок</button></div></form>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/appMessage/views/messages_template.html",'<div class="b-messages"><div ng-repeat="message in $root.messages" ng-class="message.type" class="b-messages_item ui message"><i class="icon close" ng-click="message.close()"></i><div ng-if="!message.isList" compile="message.msg"></div><ul class="list" ng-if="message.isList"><li ng-repeat="msg in message.msg"><span ng-bind-html="msg"></span></li></ul></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/mainContent/views/main_content.html",'<div ui-view=""></div><div align="right" class="ml10 mt20 mr15 b-app__watermark" ng-if="!$root.currentBrand.watermark_is_hidden">Разработка и поддержка <a href="http://b2bpolis.ru" target="_blank">Умный полис</a></div><messages></messages>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.shared/carFilter/views/alternative_fourth_big_step.html",'<div ng-controller="policyOrderingCtrl" ng-form="ordering_form" class="is-form"><div class="b-ordering m0 mt40"><h3 class="b-ordering-content__title">Оформление заявки на получение полиса</h3><div class="ui grid stackable"><div class="row"><div class="twelve wide column"><div class="ui grid"><div class="sixteen wide column b-ordering-content__options-toggle"><span ng-click="optionsIsOpened = !optionsIsOpened"><span>Ваши данные</span> <i class="chevron down icon" ng-class="{\'closed\' : optionsIsOpened}"></i></span></div><div class="row" ng-class="optionsIsOpened ? \'b-ordering-content__options\' : \'b-ordering-content__options--closed\'"><div class="column"><div class="b-ordering-content" style="height: 100%" ng-if="carInfo.carMark"><h3 class="b-content_title m0"><strong>Автомобиль</strong></h3><h3 class="b-content_title pl20 mt10"><p>Марка: <span ng-bind="carInfo.carMark.title"></span></p><p>Модель: <span ng-bind="carInfo.carModel.title"></span></p><p>Год выпуска: <span ng-bind="calculation.car_manufacturing_year"></span></p><p>Мощность двигателя: <span ng-bind="calculation.engine_power"></span> л.с.</p></h3><h3 class="b-content_title mt10"><strong>Водители:</strong></h3><h3 class="b-content_title pl20 mt10" ng-show="!calculation.is_multidrive"><div ng-repeat="driver in calculation.driver_set"><p>Возраст: <span ng-bind="driver.age"></span></p><p>Стаж: <span ng-bind="driver.expirience"></span></p></div></h3><h3 class="b-content_title pl20 mt10" ng-show="calculation.is_multidrive"><div><p>Минимальный возраст: <span ng-bind="calculation.drivers_minimal_age"></span></p><p>Минимальный стаж: <span ng-bind="calculation.drivers_minimal_experience"></span></p></div></h3></div></div></div><div class="row"><div class="column"><div ng-if="carFilterParams.selectedResult()" class="b-ordering-content__product"><h3 class="b-content_title mt10"><strong>Страховой продукт:</strong></h3><h3 class="b-content_title pl20 mt10" ng-init="result = carFilterParams.selectedResult()"><p ng-if="!$root.currentBrand.with_custom_program">Компания: <span ng-bind="carFilterParams.getCompanyTitle()"></span></p><p><strong>Тариф: <span ng-bind="(result.program.sum) | priceFormatter:0:\'\':false"></span>. <small ng-bind="(result.program.sum) | fractionalFormatter:2"></small>р.</strong></p><p ng-if="[\'casco\', \'kasko\'].indexOf($root.currentModuleType) != -1"><strong>Тариф (со скидкой <span ng-bind="sumOfDiscounts">10</span>%): <span ng-bind="(policy_price_with_discount) | priceFormatter:0:\'\':false"></span>. <small ng-bind="(policy_price_with_discount) | fractionalFormatter:2"></small>р.</strong></p></h3></div></div></div><div class="row"><div class="column"><div style="height: 100%" ng-if="selectedResult.PUS_cost && selectedResult.PUS_title" class="p30"><h3 class="b-content_title mt20"><strong>Выбранная ПУС:</strong></h3><h3 class="b-content_title pl20 mt10"><p>Название: <span ng-bind="selectedResult.PUS_title"></span></p><p><strong>Стоимость: <span ng-bind="selectedResult.PUS_cost | priceFormatter:0:\'\':false"></span>р.</strong></p></h3></div><div ng-if="selectedResult.is_from_interface" class="p30"><h3 class="b-content_title mt20"><strong>Выбранная ПУС:</strong></h3><h3 class="b-content_title pl20 mt10"><p>Название: <span>Backspace Pro</span></p><p><strong>Стоимость: <span ng-bind="selectedResult.program.sum * 0.83 | priceFormatter"></span>р.</strong></p></h3></div></div></div></div></div></div></div><div class="ui divider"></div><div class="ui grid stackable"><div class="row"><div class="twelve wide column"><div class="column"><div class="p30"><h3 class="b-content_title m0 mb20"><strong>Введите данные для оформления заказа:</strong></h3><form name="ordering_form"><div class="ui form"><div class="ui grid stackable two column"><div class="row"><div class="column"><div class="field"><label>Ваше имя:</label> <input type="text" ng-disabled="params.disableFormFields" ng-model="formFields.client_name" ng-change="$root.clientDataForMail.name = formFields.client_name" required=""></div></div><div class="column"><div class="field"><label>Номер телефона:</label> <input type="text" ui-mask="+7 (999) 999-9999" required="" ng-disabled="params.disableFormFields" ng-change="$root.clientDataForMail.phone = formFields.client_phone" placeholder="+7 (___) ___-____" model-view-value="true" ng-model="formFields.client_phone"></div></div></div><div class="row" ng-if="$root.currentBrand.with_agreement_on_ordering"><div class="sixteen wide column"><sem-checkbox class="mt5" ng-model="formFields.client_is_agree"></sem-checkbox><h3 class="m0 b-app__agreement-on-sms" ng-click="formFields.client_is_agree = !formFields.client_is_agree;"><strong>Я даю согласие на обработку персональных данных</strong><br><small>Обработка персональных данных осуществляется согласно ФЗ РФ №152-ФЗ</small></h3></div></div><div class="row" ng-if="$root.currentBrand.with_payment_type"><div class="column"><div class="field"><label>Способ оплаты:</label><div class="ui search selection dropdown" id="id_owner_registration" sem-dropdown="" ng-class="{disabled: params.disableFormFields}" ng-model="formFields.payment_type" sem-dropdown-simple="true" sem-dropdown-items="paymentType"></div></div></div></div><div class="row one column" ng-if="!$root.currentBrand.without_delivery"><div class="column"><div class="mt10"><sem-checkbox ng-model="formFields.receipt_type" sem-label="{{params.deliveryTypeTitle}}" sem-type="radio" class="mr25" ng-disabled="params.disableFormFields" name="receipt_type" value="delivery"></sem-checkbox><sem-checkbox ng-model="formFields.receipt_type" sem-label="{{params.deliveryInOfficeTitle}}" ng-disabled="params.disableFormFields" sem-type="radio" name="receipt_type" value="office"></sem-checkbox></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'delivery\' && !$root.currentBrand.without_delivery"><div class="row one column pt0"><div class="column"><div class="field"><label for="id_delivery_address">Адрес доставки:</label> <input type="text" class="ui input" required="" ng-disabled="params.disableFormFields" id="id_delivery_address" ng-model="formFields.delivery_address"></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'office\' && !$root.currentBrand.without_delivery"><div class="row two column doubling pt0"><div class="column"><div class="field" ng-class="{error: formFields.arrival_date && ordering_form.arrival_date.$invalid}"><label for="id_arrival_date">Дата оформления:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="true" ng-disabled="params.disableFormFields" name="arrival_date" placeholder="__.__.____" id="id_arrival_date" required="" ng-model="formFields.arrival_date"> <i class="icon calendar circular branded inverted"></i></div><div class="ui right pointing label" ng-show="formFields.arrival_date && ordering_form.arrival_date.$invalid" style="width: 170px; position: absolute;top: 23px;right: 96%;">Застраховаться можно только с завтрашнего дня</div></div></div><div class="column" ng-if="!$root.currentBrand.arrival_time_is_hidden"><div class="field"><label for="id_arrival_time">Время оформления:</label> <input type="text" required="" ng-disabled="params.disableFormFields" ng-model="formFields.arrival_time" ui-mask="99:99" ng-pattern="/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/" placeholder="__:__" id="id_arrival_time"></div></div></div></div></div></form></div></div></div><div class="four wide column bottom aligned b-ordering__confirm-btn"><button type="button" ya-metrika="m-order" ng-click="sendPolicyOrdering(selectedResult.is_from_interface)" ng-disabled="$root.orderSending || ordering_form.$invalid || !formFields.client_is_agree || policyOrderingInProgress || params.disableFormFields" ng-class="[policyOrderingInProgress ? \'loading\' : \'\', ($root.currentBrand.order_the_policy_button || $root.currentBrand.main_buttons_color)]" class="ui button teal big">Отправить заявку</button></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_group_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModelGroups || !carModelGroups.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="ui five column doubling grid"><div class="row"><div class="column ui list" ng-repeat="column in carModelGroups | carFilterYears:carManufacturingYear | orderBy:\'rank\':reverse | orderBy:orderBy | multiColumn:{columns: 5}"><div ng-repeat="carModelGroup in column" class="item css-car-item" tabindex="0" ya-metrika="m-group-of-the-car" ng-click="selectCarModelGroup(carModelGroup)" ng-keypress="$event.keyCode == 13 && selectCarModelGroup(carModelGroup)" title="{{carModelGroup.title}}"><span ng-bind="carModelGroup.title"></span></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_manufacturing_years.html",'<div class="ui labels"><button class="ui large label basic" type="button" ng-repeat="year in monYears | limitTo: 8" tabindex="0" ya-metrika="m-year-of-the-car" ng-class="[ year == calculation.car_manufacturing_year ? \'blue\' : \'\', $root.currentBrand.year_of_the_car_color ]" ng-click="selectMonYear($index)"><span ng-bind="year"></span></button><div style="display: inline-block;" class="nowrap"><label class="ml10" style="display: inline-block;">Другой:&nbsp;</label><div style="display: inline-block;"><div class="ui form"><div class="field" style="width: 90px;"><div sem-dropdown-items="monYears" class="ui compact selection dropdown" ya-metrika="m-year-of-the-car" sem-dropdown="" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" ng-change="carFilterParams.was_clicked && selectMonYear()" sem-dropdown-placeholder="2016" ng-class="$root.currentBrand.year_of_the_car_color" sem-dropdown-simple="true" ng-model="calculation.car_manufacturing_year"></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_marks_list.html",'<div class="c-tac b-content-loading" ng-if="!carMarks || !carMarks.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="ui doubling grid" ng-class="{\'six column\': columnsCount == 6, \'five column\': columnsCount == 5}"><div class="row"><div class="column ui list" ng-repeat="column in carMarks | filter:$parent.carSearch | limitTo:carMarksLimit | orderBy:[\'priority\', orderBy] | multiColumn:{columns: columnsCount}"><div ng-repeat="carMark in column" class="item css-car-item" title="{{carMark.title}}" tabindex="0" ya-metrika="m-mark-of-the-car" ng-class="[\'css-car-item--\' + carMark.popularity, carMarkSelected === carMark && \'css-item-selected\' || \'\']" ng-keypress="$event.keyCode == 13 && selectCarMark(carMark)" ng-click="selectCarMark(carMark)"><div ng-if="withMarkLogo" class="car_mark__logo car_mark__logo__{{carMark.title}}"></div><span ng-if="!withMarkLogo" ng-bind="::carMark.title"></span></div></div></div></div><div style="position: relative;z-index: 2;" class="c-tar"><a href="" class="car_filter-car_marks-all_marks_link p20" ng-click="toggleAllMarks()"><span ng-if="carMarksLimit === limit">Все марки</span> <span ng-if="carMarksLimit !== limit">Закрыть</span></a></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModels || !carModels.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="ui five column doubling grid"><div class="row"><div class="column ui list" ng-repeat="column in carModels | orderBy:\'rank\':reverse | orderBy:orderBy | multiColumn:{columns: 5}"><div ng-repeat="carModel in column" class="item css-car-item" tabindex="0" ya-metrika="m-model-of-the-car" ng-keypress="$event.keyCode == 13 && selectCarModel(carModel, true)" ng-click="selectCarModel(carModel, true)" ng-class="{ \'css-item-selected\': selectedModelId === carModel.id }" title="{{carModel.title}}"><span ng-bind="carModel.title"></span></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.html",'<div class="ui form b-calc-step pos-rel" ng-class="[\'b-calc-step--\' + getActiveStep().name, \'b-calc-step-second--\' + getActiveStepSecond().name]"><div ng-if="$root.currentBrand.without_steps_history || $root.currentBrand.old_module" move-to-step="arrow" move-to-step-type="text" ng-show="getActiveStep().name !== carFilterParams.brandSteps.first[0]"></div><div ng-repeat="template in carFilterTemplates" ng-if="bigSteps.getBigStep().name === template.name" ng-include="template.templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/fourth_big_step.html",'<div ng-controller="policyOrderingCtrl" ng-form="ordering_form" class="is-form"><div class="b-ordering m0 mt20"><div class="ui grid stackable"><div class="row"><div class="eleven wide column"><div class="b-ordering-block b-full-width-bg b-full-width-bg--green p30" style="height: 100%" ng-if="carInfo.carMark"><h3 class="b-content_title m0">Автомобиль</h3><h3 class="b-content_title p20 mt10"><strong><span ng-bind="carInfo.carMark.title"></span> <span ng-bind="carInfo.carModelGroup.title"></span> <span ng-bind="carInfo.carModel.title"></span> — <span ng-bind="calculation.car_manufacturing_year"></span> г. выпуска, <span ng-bind="calculation.engine_power"></span> л.с.</strong></h3><h3 class="b-content_title mt30">Водители:</h3><h3 class="b-content_title p20 mt10" ng-show="!calculation.is_multidrive"><div ng-repeat="driver in calculation.driver_set"><strong>Возраст - <span ng-bind="driver.age"></span>, стаж - <span ng-bind="driver.expirience"></span></strong></div></h3><h3 class="b-content_title p20 mt10" ng-show="calculation.is_multidrive"><div><strong>Минимальный возраст - <span ng-bind="calculation.drivers_minimal_age"></span>, минимальный стаж - <span ng-bind="calculation.drivers_minimal_experience"></span></strong></div></h3><div class="c-tac mt15"><a href="" ng-click="bigSteps.setBigStep(\'first\')">Изменить</a></div><div class="b-ordering-block_icon"><i class="icon info"></i></div></div></div><div class="five wide column"><div class="b-full-width-bg b-ordering-block b-full-width-bg--red" style="height: 100%" ng-if="carFilterParams.selectedResult()"><h3 class="b-content_title m0">Выбранный страховой продукт:</h3><h3 class="b-content_title c-tar m0 mt10"><div class="b-ordering_ins-company" ng-if="!currentBrand.with_custom_program"><strong ng-bind="carFilterParams.getCompanyTitle()"></strong></div><div class="mt5 b-ordering_price" ng-init="result = carFilterParams.selectedResult()"><strong><span ng-bind="(result.programSum || result.sumWithKBM || carFilterParams.selectedResult().program.sum) | priceFormatter:0:\'\':false"></span>.<small ng-bind="(result.programSum || result.sumWithKBM || carFilterParams.selectedResult().program.sum) | fractionalFormatter:2"></small> р.</strong></div></h3><div class="b-ordering-block_icon"><i class="icon calculator"></i></div></div></div></div><div class="row"><div class="eleven wide column"><div class="b-full-width-bg b-ordering-block b-ordering-block--form"><h3 class="b-content_title m0 mb20">Введите данные для оформления заказа:</h3><form name="ordering_form" class="is-form"><div class="ui form"><div class="ui grid stackable two column"><div class="row"><div class="column" ng-init="formFields.client_name = $root.clientDataForMail.name"><div class="field"><label>Ваше имя:</label> <input type="text" ng-disabled="params.disableFormFields" ng-model="formFields.client_name" ng-change="$root.clientDataForMail.name = formFields.client_name" required=""></div></div><div class="column" ng-init="formFields.client_phone = $root.clientDataForMail.phone"><div class="field"><label>Ваш телефон:</label> <input type="text" ui-mask="+7 (999) 999-9999" required="" model-view-value="true" ng-disabled="params.disableFormFields" ng-change="$root.clientDataForMail.phone = formFields.client_phone" placeholder="+7 (___) ___-____" ng-model="formFields.client_phone"></div></div></div><div class="row" ng-if="$root.currentBrand.with_agreement_on_ordering"><div class="sixteen wide column"><sem-checkbox class="mt5" ng-model="formFields.client_is_agree"></sem-checkbox><h3 class="m0 b-app__agreement-on-sms" ng-click="formFields.client_is_agree = !formFields.client_is_agree;"><strong>Я даю согласие на обработку персональных данных</strong><br><small>Обработка персональных данных осуществляется согласно ФЗ РФ №152-ФЗ</small></h3></div></div><div class="row" ng-if="$root.currentBrand.with_payment_type"><div class="column"><div class="field"><label>Способ оплаты:</label><div class="ui search selection dropdown" id="id_owner_registration" sem-dropdown="" ng-class="{disabled: params.disableFormFields}" ng-model="formFields.payment_type" sem-dropdown-simple="true" sem-dropdown-items="paymentType"></div></div></div></div><div class="row one column"><div class="column"><div class="mt10"><div class="css-dib" ng-show="!$root.currentBrand.without_delivery_on_ordering"><sem-checkbox ng-model="formFields.receipt_type" sem-label="{{params.deliveryTypeTitle}}" sem-type="radio" class="mr25" ng-disabled="params.disableFormFields" name="receipt_type" value="delivery"></sem-checkbox></div><sem-checkbox ng-model="formFields.receipt_type" sem-label="{{params.deliveryInOfficeTitle}}" ng-disabled="params.disableFormFields" sem-type="radio" name="receipt_type" value="office"></sem-checkbox></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'delivery\'"><div class="row one column pt0"><div class="column"><div class="field"><label for="id_delivery_address">Адрес доставки:</label> <input type="text" class="ui input" required="" ng-disabled="params.disableFormFields" id="id_delivery_address" ng-model="formFields.delivery_address"></div></div></div><div class="row two column pt0"><div class="column"><div class="field" ng-class="{error: formFields.delivery_date && ordering_form.delivery_date.$invalid}"><label for="id_delivery_date">Дата доставки:</label><div class="ui icon input"><input type="text" jdatepicker="" ng-disabled="params.disableFormFields" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="=true" name="delivery_date" placeholder="__.__.____" id="id_delivery_date" required="" ng-model="formFields.delivery_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field"><label for="id_delivery_time" ng-bind="params.deliveryTimeTitle"></label> <input type="text" class="ui input" required="" ui-mask="99:99" ng-disabled="params.disableFormFields" ng-pattern="/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/" placeholder="__:__" ng-model="formFields.delivery_time" id="id_delivery_time"></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'office\'"><div class="row two column pt0"><div class="column"><div class="field" ng-class="{error: formFields.arrival_date && ordering_form.arrival_date.$invalid}"><label for="id_arrival_date">Дата оформления:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="true" ng-disabled="params.disableFormFields" name="arrival_date" placeholder="__.__.____" id="id_arrival_date" required="" ng-model="formFields.arrival_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column" ng-if="!$root.currentBrand.arrival_time_is_hidden"><div class="field"><label for="id_arrival_time">Время оформления:</label> <input type="text" required="" ng-disabled="params.disableFormFields" ng-model="formFields.arrival_time" ui-mask="99:99" ng-pattern="/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/" placeholder="__:__" id="id_arrival_time"></div></div></div></div></div></form><div class="b-ordering-block_icon"><i class="icon write"></i></div></div></div><div class="five wide column"><div class="b-ordering-block_submit b-full-width-bg b-ordering-block b-full-width-bg--grey"><button type="button" ng-init="block = false" ya-metrika="m-order" ng-click="sendPolicyOrdering(); block = true" ng-disabled="block || ordering_form.$invalid || !formFields.client_is_agree || policyOrderingInProgress || params.disableFormFields" ng-class="[policyOrderingInProgress ? \'loading\' : \'\', ($root.currentBrand.order_the_policy_button || $root.currentBrand.main_buttons_color)]" class="ui button">Заказать полис</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/policy.info.html",'<div class="mt30 b-cards-info" ng-if="getSelectedResult().id"><div class="ui grid stackable"><div class="row"><div class="column"><div class="ui card" style="width: 100%"><div class="content"><div class="ui stackable grid"><div class="row two column"><div class="column"><h3 class="header" ng-bind="root.selectedResult.insurance_company.title"></h3></div><div class="column"><h3 class="header">+ бесплатный БРОКЕС АССИСТАНС <span class="colour-red">*</span></h3></div></div></div></div><div class="content"><div class="ui stackable grid"><div class="row two column"><div class="column"><div ng-repeat="option in root.selectedResult.program.option_set"><h4 class="header mb5" ng-bind="option.title" style="font-weight: bold"></h4><p class="mb10" ng-bind="option.note"></p></div></div><div class="column"><h4 class="header mb5" style="font-weight: bold;">Сбор справок</h4><p class="mb10">Выезд эксперта "БРОКЕРС" в страховую компанию для составления заявления о страховом случае</p><h4 class="header mb5" style="font-weight: bold;">Аварийный комиссар</h4><p class="mb10">Помощь в оформлении европротокола</p><h4 class="header mb5" style="font-weight: bold;">Консультация</h4><p class="mb10">Горячая линия 24/7</p><h4 class="header mb5" style="font-weight: bold;">Эвакуация</h4><p class="mb10">1 раз в год</p><h4 class="header mb5" style="font-weight: bold;">Подарок</h4><p class="mb10">Да</p><h4 class="header mb5" style="font-weight: bold;">Ремонт кузова</h4><p class="mb10">Контроль выполнения восстановительного ремонта в "Автоцентре БРОКЕРС"</p><h4 class="header mb5" style="font-weight: bold;">Автомобиль в аренду</h4><p class="mb10">Нет</p><h4 class="header mb5" style="font-weight: bold;">Требования к ПУС</h4><p class="mb10">Нет</p><h4 class="header mb5" style="font-weight: bold;">Ремонт стекол</h4><p class="mb10">Контроль выполнения восстановительного ремонта в "Автоцентре БРОКЕРС"</p><h4 class="header mb5 colour-red" style="font-weight: bold;"><span class="colour-red">*</span> Возможность расширения до:</h4><p class="mb10 colour-red">Геолокация и вызов экстренных служб, Досудебное урегулирование по ДТП, Зарядка аккумулятора, Подвоз бензина, Услуга "Трезвый водитель", Выездной шиномонтаж</p></div></div></div></div><div class="extra content" ng-hide="root.selectedResult.show_info_on_last_step"><button class="ui button green small" title="Перейти к заказу" ng-click="bigSteps.setBigStep(\'fourth\');" type="button">Заказать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/program_list.manager.html",'<div class="b-post-calculate" ng-show="postCalculateParams.is_visible"><div align="center"><div class="b-post-calculate_pre" ng-show="!postCalculateParams.second && !postCalculateParams.third"><div ng-show="!postCalculateParams.first"><div class="b-post-calculate_pre-title"><i class="icon info circle"></i> КАСКО можно сделать дешевле! Попробуем?</div><div class="b-post-calculate_pre-actions mt20"><button class="ui button green small" ng-click="postCalculateParams.first = true;" type="button">Да, конечно</button> <button class="ui button orange small ml10" ng-click="postCalculateParams.is_visible = false;" type="button">Нет, спасибо</button></div></div><div ng-show="postCalculateParams.first"><div class="b-post-calculate_pre-title"><i class="icon info circle"></i> Самостоятельно на сайте или с помощью менеджера?</div><div class="b-post-calculate_pre-actions mt20"><button class="ui button green small" ya-metrika="m-agree-to-make-cheaper" ng-click="postCalculateParams.second = true;" type="button">Я сам</button> <button class="ui button olive small ml10" ng-click="toManager()" type="button">Пусть позвонит менеджер</button></div></div></div></div><div class="b-post-calculate_manager" ng-show="postCalculateParams.third"><div class="ui form"><div class="ui grid two column stackable"><div class="row"><div class="column"><div class="field"><label for="id_manager__client_name">Как к вам обращаться?</label> <input type="text" id="id_manager__client_name" ng-model="postCalculateParams.manager__client_name"></div></div><div class="column"><div class="field"><label for="id_manager__client_phone">Номер телефона:</label> <input type="text" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" ng-model="postCalculateParams.manager__client_phone" id="id_manager__client_phone"></div></div></div><div class="row"><div class="column"></div><div class="column"><button class="ui button green fluid" ng-click="sendToManager()" ng-disabled="!postCalculateParams.manager__client_name || !postCalculateParams.manager__client_phone || postCalculateParams.button_is_disabled" type="button">Отправить заявку на звонок</button></div></div></div></div></div><div class="b-post-calculate_fields css-bigger-labels" ng-show="postCalculateParams.second"><div class="ui form"><div class="ui grid two column stackable doubling"><div class="row"><div class="column"><div class="field"><label for="id_deductible_value">Франшиза:</label> <input type="text" id="id_deductible_value" class="input-has-slider" name="deductible_value" ng-model="params.deductible_value"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="50000" ng-model="params.deductible_value"></div></div></div><div class="column" align="center"><p class="pt10"><i class="icon help circle grey"></i>Франшиза — это та часть ущерба, которую вы возмещаете за свой счет, если наступил страховой случай.</p></div></div><div class="row"><div class="sixteen wide column"><div class="field pt10"><label>Рассрочка оплаты на год:</label><div class="ui buttons mt5 w100p" style="border: none;"><button class="ui teal button" ng-repeat="item in params.contributoryScheme" type="button" ya-metrika="m-with-installments" ng-class="{basic: item.id !== params.contributory_scheme}" ng-click="params.contributory_scheme = item.id"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row" ng-hide="$root.currentBrand.payment_form_is_hidden"><div class="sixteen wide column"><div class="field"><label>Ремонт:</label><div class="four ui buttons mt5" style="border: none;"><button class="ui teal button" ng-repeat="item in paymentForm" type="button" ng-class="{basic: item.id !== params.payment_form}" ng-click="params.payment_form = item.id"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row"><div class="sixteen wide column"><div class="mt15" align="right"><button class="ui button green m0" style="width: 50%;" ya-metrika="m-refresh-rates" ng-disabled="params.recalculateButtonIsDisabled" ng-click="calculateKasko()" ng-class="{loading: params.recalculateButtonIsDisabled}" type="button">Обновить тарифы</button></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/second_big_step.html",'<div><div class="ui large labels" ng-class="$root.currentBrand.steps_buttons_color"><div class="ui label basic mb10" ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).getLabelTitle()"><span ng-bind="getCurrentStepObject(item).getLabelTitle()"></span> <i class="icon delete" ng-click="setActiveStep(getCurrentStepObject(item).name)" ng-keydown="$event.keyCode == 13 && setActiveStep(getCurrentStepObject(item).name)" tabindex="0"></i></div></div><div class="p20" ng-show="getActiveStepSecond().name !== carFilterParams.brandSteps.second[0]"><div class="ui divider" style="border-top-style: dashed;"></div></div><div ng-repeat="item in carFilterParams.brandSteps.second" class="c-hidden" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.shared/carFilter/views/sms_step_osago.html",'<div class="ui grid three column doubling stackable css-bigger-labels"><div class="row one column"><div class="column"><h4>Для подтверждения что вы не робот, пройдите, пожалуйста, бесплатную sms-верификацию.</h4></div></div><div class="row"><div class="column"><div class="field"><label for="id_client_name">Как к вам обращаться?</label> <input type="text" ng-disabled="calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible" ng-model="calculationInterParams.client_name" placeholder="Имя" id="id_client_name"></div></div><div class="column"><div class="field"><label for="id_client_phone">Номер телефона:</label> <input type="text" ui-mask="+7 (999) 999-9999" ng-disabled="calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible" placeholder="+7 (___) ___-____" model-view-value="true" ng-keypress="$event.keyCode == 13 && !(!calculationInterParams.client_phone || !calculationInterParams.client_name || calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible) && showSMSformOsago()" ng-model="calculationInterParams.client_phone" id="id_client_phone"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button fluid" ya-metrika="m-send-sms-code" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="!calculationInterParams.client_phone || !calculationInterParams.client_name || calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible" ng-click="showSMSformOsago(); calculationInterParams.sms_is_visible = true" type="button">Отправить</button></div></div></div><div class="row" ng-if="calculationInterParams.sms_is_visible"><div class="column"><a href="" class="css-bottom-dashed pt30" style="font-size: 15px;" ng-click="calculationInterParams.sms_is_visible = false;">Изменить номер телефона</a></div><div class="column"><div class="field" ng-class="{error: !calculationInterParams.sms_code}"><label for="id_sms_code">Код из СМС:</label> <input type="text" ng-model="calculationInterParams.sms_code" placeholder="1234" maxlength="4" autofocus="autofocus" input-integer="" id="id_sms_code"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button green fluid" ng-disabled="!calculationInterParams.sms_code || calculationInterParams.sms_button_is_disabled" ng-click="confirmCode()" ya-metrika="m-confirm-code" type="button">Подтвердить</button></div></div></div><div class="row" ng-show="clientParams.send_sms_text"><div class="sixteen wide column"><div class="ui message blue visible tac" style="text-align: center;">Вам на телефон отправлена sms, введите код из смс в поле для получения расчетов.</div></div></div><div class="row" ng-show="calculatorParams.confirm_code_is_incorrect"><div class="sixteen wide column"><div class="ui message error visible">Код СМС не совпал с отправленным.</div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/preCalculator/views/pre_calculator.other.html","")}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/preCalculator/views/pre_calculator.rolf.html",'<div class="b-full-width-bg mt10 p20 pt20"><div class="ui grid stackable"><div class="two wide column"></div><div class="six wide column"><button type="button" ng-if="!preCalculatorParams.is_second_step" ng-click="preCalculatorParams.is_second_step = true;" class="ui button fluid big branded" style="height: 100%;">КАСКО на новый автомобиль</button></div><div class="six wide column"><a ui-sref="index.calculator.kasko" ng-if="!preCalculatorParams.is_second_step" type="button" class="ui button fluid big blue">КАСКО на авто с пробегом для новых клиентов</a></div><div class="two wide column"></div></div><div ng-if="preCalculatorParams.is_second_step"><div class="ui grid stackable"><div class="row"><div class="column wide"><h2 class="b-content_title m0 mb30">Укажите нужный вариант</h2><div class="mt15"><sem-checkbox ng-model="preCalculatorParams.selectedType" sem-label="{{ typesToSelect.first.title }}" sem-type="radio" class="" name="selected_type" value="first"></sem-checkbox></div><div class="mt15"><sem-checkbox ng-model="preCalculatorParams.selectedType" sem-label="{{ typesToSelect.second.title }}" sem-type="radio" class="" name="selected_type" value="second"></sem-checkbox></div><button type="button" ng-disabled="!preCalculatorParams.selectedType" ng-click="preCalculatorParams.toNextStep()" ng-class="$root.currentBrand.main_buttons_color" class="ui button right floated">Далее</button></div></div></div></div></div><style>\n    .ui.button {\n        font-weight: 400;\n    }\n</style>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/postCalculator/views/post_calculator.rolf-previous.html",'<div class="b-full-width-bg mt30 p20 pt20 pb20"><h3>Для того, чтобы получить максимально выгодное предложение свяжитесь с нами по телефону 8&nbsp;495&nbsp;788&#045;99&#045;77 или напишите нам.</h3><div class="ui form"><div class="ui grid two column stackable"><div class="row three column"><div class="column"><div class="field"><label for="id_manager__client_name">Имя</label> <input type="text" id="id_manager__client_name" ng-disabled="postCalculatorParams.is_visible" ng-model="postCalculatorParams.client_name"></div></div><div class="column"><div class="field"><label for="id_manager__client_phone">Телефон</label> <input type="text" ng-disabled="postCalculatorParams.is_visible" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" ng-model="postCalculatorParams.client_phone" id="id_manager__client_phone"></div></div></div></div><div class="ui grid stackable"><div class="row"><div class="wide column"><div class="field"><label></label> <textarea rows="4" placeholder="Текст сообщения" ng-disabled="postCalculatorParams.is_visible" ng-model="postCalculatorParams.message">\n            </textarea></div></div></div><div class="row"><div class="column"><button class="ui button green" ng-click="preSendToManager()" ng-disabled="!postCalculatorParams.client_name || !postCalculatorParams.client_phone || !postCalculatorParams.message || postCalculatorParams.button_is_disabled" type="button">Отправить</button></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/postCalculator/views/post_calculator.rolf.html",'<div class="b-full-width-bg mt30 p20 pt20 pb20"><h3>Для того, чтобы получить максимально выгодное предложение свяжитесь с нами по телефону 8&nbsp;495&nbsp;788&#045;99&#045;77 или напишите нам.</h3><div class="ui form"><div class="ui grid stackable"><div class="row three column"><div class="column"><div class="field"><label for="id_manager__client_name">Имя</label> <input type="text" id="id_manager__client_name" ng-disabled="postCalculatorParams.is_visible" ng-model="postCalculatorParams.client_name"></div></div><div class="column"><div class="field"><label for="id_manager__client_phone">Телефон</label> <input type="text" ng-disabled="postCalculatorParams.is_visible" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" ng-model="postCalculatorParams.client_phone" id="id_manager__client_phone"></div></div></div></div><div class="ui grid stackable"><div class="row"><div class="column"><h3 class="b-content_title">Выберите марку:</h3><div class="ui basic four buttons"><button type="button" ng-click="setCarMark(\'Mitsubishi\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Mitsubishi\'}" class="ui button">Mitsubishi</button> <button type="button" ng-click="setCarMark(\'Ford\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Ford\'}" class="ui button">Ford</button> <button type="button" ng-click="setCarMark(\'Mazda\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Mazda\'}" class="ui button">Mazda</button> <button type="button" ng-click="setCarMark(\'Hyundai\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Hyundai\'}" class="ui button">Hyundai</button></div></div></div><div class="row"><div class="column"><button class="ui button green" ng-click="preSendToManager()" ng-disabled="!postCalculatorParams.client_name || !postCalculatorParams.client_phone || !postCalculatorParams.carMark || postCalculatorParams.button_is_disabled" type="button">Отправить</button></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/first_big_step.html",'<div><div ng-if="$root.currentBrand.old_module"><div class="ui large labels" ng-class="$root.currentBrand.steps_buttons_color"><div class="ui label basic mb10" ng-repeat="item in carFilterParams.brandSteps.first" ng-show="getCurrentStepObject(item).getLabelTitle()"><span ng-bind="getCurrentStepObject(item).getLabelTitle()"></span> <i class="icon delete" ng-click="setActiveStep(getCurrentStepObject(item).name)" ng-keydown="$event.keyCode == 13 && setActiveStep(getCurrentStepObject(item).name)" tabindex="0"></i></div></div><div class="p20" ng-show="getActiveStep().name !== carFilterParams.brandSteps.first[0]"><div class="ui divider" style="border-top-style: dashed;"></div></div></div><div ng-repeat="item in carFilterParams.brandSteps.first" ng-show="getCurrentStepObject(item).name === getActiveStep().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.calculation_type.html",'<div><h3 class="b-content_title mb30 mt30">Тип расчета ОСАГО:</h3><div class="p20 mb25" ng-show="$root.currentBrand.show_user_agreement && !carFilterParams.calculation_type"><span ya-metrika="m-processing-of-personal-data"><sem-checkbox ng-model="personalData.user_agreement" sem-label="Согласен на обработку моих персональных данных" id="personal_data" name="personal_data"></sem-checkbox></span></div><div ng-class="{\'css-disabled-links\': !personalData.user_agreement}"><h3 class="b-content_title p20 m0"><a href="" ng-repeat="item in calcTypes" ya-metrika="{{item.m_id}}" ng-click="setCalculationType(item.id)" ng-bind="item.title" ng-class="{\'css-bottom-dashed--active\': item.id == calculationInterParams.calculation_type}" class="mr25 css-bottom-dashed"></a></h3></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_cost.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_car_cost">Укажите стоимость автомобиля в руб.:</label> <input type="text" ng-model="calculationInterParams.car_cost" price-formatter="2" class="input-has-slider" required="" placeholder="0" no-empty="" id="id_car_cost"><div class="ui-slider-container"><div input-slider="" is-sum="true" default-min="100000" slider-step="5000" default-max="3000000" ng-model="calculationInterParams.car_cost"></div></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" ng-click="toNextStep(\'car_cost\')" ya-metrika="m-car-cost" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="!calculationInterParams.car_cost" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_mark.html",'<div class="calculator-caption calculator-caption-model mb15"><div class="pos-rel mb15"><b>Выберите марку:</b> <label class="b-car-search"><div class="ui icon input transparent"><input type="text" placeholder="Найти" ng-model="carSearch.title"> <i class="icon search"></i></div></label></div><div car-marks-list="" style="clear: both;" ng-model="calculation.car_mark" limit="56"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_model.html",'<div class="calculator-caption calculator-caption-model mb15"><div class="pos-rel mb15"><b>Выберите модификацию —</b> {{ allSelected.carMark.title }} <span ng-if="!allSelected.carModel.title">{{ allSelected.carModelGroup.title }}</span> <span ng-if="allSelected.carModel.title">{{ allSelected.carModel.title }}</span>:</div><div car-models-list="" style="clear: both;" ng-model="calculation.car_model" car-mark-id="modelCarMark" car-manufacturing-year="calculation.car_manufacturing_year" car-model-group-id="calculation.car_model_group"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_model_group.html",'<div class="calculator-caption calculator-caption-model mb15"><div class="pos-rel mb15"><b>Выберите модель —</b> {{allSelected.carMark.title}} <span ng-if="!allSelected.carModel.title">{{allSelected.carModelGroup.title}}</span> <span ng-if="allSelected.carModel.title">{{allSelected.carModel.title}}</span>:</div><div car-group-models-list="" style="clear: both;" ng-model="calculation.car_model_group" car-manufacturing-year="calculation.car_manufacturing_year" car-mark-id="modelCarMark"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_settings.tumen.html",'<div class="ui form is-form" ng-form="car_settings_tumen_form"><div class="ui grid"><div class="row three column bottom aligned"><div class="column"><div class="field"><label for="id_car_cost">Укажите стоимость автомобиля в руб.:</label> <input type="text" ng-model="calculationInterParams.car_cost" price-formatter="2" class="input-has-slider" required="" no-empty="" id="id_car_cost"><div class="ui-slider-container"><div input-slider="" is-sum="true" default-min="100000" slider-step="5000" default-max="3000000" ng-model="calculationInterParams.car_cost"></div></div></div></div><div class="column"><div class="field"><label for="id_mileage">Укажите пробег автомобиля в км:</label> <input type="text" ng-model="calculationInterParams.mileage" price-formatter="2" class="input-has-slider" id="id_mileage"><div class="ui-slider-container"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="200000" ng-model="calculationInterParams.mileage"></div></div></div></div><div class="column"><div class="field"><label for="id_engine_power">Выберите мощность двигателя, л.с.:</label> <input type="text" ng-class="{\'is-invalid-calc\': calculationInterParams.engine_power < 10 || calculationInterParams.engine_power > 999}" ng-model="calculationInterParams.engine_power" input-only="[0-9]{1,3}" placeholder="0" class="input-has-slider" required="" id="id_engine_power"><div class="ui-slider-container"><div input-slider="" default-min="70" slider-step="1" default-max="500" ng-model="calculationInterParams.engine_power"></div></div></div></div></div><div class="row three column"><div class="column nowrap"><div class="field"><label for="id_car_displacement">Укажите объем двигателя:</label> <input type="text" ng-model="calculationInterParams.engine_displacement" price-formatter="2" ng-min="0.1" ng-max="10" required="" id="id_car_displacement"></div></div></div><div class="row two column"><div class="column"><div class="field"><label>Укажите коробку передач:</label><div class="ui two basic buttons"><button class="ui button" ng-repeat="item in carFilterParams.transmission" ng-click="calculationInterParams.params.transmission = item.id;" ng-class="[getActiveButtonClass(item.id === calculationInterParams.params.transmission), $root.currentBrand.united_buttons_color]" type="button"><span ng-bind="item.title"></span></button></div></div></div><div class="column"><div class="field"><label>Укажите привод:</label><div class="ui basic buttons three"><button class="ui button" ng-repeat="item in carFilterParams.driveOfCar" ng-click="calculationInterParams.params.drive_of_car = item.id;" ng-class="[getActiveButtonClass(item.id === calculationInterParams.params.drive_of_car), $root.currentBrand.united_buttons_color]" type="button"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row one column"><div class="column" align="right"><button type="button" ng-click="toNextStep(\'car_settings.tumen\')" ng-disabled="!calculationInterParams.engine_power || car_settings_tumen_form.$invalid" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_type.html",'<div class="fields"><div class="five wide field nowrap"><label>Категория ТС:</label><div class="ui search selection dropdown" sem-dropdown="" ng-class="{loading: !carType.$$state.value.length}" ng-change="setActiveStep(\'car_type\')" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams._car_type" sem-dropdown-items="carType"></div></div><div class="eleven wide field c-tar" ng-if="getActiveStep().name === getCurrentStepObject(item).name"><label>&nbsp;</label> <button type="button" ng-click="carFilterParams.setCarType(calculationInterParams._car_type)" ng-disabled="!calculationInterParams._car_type" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.contributory_scheme.html",'<div class="ui grid"><div class="bottom aligned row"><div class="ten wide column"><div class="field"><label>Рассрочка оплаты на год:</label><div class="ui four basic buttons mt5" ng-class="$root.currentBrand.united_buttons_color"><button class="ui button" ng-repeat="item in calculatorParams.contributoryScheme" ng-class="{active: item.id == calculationInterParams.contributory_scheme}" type="button" ng-click="calculationInterParams.contributory_scheme = item.id"><span ng-bind="item.title"></span></button></div></div></div><div class="six wide right aligned column"><button type="button" ng-click="toNextStep(\'contributory_scheme\')" ya-metrika="m-contributory-scheme" class="ui button branded">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.deductible_value.html",'<div><h3 class="b-content_title mb20 mt30">Выберите франшизу:</h3><div class="ui grid stackable"><div class="five wide column"><div class="field"><input type="text" id="id_deductible_value" class="input-has-slider" name="deductible_value" ng-model="calculationInterParams.deductible_value"><div class="ui-slider-container"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="50000" ng-model="calculationInterParams.deductible_value"></div></div></div></div><div class="six wide column" align="left"><p class="p0"><i class="icon help circle grey"></i>Франшиза — это та часть ущерба, которую вы возмещаете за свой счет, если наступил страховой случай.</p></div></div><div class="c-tar mt20"><button type="button" ng-click="carFilterParams.toNextStepDeductibleValue()" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.drivers.html",'<div ng-form="all_drivers_form" class="css-bigger-labels css-bigger-slider is-form"><div ng-repeat="item in calculationInterParams.drivers track by $index" ng-form="driver_kasko_form"><h2 class="b-content_title mb20 mt30" ng-if="calculationInterParams.currentDriverIndex === $index"><span ng-bind="$index + 1"></span>-й водитель:</h2><h3 class="b-content_title mb20 mt30" ng-if="calculationInterParams.lastDriverIndex > $index && calculationInterParams.currentDriverIndex !== $index"><span><span ng-bind="$index + 1"></span>-й водитель: <span ng-bind="item.gender === \'M\' ? \'Муж.\' : \'Жен.\'"></span> <span ng-bind="item.age + \'/\' + item.expirience"></span> <i class="icon write ml10" ng-if="all_drivers_form.$valid && !calculationInterParams.driverIsEditing" ng-click="toEditDriver($index)"></i></span></h3><div class="ui grid three column mt20 doubling stackable" ng-if="calculationInterParams.currentDriverIndex === $index"><div class="row"><div class="column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><label for="id_driver_age_{{$index}}">Возраст:</label> <input type="text" id="id_driver_age_{{$index}}" class="input-has-slider" price-formatter="" name="age" required="" ng-model="item.age"><div class="ui-slider-container"><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="item.age"></div></div></div></div><div class="column"><div class="field" ng-class="{\'error\': item.age - item.expirience < 18}"><label for="id_driver_expirience_{{$index}}">Стаж:</label> <input type="text" id="id_driver_expirience_{{$index}}" required="" class="input-has-slider" name="expirience" price-formatter="" ng-model="item.expirience"><div class="ui-slider-container"><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="item.expirience"></div></div></div></div><div class="column"><div class="field"><label>Пол:</label><div class="ui basic two buttons"><button class="ui button" ng-click="item.gender = \'M\'" ng-class="getActiveButtonClass(item.gender === \'M\')" type="button">Мужской</button> <button class="ui button" ng-click="item.gender = \'F\'" ng-class="getActiveButtonClass(item.gender === \'F\')" type="button"><span class="h-button-expander"></span> Женский</button></div></div></div></div><div class="row mt10"><div class="column"><div class="field"><label>В браке:</label><div class="ui basic two buttons"><button class="ui button" ng-click="item.is_married = true" ng-class="getActiveButtonClass(item.is_married)" type="button">Да</button> <button class="ui button" ng-click="item.is_married = false" ng-class="getActiveButtonClass(!item.is_married)" type="button">Нет</button></div></div></div><div class="column"><div class="field"><label>Дети:</label><div class="ui basic two buttons"><button class="ui button" ng-click="item.has_children = true" ng-class="getActiveButtonClass(item.has_children)" type="button">Да</button> <button class="ui button" ng-click="item.has_children = false" ng-class="getActiveButtonClass(!item.has_children)" type="button">Нет</button></div></div></div></div><div class="row"><div class="column"></div><div class="column"></div><div class="column"><div class="field" align="right"><label>&nbsp;</label> <button class="fluid ui button" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="driver_kasko_form.$invalid || item.age > 90 || item.age < 18 || item.age - item.expirience < 18" ng-click="goNextDriver($index)" ya-metrika="m-drivers" type="button">Далее</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.drivers_count.html",'<div><h2 class="b-content_title mb20">Выберите количество водителей:</h2><div class="five ui basic buttons"><button class="ui button" ng-repeat="item in driversChanging" ng-click="changeDriversCountKasko(item)" ya-metrika="m-number-of-drivers" ng-class="$root.currentBrand.united_buttons_color" type="button"><span ng-bind="item.title"></span></button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.earlier_icompany.html",'<div><h3 class="b-content_title mb20 mt30">Ранее страховался в:</h3><div class="ui grid stackable"><div class="five wide column"><div class="field"><div class="ui search selection dropdown" id="id_exploitation_area" sem-dropdown="" sem-dropdown-placeholder="Нет" ng-change="selectEarlierCompany()" ng-model="calculationInterParams.earlier_icompany" sem-dropdown-items="carFilterParams.earlierCompany"></div></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" ya-metrika="m-earlier-insured-in-сompany" ng-click="toNextStep(\'earlier_company\')" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.engine_power.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_engine_power" ng-bind="$root.currentBrand.engine_power_simple ? \'Мощность двигателя, л.с.:\' : \'Выберите мощность двигателя, л.с.:\'"></label> <input type="text" ng-class="{\'is-invalid-calc\': calculationInterParams.engine_power < 10 || calculationInterParams.engine_power > 999}" ng-model="calculationInterParams.engine_power" input-only="[0-9]{1,3}" placeholder="0" class="input-has-slider" required="" id="id_engine_power"><div class="ui-slider-container"><div input-slider="" default-min="50" slider-step="1" default-max="500" ng-model="calculationInterParams.engine_power" ng-if="!$root.currentBrand.engine_power_simple"></div></div></div><div class="eleven wide field c-tar" ng-if="getActiveStep().name === getCurrentStepObject(item).name"><label>&nbsp;</label> <button type="button" ng-click="toNextStep(\'engine_power\')" ng-disabled="!calculationInterParams.engine_power" ya-metrika="m-engine-power" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.engine_power_ranges.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_engine_power">Выберите мощность двигателя, л.с.:</label><div class="ui search selection dropdown" id="id_engine_power" sem-dropdown="" ng-change="setActiveStep(\'engine_power_ranges\')" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.engine_power_id" sem-dropdown-items="enginePowerRanges"></div></div><div class="eleven wide field c-tar" ng-if="getActiveStep().name === getCurrentStepObject(item).name"><label>&nbsp;</label> <button type="button" ng-click="carFilterParams.setEnginePower(calculationInterParams.engine_power_id)" ng-disabled="!calculationInterParams.engine_power_id" ya-metrika="m-engine-power" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.exploitation_area.html",'<div><h3 class="b-content_title mb20 mt30" ng-bind="labels.exploitation_area"></h3><div class="ui grid stackable"><div class="twelve wide column" ng-show="!carFilterParams.ownerRegistrationViewIsFull"><h3 class="b-content_title p20 m0"><a href="" ng-repeat="item in mainRegions track by $index" ng-click="selectExploitationArea(item.id)" ya-metrika="m-car-region" ng-bind="item.title" ng-class="{\'css-bottom-dashed--active\': item.id == calculationInterParams.exploitation_area}" class="mr25 css-bottom-dashed mb10"></a> <a href="" ng-click="toggleOwnerRegistrationView()" ng-if="!$root.currentBrand.exploitation_area_all_are_hidden">другой</a></h3></div><div class="five wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull"><div class="p20 field"><div class="ui search selection dropdown" id="id_exploitation_area" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" ya-metrika="m-car-region" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.exploitation_area" ng-change="carFilterParams.was_clicked && selectExploitationArea()" sem-dropdown-items="ownerRegistration"></div></div></div><div class="seven wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull">&nbsp;</div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.has_trailer.html",'<div><h3 class="b-content_title mb20 mt30">ТС с прицепом?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button blue" ng-click="carFilterParams.setHasTrailer(false)" ng-class="{basic: carFilterParams.hasTrailerIsUndefined() || calculationInterParams.has_trailer}" type="button">Нет</button> <button class="ui button blue" ng-click="carFilterParams.setHasTrailer(true)" ng-class="{basic: carFilterParams.hasTrailerIsUndefined() || !calculationInterParams.has_trailer}" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.insurance_duration.html",'<div class="fields"><div class="five wide field nowrap"><label>Период использования ТС:</label><div class="ui search selection dropdown" sem-dropdown="" ng-class="{loading: !insuranceDuration.$$state.value.length}" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.insurance_duration" sem-dropdown-items="insuranceDuration"></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" ng-click="toNextStep(\'insurance_duration\')" ng-disabled="!calculationInterParams.insurance_duration" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_credit.html",'<div><h3 class="b-content_title mb20 mt30">Куплен в кредит?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui basic buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button" ng-click="carFilterParams.setIsCredit(false)" ya-metrika="m-bought-on-credit" type="button">Нет</button> <button class="ui button" ng-click="carFilterParams.setIsCredit(true)" ya-metrika="m-bought-on-credit" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_credit_bank.html",'<div><h3 class="b-content_title mb20 mt30">Куплен в кредит?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui basic buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button" ng-click="carFilterParams.setIsCreditBank(false)" ya-metrika="m-bought-on-credit" type="button">Нет</button> <button class="ui button" ng-click="carFilterParams.setIsCreditBank(true)" ya-metrika="m-bought-on-credit" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div><div class="ui grid three column doubling stackable" ng-if="calculationInterParams.is_credit || calculationInterParams.credit_bank"><div class="three column"><h3 class="b-content_title mb10 mt10">Выберите банк:</h3><div class="ui search selection dropdown w100p" ng-change="carFilterParams.setIsCreditBank()" sem-dropdown="" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.credit_bank" sem-dropdown-items="creditBank"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){
e.put("/js/modules.shared/calculatorSteps/views/step.is_earlier_insurance.html",'<div><h3 class="b-content_title mb20 mt30">Ранее страховался?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui basic buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button" ng-click="carFilterParams.setIsEarlierInsurance(false)" type="button">Нет</button> <button class="ui button" ng-click="carFilterParams.setIsEarlierInsurance(true)" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_multidrive.html",'<div class="ui grid three column mt20 doubling stackable" ng-form="multidrive_form"><div class="row"><div class="column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><label for="id_drivers_minimal_age">Минимальный возраст:</label> <input type="text" id="id_drivers_minimal_age" class="input-has-slider" price-formatter="" name="drivers_minimal_age" required="" ng-model="calculationInterParams.drivers_minimal_age"><div class="ui-slider-container"><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="calculationInterParams.drivers_minimal_age"></div></div></div></div><div class="column"><div class="field" ng-class="{\'error\': calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18}"><label for="id_drivers_minimal_experience">Минимальный стаж:</label> <input type="text" id="id_drivers_minimal_experience" required="" class="input-has-slider" name="drivers_minimal_experience" price-formatter="" ng-model="calculationInterParams.drivers_minimal_experience"><div class="ui-slider-container"><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="calculationInterParams.drivers_minimal_experience"></div></div></div></div></div><div class="row"><div class="column"></div><div class="column"></div><div class="column"><div class="field" align="right"><label>&nbsp;</label> <button class="fluid ui button" ng-disabled="multidrive_form.$invalid || calculationInterParams.drivers_minimal_age > 90 || calculationInterParams.drivers_minimal_age < 18 || calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18" ng-click="toNextStep(\'is_multidrive\')" ya-metrika="m-multidrive" ng-class="$root.currentBrand.main_buttons_color" type="button">Далее</button></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_new_car.html",'<div><h3 class="b-content_title mb20 mt30">Новое ТС?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui basic buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button" ng-click="carFilterParams.setIsNewCar(false)" ya-metrika="m-bought-on-credit" type="button">Нет</button> <button class="ui button" ng-click="carFilterParams.setIsNewCar(true)" ya-metrika="m-bought-on-credit" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.mileage.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_mileage">Укажите пробег автомобиля в км:</label> <input type="text" ng-model="calculationInterParams.mileage" price-formatter="2" class="input-has-slider" id="id_mileage"><div class="ui-slider-container"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="200000" ng-model="calculationInterParams.mileage"></div></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" ya-metrika="m-mileage" ng-click="toNextStep(\'mileage\')" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.owner_registration.html",'<div><h3 class="b-content_title mb20 mt30" ng-bind="labels.owner_registration"></h3><div class="ui grid stackable"><div class="twelve wide column" ng-show="!carFilterParams.ownerRegistrationViewIsFull"><h3 class="b-content_title p20 m0"><a href="" ng-repeat="item in mainOwnerRegistrations" ng-click="selectOwnerRegistration(item.id)" ng-model="calculationInterParams.owner_registration" ng-bind="item.title" ya-metrika="m-owner-registration" ng-class="{\'css-bottom-dashed--active\': item.id == calculationInterParams.owner_registration.id}" class="mr25 css-bottom-dashed mb10"></a> <a ng-click="toggleOwnerRegistrationView()" ng-if="!$root.currentBrand.owner_registration_all_are_hidden">другой</a></h3></div><div class="five wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull"><div class="p20 field"><div class="ui search selection dropdown" id="id_owner_registration" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" ya-metrika="m-owner-registration" sem-dropdown-placeholder="Не выбран" ng-model="carFilterParams._owner_registration" ng-change="carFilterParams.was_clicked && selectOwnerRegistration(carFilterParams._owner_registration)" sem-dropdown-items="ownerRegistration"></div></div></div><div class="seven wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull">&nbsp;</div></div><div class="mt40 b-smallstep-signature"><span ng-bind="params.ownerRegistrationSignature"></span></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.policy_settings.tumen.html",'<div class="ui form is-form" ng-form="policy_settings_tumen_form"><div class="ui grid"><div class="row two column bottom aligned"><div class="column"><div class="field"><label>Оплата:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in calculatorParams.contributoryScheme" ng-click="calculationInterParams.contributory_scheme = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.contributory_scheme), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div><div class="column"><div class="field"><label>Автомобиль на гарантии:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in carFilterParams.yesNo" ng-click="calculationInterParams.is_under_warranty = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.is_under_warranty), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row two column bottom aligned"><div class="column"><div class="field"><label>Новое ТС:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in carFilterParams.yesNo" ng-click="calculationInterParams.is_new_car = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.is_new_car), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div><div class="column"><div class="field"><label>Выбор СТОА:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in $root.currentBrand.payment_forms" ng-click="calculationInterParams.payment_form = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.payment_form), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div></div></div><div class="row one column"><div class="column" align="right"><button type="button" ng-click="toNextStep(\'policy_settings.tumen\')" ng-disabled="policy_settings_tumen_form.$invalid" ng-class="$root.currentBrand.main_buttons_color" class="ui button mt20">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.year.html",'<div><div class="mb10"><strong>Год выпуска автомобиля:</strong></div><car-manufacturing-years></car-manufacturing-years></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/brands/broker-kapital/src/modules.osago/AddingDocuments/views/adding_documents.uploader.html",'<div class="p20 mt10"><div ng-class="{\'b-disabled-block\': isNotUpload}"><div class="ui grid stackable"><div class="row"><div class="six wide column"><ul class="uploader-queue" nv-file-drop="" nv-file-over="" uploader="uploader" over-class="uploader-queue_over"><li ng-if="!uploader.queue.length">Для оформления полиса нужно загрузить файлы.</li><li ng-repeat="item in uploader.queue" class="list-item animation-fade"><div ng-if="item._file.type.indexOf(\'image/\') !== -1"><div ng-thumb="{ file: item._file, height: 70 }"></div></div><div ng-if="item._file.type === \'application/pdf\'"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}pdf.png" alt="{{item.description}}" height="70"></a></div><div ng-if="item._file.type === \'application/msword\' || isDocument(item._file.type)"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}doc_icon.png" alt="{{item.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="item.remove()" class="button button-wrong">Удалить</button></div></li></ul><div class="control-row mt15"><input type="file" nv-file-select="" class="ui button" name="file" style="width: 100% !important;" uploader="uploader" multiple=""><h4>Выбрано: {{uploader.queue.length}}</h4></div></div><div class="ten wide column"><h2 class="b-content_title m0">Подтверждаю загрузку минимального пакета документов</h2><div class="b-full-width-bg" style="padding: 15px 0;margin-left: -15px;"><div class="p20">Для заполнения полиса добавьте сканы или фотографии ваших документов. Мы внесем эти данные и проверим их самостоятельно.</div></div><div class="b-uploader_confirmation-list"><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_1" sem-label="Копия паспорта Страхователя (Разворот паспорта с листом с пропиской)" required="required" id="id_is_1" name="is_1"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_2" sem-label="Копия паспорта Собственника (Разворот паспорта с листом с пропиской)" required="required" id="id_is_2" name="is_2"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_4" sem-label="Копия ПТС или свидетельство о регистрации (с двух сторон)" required="required" id="id_is_4" name="is_4"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_7" sem-label="Копия вод. удостоверений с обеих сторон всех водителей" required="required" id="id_is_7" name="is_7"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_8" sem-label="Копия диагностической карты с обеих сторон (если есть действующая)" id="id_is_8" name="is_8"></sem-checkbox></div></div></div></div></div></div><div class="mt20 c-tar"><button class="ui button" ng-click="bigSteps.setBigStep(\'fourth\')" ng-bind="labels.save_data" ya-metrika="m-save-docs-files" ng-class="[ isSaveDataProgress && \'loading\' || \'\', (f_policy_step_3_form.$invalid || !uploader.queue.length) && \'disabled\', ($root.currentBrand.save_the_data_button || $root.currentBrand.main_buttons_color)]"></button></div><div class="mt40" ng-if="errors.length"><div class="ui error message"><ul class="list"><li ng-repeat="error in errors" ng-if="errors.length > 0"><span ng-bind="error"></span></li></ul><i class="close icon" ng-click="errors.length = 0;"></i></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/brands/broker-kapital/src/modules.osago/carFilter/views/fourth_big_step.html",'<div ng-controller="policyOrderingCtrl" ng-form="ordering_form" class="is-form"><div class="b-ordering m0"><div class="ui grid stackable"><div class="row"><div class="eleven wide column"><div class="b-ordering-block b-full-width-bg b-full-width-bg--green p30" style="height: 100%" ng-if="carInfo.carMark"><h3 class="b-content_title m0">Автомобиль</h3><h3 class="b-content_title p20 mt10"><strong><span ng-bind="carInfo.carMark.title"></span> <span ng-bind="carInfo.carModelGroup.title"></span> <span ng-bind="carInfo.carModel.title"></span> — <span ng-bind="calculation.car_manufacturing_year"></span> г. выпуска, <span ng-bind="calculation.engine_power"></span> л.с.</strong></h3><h3 class="b-content_title mt30">Водители:</h3><h3 class="b-content_title p20 mt10" ng-show="!calculation.is_multidrive"><div ng-repeat="driver in calculation.driver_set"><strong>Возраст - <span ng-bind="driver.age"></span>, стаж - <span ng-bind="driver.expirience"></span></strong></div></h3><h3 class="b-content_title p20 mt10" ng-show="calculation.is_multidrive"><div><strong>Минимальный возраст - <span ng-bind="calculation.drivers_minimal_age"></span>, минимальный стаж - <span ng-bind="calculation.drivers_minimal_experience"></span></strong></div></h3><div class="b-ordering-block_icon"><i class="icon info"></i></div></div></div><div class="five wide column"><div class="b-full-width-bg b-ordering-block b-full-width-bg--red" style="height: 100%" ng-if="carFilterParams.selectedResult()"><h3 class="b-content_title m0">Тип страхования: <strong class="ng-binding">Осаго</strong></h3><h3 class="b-content_title m0">Выбранный страховой продукт:</h3><h3 class="b-content_title c-tar m0 mt10"><div class="b-ordering_ins-company"><strong ng-bind="carFilterParams.getCompanyTitle()"></strong></div><div class="mt5 b-ordering_price"><strong><span ng-bind="carFilterParams.selectedResult().program.sum | priceFormatter:0:\'\':false"></span>. <small ng-bind="carFilterParams.selectedResult().program.sum | fractionalFormatter:2"></small> р.</strong></div></h3><div class="b-ordering-block_icon"><i class="icon calculator"></i></div></div></div></div><div class="row"><div class="eleven wide column"><div class="b-full-width-bg b-ordering-block b-ordering-block--form"><h3 class="b-content_title m0 mb20">Введите данные для оформления заказа:</h3><form name="ordering_form"><div class="ui form"><div class="ui grid stackable two column"><div class="row" ng-if="!$root.currentBrand.with_sms"><div class="column"><div class="field"><label>Ваше имя:</label> <input type="text" ng-disabled="params.disableFormFields" ng-model="formFields.client_name" required=""></div></div><div class="column"><div class="field"><label>Ваш телефон:</label> <input type="text" ui-mask="+7 (999) 999-9999" required="" ng-disabled="params.disableFormFields" placeholder="+7 (___) ___-____" ng-model="formFields.client_phone"></div></div></div><div class="row"><div class="column"><div class="field"><label>Способ оплаты:</label><div class="ui search selection dropdown" id="id_owner_registration" sem-dropdown="" ng-class="{disabled: params.disableFormFields}" ng-model="formFields.payment_type" sem-dropdown-simple="true" sem-dropdown-items="paymentType"></div></div></div></div><div class="row one column"><div class="column"><div class="mt10"><sem-checkbox ng-model="formFields.receipt_type" sem-label="{{params.deliveryTypeTitle}}" sem-type="radio" class="mr25" ng-disabled="params.disableFormFields" name="receipt_type" value="delivery"></sem-checkbox><sem-checkbox ng-model="formFields.receipt_type" sem-label="Оформление в офисе" ng-disabled="params.disableFormFields" sem-type="radio" name="receipt_type" value="office"></sem-checkbox></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'delivery\'"><div class="row one column pt0"><div class="column"><div class="field"><label for="id_delivery_address">Адрес доставки:</label> <input type="text" class="ui input" required="" ng-disabled="params.disableFormFields" id="id_delivery_address" ng-model="formFields.delivery_address"></div></div></div><div class="row two column pt0"><div class="column"><div class="field" ng-class="{error: formFields.delivery_date && ordering_form.delivery_date.$invalid}"><label for="id_delivery_date">Дата доставки:</label><div class="ui icon input"><input type="text" jdatepicker="" ng-disabled="params.disableFormFields" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="=true" name="delivery_date" placeholder="__.__.____" id="id_delivery_date" required="" ng-model="formFields.delivery_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field"><label for="id_delivery_time" ng-bind="params.deliveryTimeTitle"></label> <input type="text" class="ui input" required="" ng-disabled="params.disableFormFields" ng-model="formFields.delivery_time" id="id_delivery_time"></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'office\'"><div class="row two column pt0"><div class="column"><div class="field" ng-class="{error: formFields.arrival_date && ordering_form.arrival_date.$invalid}"><label for="id_arrival_date">Дата оформления:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="true" ng-disabled="params.disableFormFields" name="arrival_date" placeholder="__.__.____" id="id_arrival_date" required="" ng-model="formFields.arrival_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column" ng-if="!$root.currentBrand.arrival_time_is_hidden"><div class="field"><label for="id_arrival_time">Время оформления:</label> <input type="text" required="" ng-disabled="params.disableFormFields" ng-model="formFields.arrival_time" id="id_arrival_time"></div></div></div></div></div></form><div class="b-ordering-block_icon"><i class="icon write"></i></div></div></div><div class="five wide column"><div class="b-ordering-block_submit b-full-width-bg b-ordering-block b-full-width-bg--grey"><button type="button" class="ui button" style="bottom: 70%;" ng-if="disableOrderBtn"><a href="{{$root.currentBrand.calc_kasko_link}}">Рассчитать КАСКО</a></button> <button type="button" class="ui button" style="bottom: 55%;" ng-if="disableOrderBtn"><a href="{{$root.currentBrand.calc_osago_link}}">Рассчитать ОСАГО</a></button> <button type="button" ya-metrika="m-order" ng-click="sendPolicyOrdering()" ng-disabled="ordering_form.$invalid || policyOrderingInProgress || params.disableFormFields" ng-class="[policyOrderingInProgress ? \'loading\' : \'\', ($root.currentBrand.order_the_policy_button || $root.currentBrand.main_buttons_color)]" class="ui button">Заказать полис</button></div></div></div></div></div></div>')}]);angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/brands/broker-kapital/src/modules.casco/calculatorS/views/calculation.step_3.html",'<div class="css-cars-filter b-full-width-bg m0 mt30" ng-class="\'css-cars-filter--step-\' + bigSteps.getBigStep().name" style="font-size: 15px;"><div class="p20" ng-init="data.showSteps = false"><div ng-class="{\'c-ct__progress__wrapper\': getActiveStep().name !== \'casco_all\'}"><div class="c-ct__progress" ng-show="(getActiveStep().name !== \'casco_all\' && bigSteps.getBigStep().name !== \'fourth\') || (getActiveStep().name !== \'casco_all\' && currentBrand.disable_discount)"><div class="c-ct__progress-line" ng-style="{\'width\': (getFullDiscount()/sumOfDiscounts * 100) + \'%\'}"></div><div class="c-ct__progress-title"><strong ng-if="!currentBrand.disable_discount">Скидка <span ng-bind="getFullDiscount()"></span>% на полис КАСКО</strong> <strong ng-if="currentBrand.disable_discount">{{getCurrentStepTitle()}}</strong></div><div class="c-ct__progress-discount" ng-if="!currentBrand.disable_discount"><span ng-bind="getCurrentDiscountTitle()"></span></div></div><div class="ui labels mt50 c-ct__steps-history" ng-init="data.showSteps = $root.currentBrand.alwaysShowHistory" ng-if="!$root.currentBrand.without_steps_history"><span ng-repeat-start="(stepName, steps) in brandSteps" ng-init="$parentIndex = $index"><div class="ui label basic" ng-if="$parentIndex == 0 && !data.showSteps && getActiveStep().name !== \'casco_all\'" ng-click="data.showSteps = !data.showSteps"><i class="caret left icon"></i> Назад</div><div class="ui label basic" ng-if="$parentIndex == 0 && data.showSteps && getActiveStep().name !== \'casco_all\'" ng-click="data.showSteps = $root.currentBrand.alwaysShowHistory; getPrevStep(getActiveStep().name)"><i class="caret left icon"></i> Назад</div></span><div class="ui label basic c-ct__steps-history__wrapper" ng-repeat-end="" ng-repeat="step in steps" ng-init="stepObj = getStepObjectByName(step)" ng-show="stepObj.getLabelTitle() && data.showSteps" ng-if="params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) >= $parentIndex"><span ng-if="bigSteps.getBigStep().name == stepName" ng-click="setActiveStep(step);showSteps = true" ng-bind="stepObj.getLabelTitle()"></span> <span ng-if="bigSteps.getBigStep().name != stepName" ng-click="bigSteps.setBigStep(stepName);setActiveStep(step);showSteps = true" ng-bind="stepObj.getLabelTitle()"></span></div></div></div><div ng-show="$root.currentBrand.without_casco_discount && bigSteps.getBigStep().name !== \'third\'" style="margin-bottom: -20px;"></div><div class="clearfix pos-rel"><div class="c-ct__steps-wrapper" ng-class="{\'c-ct__steps-wrapper--casco_all\': getActiveStep().name !== \'casco_all\'}"><div ng-if="!params.resultsAreVisible || bigSteps.getBigStep().name !== \'third\'" style="min-height: 300px"><car-filter cf-model-car-mark="calculation.car_mark" cf-model-car-model="calculation.car_model" cf-model-car-model-group="calculation.car_model_group" cf-model-car-cost="calculation.car_cost"></car-filter></div><div class="c-ct__top-panel" ng-if="params.resultsAreVisible && bigSteps.getBigStep().name === \'third\'" ng-include="templates.program_list_manager"></div><div ng-include="templates.program_list" class="js-kasko-result" ng-show="params.resultsAreVisible && bigSteps.getBigStep().name === \'third\'" ng-class=""></div></div><div class="w15p c-fl" ng-class="{\'w85p\': getActiveStep().name !== \'casco_all\'}" ng-show="getActiveStep().name !== \'casco_all\'"><div class="c-ct__steps" ng-if="!currentBrand.without_big_steps_labels"><div class="c-ct__steps-item" ng-repeat="item in params.cascoParams.cascoBigSteps" data-tooltip="{{item.title}}" data-position="left center"><div class="ui huge icon button circular branded--second" ng-class="{ green: params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) >= $index, active: params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) === $index, disabled: params.cascoParams.getBigStepIndex(bigSteps.getBigStep().name) < $index }" ng-click="bigSteps.setBigStep(item.name)"><i class="icon" ng-class="item.icon"></i></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/brands/broker-kapital/src/modules.shared/carFilter/views/third_big_step.html",'<div class="ui grid three column doubling stackable css-bigger-labels" ng-init="user_agreement = false"><div class="row one column"><div class="column"><h4 class="mt60 c-tac">На следующем шаге Вы получите результаты расчетов стоимости КАСКО в различных страховых компаниях.<br></h4></div></div><div class="row"><div class="column"><div class="field"><label for="id_client_name">Имя:</label> <input type="text" ng-model="clientParams.client_name" ng-change="$root.clientDataForMail.name = clientParams.client_name" placeholder="Имя" id="id_client_name"></div></div><div class="column"><div class="field"><label for="id_client_phone">Телефон:</label> <input type="text" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" model-view-value="true" ng-model="clientParams.client_phone" ng-change="$root.clientDataForMail.phone = clientParams.client_phone" id="id_client_phone"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button teal fluid" ng-disabled="!clientParams.client_phone || !clientParams.client_name" ng-click="calculateKaskoCarFilter();setConfirmation(true)" type="button">Показать тарифы</button></div></div></div><div class="row one column"><div class="column c-tac"><p>Укажите ваше имя и номер телефона для получения расчета и скидки в 10%</p></div></div></div>')}]),function(e){e.module("brandingConfigs",[]).service("brandingConfigs",["$stateParams","moduleType","CONSTS",function(e,t,a){return{kasko:{locales:{"mileage-title":{ru:"Другой пробег",en:"Other mileage"}},exploitation_area_all_are_hidden:!0,watermark_is_hidden:!0,with_sms:!1,exploitation_areas:[30233],owner_registrations_expanded:[{id:"30233_1",title:"Воронежская обл."}],preCalculationParse:function(e){e.owner_registration&&(e.owner_registration=String(e.owner_registration).replace(/_\d/,""))},calculationInterParamsDefaults:{},sendLetterBeforeOrder:!0,payment_form_is_hidden:!0,arrival_time_is_hidden:!0,steps_buttons_color:"branded",main_buttons_color:"branded",united_buttons_color:"",link_to_registration_in_email:!1,payment_forms:[{id:107,title:"У официального дилера"},{id:105,title:"Не официальные СТОА"}],templates:{third_big_step:"/brands/broker-kapital/src/modules.shared/carFilter/views/third_big_step.html"}},osago:{with_sms:!1,owner_registration_all_are_hidden:!0,owner_registrations:[29650],show_user_agreement:!0,watermark_is_hidden:!0,show_personal_data:!0,sendLetterBeforeOrder:!0,steps_buttons_color:"branded",main_buttons_color:"branded",with_calculation_fake_data:!1,fake_calculation_fields:[{name:"car_model",value:7559},{name:"car_mark",value:297}],link_to_registration_in_email:!1,templates:{adding_documents:"/brands/broker-kapital/src/modules.osago/AddingDocuments/views/adding_documents.uploader.html"}},casco:{with_sms:!0,without_steps_history:!1,without_osago:!0,with_payment_type:!1,without_delivery:!0,watermark_is_hidden:!0,sendLetterBeforeOrder:!0,disable_discount:!1,steps_discount:{casco_car_mark:1,casco_year:1,casco_car_model:1,sms_verification:2,casco_car_other:1,casco_insurance_params:2,drivers:2},steps_discount_titles:{sms_verification:"+2% за указание контактных данных"},with_alternative_fourth_step:!0,with_agreement_on_ordering:!1,with_bottom_programs:!1,recalculation_module:"top",hidden_in_mail:[],templates:{navigation:a.pathToModules+"casco/formationPolicyS/views/navigation.html",third_big_step:"/brands/broker-kapital/src/modules.shared/carFilter/views/third_big_step.html",step_3:"/brands/broker-kapital/src/modules.casco/calculatorS/views/calculation.step_3.html"},defaults:{calculation:{exploitation_area:30233}}}}[t]}]).service("stepsService",["moduleType",function(e){return{kasko:{stepsHacks:{},steps:{first:["year","car_mark","car_model_group","car_model","engine_power","exploitation_area","car_cost","mileage"],second:["drivers_count",function(e){return e.is_multidrive?"is_multidrive":"drivers"},"calc"]}},osago:{stepsHacks:{},steps:{first:["year","car_mark","car_model_group","car_model","engine_power","owner_registration","sms_verification","calculation_type"],second:["drivers_count"]}},casco:{stepsHacks:{},steps:{first:["casco_all","casco_car_mark","casco_year","casco_car_model_group","casco_car_model","casco_car_other"],second:["casco_insurance_params","drivers"]}}}[e]}])}(angular);